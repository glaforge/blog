<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Cédric Champeau's blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <meta name="keywords" content="">    

    <!-- Le styles -->
    <link href="/blog/css/bootstrap.min.css" rel="stylesheet">
    <link href="/blog/css/asciidoctor.css" rel="stylesheet">
    <link href="/blog/css/base.css" rel="stylesheet">
    <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="/js/html5shiv.js"></script>
    <![endif]-->

    <!-- Fav and touch icons -->
    <!--<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../assets/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../assets/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../assets/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="../assets/ico/apple-touch-icon-57-precomposed.png">-->
    <link rel="shortcut icon" href="favicon.ico">
    </head>
  <body>
	<div id="fb-root"></div>
	<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<script src="//platform.linkedin.com/in.js" type="text/javascript">
 lang: en_US
</script>
    <div id="wrap">
	
	<!-- Fixed navbar -->
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
          <div class="container">
	    <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/blog">Cédric Champeau's blog</a>
	    </div>
            <div class="navbar-collapse collapse">
              <ul class="nav navbar-nav">                
                <li><a href="/blog/about.html">About</a></li>
		<li><a href="/blog/projects.html">Projects</a></li>
		<li><a href="/blog/conferences.html">Conferences</a></li>
		<li class="dropdown">
          		<a data-toggle="dropdown" href="#">Topics<b class="caret"></b></a>
		          <ul class="dropdown-menu" role="menu">
				<li><a href="/blog/tags/groovy.html">Groovy</a></li>
				<li><a href="/blog/2013/07/30/deck2pdf_exporting_html5_slide_decks.html">deck2pdf</a></li>
				<li><a href="/blog/tags/jlangdetect.html">JLangDetect</a></li>
		          </ul>
	       </li>
                <li><a href="/blog/feed.xml">Feed</a></li>                
              </ul>
	      <ul class="nav navbar-nav navbar-right">
	      	<li><a href="https://github.com/melix"><i class="fa fa-github"></i></a></li>
	        <li><a href="https://twitter.com/CedricChampeau"><i class="fa fa-twitter"></i></a>
	      </ul>
            </div>
          </div>
      </div>
      <div class="container">

	<div class="page-header">
		<h1>Blog</h1>
		<h2>Next conferences</h2>
		<div class="lanyrd-target-splat"><a href="http://lanyrd.com/profile/cedricchampeau/" class="lanyrd-splat lanyrd-number-3 lanyrd-context-future" rel="me">My conferences on Lanyrd</a></div>
	</div>
  			<a href="/blog/2014/10/android-moto360.html"><h1>Fixing Bluetooth debugging on Android Wear</h1></a>
  			<p>20 October 2014</p>
			<p><em>Tags: </em>
		<a href="/blog/tags/groovy.html">groovy</a> 
	
		<a href="/blog/tags/android.html">android</a> 
	
		<a href="/blog/tags/moto-360.html">moto 360</a> 
	
		<a href="/blog/tags/wear.html">wear</a> 
	</p>
			<a href="https://twitter.com/share" class="twitter-share-button" data-text="Fixing Bluetooth debugging on Android Wear" data-url="http://melix.github.io/blog/2014/10/android-moto360.html" data-via="CedricChampeau" data-lang="fr">Tweeter</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
			<div class="g-plusone" data-size="medium" data-href="http://melix.github.io/blog/2014/10/android-moto360.html"></div>
		        <script id='fbvpgng2014/10/android-moto360.html'>(function(i){var f,s=document.getElementById(i);f=document.createElement('iframe');f.src='//api.flattr.com/button/view/?uid=CedricChampeau&button=compact&url='+encodeURIComponent('http://melix.github.io/blog/2014/10/android-moto360.html');f.title='Flattr';f.height=20;f.width=110;f.style.borderWidth=0;s.parentNode.insertBefore(f,s);})('fbvpgng2014/10/android-moto360.html');</script>

			<script type="IN/Share" data-url="http://melix.github.io/blog/2014/10/android-moto360.html" data-counter="right"></script>
			<div class="fb-like" data-href="http://melix.github.io/blog/2014/10/android-moto360.html" data-layout="button_count" data-action="like" data-show-faces="false" data-share="true"></div>

  			<p><div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>I have been working on making <a href="http://beta.groovy-lang.org">Groovy</a> work on Android for several months now. In the last weeks, I even
showed at SpringOne2GX an example of an application written in Groovy that worked on Android Wear. However, that code
worked in an emulator. Recently, I got a real device, a Moto 360, so I wanted to see that application running on a
real device. For some very obscure (understand buggy Android SDK) reason, it was far from being that easy&#8230;</p>
</div>
<div class="paragraph">
<p>I litteraly spent <strong>hours</strong> trying to figure out what was wrong, so I thought it would be interesting for those of you
who face the same problem to have a blog post that explains how to deal with it.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_problem">The problem</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you follow the instructions on the <a href="https://developer.android.com/training/wearables/apps/bt-debugging.html">Android documentation</a>
about how to enable bluetooth debugging, it&#8217;s in the end pretty simple. Basically, it&#8217;s about enabling USB debugging on your physical
handheld, then enable bluetooth debugging on your wearable, and in the end enable bluetooth debugging in the Android Wear companion app.</p>
</div>
<div class="paragraph">
<p>The guide says:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>In the Android Wear companion app, you should see the status change to:</p>
</div>
<div class="paragraph">
<p>Host: connected
Target: connected</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>However, whatever I did, the <code>Target: connected</code> line never appeared for me. It was <strong>always</strong> <code>Target: disconnected</code>, so if I continued
with the instructions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>adb forward tcp:4444 localabstract:/adb-hub; adb connect localhost:4444</pre>
</div>
</div>
<div class="paragraph">
<p>Doing</p>
</div>
<div class="listingblock">
<div class="content">
<pre>adb devices</pre>
</div>
</div>
<div class="paragraph">
<p>Only showed my wearable as <code>offline</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>List of devices attached

dcfbbafd	device
localhost:4444	offline</pre>
</div>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="/blog/img/rage-offline.jpg" alt="Why so evil?">
</div>
</div>
<div class="paragraph">
<p>I have searched for an answer in a lot of pages, including <a href="http://stackoverflow.com/questions/25938998/debugging-on-moto-360">Stackoverflow</a> where
I tried very unlikely answers like in <a href="http://stackoverflow.com/questions/25938998/debugging-on-moto-360">this page</a>: execute both commands separately instead
of doing them in the same line. I thought that maybe there was a timing issue and that the fact of separating both commands would give the toolkit a chance,
but no, wasn&#8217;t that easy.</p>
</div>
<div class="paragraph">
<p>In the end, I was totally convinced that the problem was because I had previously associated my handheld with an emulator. I was convinced of it because even if I had now associated it with a real device (the Moto 360), in the Android Wear companion app, the device was recognized as an "emulator"&#8230; mmm&#8230; So I tried uninstalling the Android Wear app, clear its cache, but no matter what I did, after reinstalling, the settings were kept, and the Moto recognized as an emulator. So sad&#8230;</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_solution">The solution</h2>
<div class="sectionbody">
<div class="paragraph">
<p>So you were looking at a solution, and here it is. Basically, the problem is that the Android companion app doesn&#8217;t store its settings under its cache. They are stored in the <code>Google Play Services</code> space, so here is the procedure that worked for me, and I sincerely hope it will do for you. On your handheld:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>open the applications settings, search for the <code>Android Wear</code> application, then <strong>force stop it</strong></p>
</li>
<li>
<p>clear its <strong>data and cache</strong></p>
</li>
<li>
<p>now search for <code>Google Play Services</code> (depending on your language settings, it can appear with a different name, on m y device it is "Services Google Play".</p>
</li>
<li>
<p>click on <code>Manage space</code>. You will see that there&#8217;s a section for connected devices. I tried to clear data here, but it didn&#8217;t help, so you have to click on <strong>delete all data</strong>.</p>
</li>
<li>
<p>reboot your phone</p>
</li>
<li>
<p>reboot your Moto 360</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>I am unsure that the two last steps are really necessary, but I did it because I wanted to make sure that force stopping and clearing data did not introduce some weird behavior after that. When you reopen the Android Wear companion app, it should now be as if it was the first time you opened it and ask you to associate it with your watch. Do it, and now, you should be able to follow the normal procedure described in the Android documentation and&#8230;</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="/blog/img/yes-baby.jpg" alt="yes baby">
</div>
</div>
<div class="paragraph">
<p>Success, now you can debug your application on a real device (which includes deploying it&#8230;).</p>
</div>
<blockquote class="twitter-tweet" lang="fr"><p>Hey, finally got it working! I need to blog about how I arrived the insane emulator issue... <a href="https://twitter.com/hashtag/groovylang?src=hash">#groovylang</a> <a href="http://t.co/XINccF3V7k">pic.twitter.com/XINccF3V7k</a></p>&mdash; Cédric Champeau (@CedricChampeau) <a href="https://twitter.com/CedricChampeau/status/523934124898521090">19 Octobre 2014</a></blockquote>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
</div>
</div></p>
			<p><a href="/blog/2014/10/android-moto360.html#disqus_thread">Comments</a></p>
  			<a href="/blog/2014/07/bisecting-groovy.html"><h1>Tip of the day: reversed git bisect</h1></a>
  			<p>23 July 2014</p>
			<p><em>Tags: </em>
		<a href="/blog/tags/groovy.html">groovy</a> 
	
		<a href="/blog/tags/git.html">git</a> 
	
		<a href="/blog/tags/bisect.html">bisect</a> 
	</p>
			<a href="https://twitter.com/share" class="twitter-share-button" data-text="Tip of the day: reversed git bisect" data-url="http://melix.github.io/blog/2014/07/bisecting-groovy.html" data-via="CedricChampeau" data-lang="fr">Tweeter</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
			<div class="g-plusone" data-size="medium" data-href="http://melix.github.io/blog/2014/07/bisecting-groovy.html"></div>
		        <script id='fbvpgng2014/07/bisecting-groovy.html'>(function(i){var f,s=document.getElementById(i);f=document.createElement('iframe');f.src='//api.flattr.com/button/view/?uid=CedricChampeau&button=compact&url='+encodeURIComponent('http://melix.github.io/blog/2014/07/bisecting-groovy.html');f.title='Flattr';f.height=20;f.width=110;f.style.borderWidth=0;s.parentNode.insertBefore(f,s);})('fbvpgng2014/07/bisecting-groovy.html');</script>

			<script type="IN/Share" data-url="http://melix.github.io/blog/2014/07/bisecting-groovy.html" data-counter="right"></script>
			<div class="fb-like" data-href="http://melix.github.io/blog/2014/07/bisecting-groovy.html" data-layout="button_count" data-action="like" data-show-faces="false" data-share="true"></div>

  			<p><div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>I had an interesting use case for <code>git bisect</code> today and as my blog also consistutes a good archive for things I don&#8217;t
want to loose, let&#8217;s take advantage of this to share the trick with you!</p>
</div>
<div class="paragraph">
<p>Normally, <code>git bisect</code> is used to find what commit introduced a regression in the codebase. For example, if you know
that current <code>HEAD</code> is buggy but that at least, RELEASE_1_0 was good, then you can write:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>git bisect start             <i class="conum" data-value="1"></i><b>(1)</b>
git bisect bad               <i class="conum" data-value="2"></i><b>(2)</b>
git bisect good RELEASE_1_0  <i class="conum" data-value="3"></i><b>(3)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>start bisecting</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>tells that <code>HEAD</code> contains the regression</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>tells that <code>RELEASE_1_0</code> is a tag corresponding to a version known not to have the bug</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Git will checkout a revision that you can test, and you issue a list of <code>git bisect good</code> or <code>git bisect bad</code> commands
until it determines what commit introduced the regression.</p>
</div>
<div class="paragraph">
<p>This is a <strong>very</strong> practical way to find a regression. In Groovy, I&#8217;ve used this more than once, it&#8217;s very useful.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_reversing_the_logic">Reversing the logic</h2>
<div class="sectionbody">
<div class="paragraph">
<p>But today, I wanted to <em>reverse the logic</em>. Actually, we had a <a href="https://jira.codehaus.org/browse/GROOVY-6463">bug report</a>
and we found out that the bug was already fixed, but we didn&#8217;t know in which version it was fixed. So actually, I didn&#8217;t
want to find a regression, but a fix commit.</p>
</div>
<div class="paragraph">
<p>The idea to do this is to reverse the meaning of <code>bad</code> and <code>good</code> in <code>bisect</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>bad</code> becomes "doesn&#8217;t produce a compile error"</p>
</li>
<li>
<p><code>good</code> becomes "produces a compile error"</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>And since the range of revisions to test was pretty big (we know that the error was reported on Groovy 2.2.1, but master
is 2.4.0), then I also took advantage of the <code>git bisect run</code> command, which automatically continues bisecting based on
a command line return status code.</p>
</div>
<div class="paragraph">
<p>So basically, here&#8217;s what I wrote:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>git bisect start                <i class="conum" data-value="1"></i><b>(1)</b>
git bisect bad master           <i class="conum" data-value="2"></i><b>(2)</b>
git bisect good GROOVY_2_2_1    <i class="conum" data-value="3"></i><b>(3)</b>
git bisect run ./bisect.sh      <i class="conum" data-value="4"></i><b>(4)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>start bisecting</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>master is known to have the fix, so we say <strong>bad</strong> is master</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>GROOVY_2_2_1 is known to have the bug, so we say <strong>good</strong> is GROOVY_2_2_1</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>start automatic bisecting thanks to the ./bisect.sh script</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>And what does <em>bisect.sh</em> consist of? Here you go:</p>
</div>
<div class="listingblock">
<div class="title">bisect.sh</div>
<div class="content">
<pre>#!/bin/bash
export GROOVY_HOME=/tmp/testversion                                                                     <i class="conum" data-value="1"></i><b>(1)</b>
./gradlew clean -x javadoc -x groovydoc -x javadocAll -x groovydocAll -PskipIndy=true installGroovy     <i class="conum" data-value="2"></i><b>(2)</b>
/tmp/testversion/bin/groovy bisect.groovy || exit 0                                                     <i class="conum" data-value="3"></i><b>(3)</b>
exit 1                                                                                                  <i class="conum" data-value="4"></i><b>(4)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>tells where the local build version of Groovy will be installed</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>builds Groovy and installs it locally</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>executes the test script and if the test fails, return a success exit code</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>return a failure exit code</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The trick is to <strong>reverse the exit codes</strong> in the script too: if the script compiles, then it means that the bug was fixed.
Since we reverse the logic, we then need the script to return a bad exit code! In case the script fails, we will return
a success (0) error code, because it means that the revision doesn&#8217;t have the fix. Easy, but needs some mental contorsion :-)</p>
</div>
<div class="paragraph">
<p>You will note that this script uses <code>GROOVY_HOME</code> and a local installation path. You can configure it using the <code>$HOME/.gradle/gradle.properties</code> file,
and adding the following line in it:</p>
</div>
<div class="listingblock">
<div class="title">gradle.properties</div>
<div class="content">
<pre>groovy_installPath=/tmp/testversion</pre>
</div>
</div>
<div class="paragraph">
<p>Eventually, here is the groovy script which served as a test case (almost copied directly from the JIRA issue):</p>
</div>
<div class="listingblock">
<div class="title">bisect.groovy</div>
<div class="content">
<pre class="prettyprint groovy language-groovy"><code>abstract  class Base&lt;A&gt; {
    abstract  void foo(A[] a)
}

class X {}

class Inheritor extends Base&lt;X&gt;{
    @Override
    void foo(X[] a) {}
//Groovyc: Can't have an abstract method in a non-abstract class.
//The class 'B' must be declared abstract
//or the method 'void foo([Ljava.lang.Object;)' must be implemented.
}

Inheritor</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that each revision took around ~1 min 30s to test, even skipping the javadoc/groovydoc and indy versions of Groovy,
so you can imagine what benefit you have here in using automatic bisecting.</p>
</div>
<div class="paragraph">
<p>In the end, after around 20 minutes of automatic processing, I received this nice message:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>74d991f9f8c39d2730a054431bf28e6516e61735 is the first bad commit
commit 74d991f9f8c39d2730a054431bf28e6516e61735
Author: Cedric Champeau &lt;cedric.champeau@gmail.com&gt;
Date:   Sun Apr 27 18:06:24 2014 +0200

    GROOVY-6722: Compiler doesn't handle generic array covariant

:040000 040000 b61b92399ac86246c157f948b3232bf5ab0cf04f 5d0c56413a621c7693e7985aff0e4c84eb08889f M	src
bisect run success</pre>
</div>
</div>
<div class="paragraph">
<p>What? "bad commit"? Yes, remember that the logic is reversed, so "bad" means actually "fixed it". So it says that the
first commit which <strong>fixed</strong> the bug was actually <code>74d991f</code>. And here we go, issue closed ;) One improvement I can see
is to use a local clone of my repository instead of working directly in the same repository, so that I can continue
working on my copy while bisecting is in progress.</p>
</div>
</div>
</div></p>
			<p><a href="/blog/2014/07/bisecting-groovy.html#disqus_thread">Comments</a></p>
  			<a href="/blog/2014/07/new-groovy-website.html"><h1>The new Groovy website</h1></a>
  			<p>18 July 2014</p>
			<p><em>Tags: </em>
		<a href="/blog/tags/groovy.html">groovy</a> 
	
		<a href="/blog/tags/templating.html">templating</a> 
	
		<a href="/blog/tags/gradle.html">gradle</a> 
	
		<a href="/blog/tags/markup-template-engine.html">markup template engine</a> 
	</p>
			<a href="https://twitter.com/share" class="twitter-share-button" data-text="The new Groovy website" data-url="http://melix.github.io/blog/2014/07/new-groovy-website.html" data-via="CedricChampeau" data-lang="fr">Tweeter</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
			<div class="g-plusone" data-size="medium" data-href="http://melix.github.io/blog/2014/07/new-groovy-website.html"></div>
		        <script id='fbvpgng2014/07/new-groovy-website.html'>(function(i){var f,s=document.getElementById(i);f=document.createElement('iframe');f.src='//api.flattr.com/button/view/?uid=CedricChampeau&button=compact&url='+encodeURIComponent('http://melix.github.io/blog/2014/07/new-groovy-website.html');f.title='Flattr';f.height=20;f.width=110;f.style.borderWidth=0;s.parentNode.insertBefore(f,s);})('fbvpgng2014/07/new-groovy-website.html');</script>

			<script type="IN/Share" data-url="http://melix.github.io/blog/2014/07/new-groovy-website.html" data-counter="right"></script>
			<div class="fb-like" data-href="http://melix.github.io/blog/2014/07/new-groovy-website.html" data-layout="button_count" data-action="like" data-show-faces="false" data-share="true"></div>

  			<p><div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Last week, we revealed the beta of a <a href="http://beta.groovy-lang.org">brand new website for the Groovy language</a>. This
new website is <a href="https://github.com/groovy/groovy-website">open sourced</a> and already received a few contributions.
In order to make it even easier and as it a fully statically generated site that makes use of Groovy
I wanted to give more technical details on the toolchain and how it is generated.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_a_static_website">A static website</h2>
<div class="sectionbody">
<div class="paragraph">
<p>One of the first questions which arised was: <em>why not use Grails/Spring Boot/Ratpack?</em> In fact, the
new Groovy website is fully statically generated. It offers multiple advantages:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>hosting is much easier, as it only consists of static pages and assets</p>
</li>
<li>
<p>maintenance is simplified, no database to backup for example</p>
</li>
<li>
<p>everything is self contained, pages and data, into a <a href="https://github.com/groovy/groovy-website">single repository</a></p>
</li>
<li>
<p>no need for authentication</p>
</li>
<li>
<p>all content is public</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Last but not least, we didn&#8217;t have any requirement for storing anything in a database, or that would
require dynamic generation. Pull requests are enough so far. Eventually, we&#8217;re thinking about a
blog, but even that can be statically generated even if you want to allow users to comment on articles
(this blog is a perfect example). So in short, this decision was motivated by one mantra:
<em>the right tool for the right job</em>.</p>
</div>
<div class="paragraph">
<p>The documentation, that you can find on <a href="http://beta.groovy-lang.org/documentation.html">this page</a>, had
already started migrating from the aging wiki to . It is generated independently of the
website and integrated into it using iframes (we&#8217;re thinking about source integration though).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_structure_of_the_project">Structure of the project</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_generator_and_site">Generator and site</h3>
<div class="paragraph">
<p>The <a href="https://github.com/groovy/groovy-website">project</a> is built using <a href="http://www.gradle.org">Gradle 2</a> and consists of 2 subprojects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the <a href="https://github.com/groovy/groovy-website/tree/master/generator">generator</a> project contains, as the name says,
the static generator. It makes use of a <a href="#template-engine">template engine</a> and provides the classes used in the model
of the templates.</p>
</li>
<li>
<p>the <a href="https://github.com/groovy/groovy-website/tree/master/site">site</a> project contains the templates and data. If you&#8217;re
looking into contributing contents, this is likely the place to look at.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Building and testing the site is easy:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>git clone https://github.com/groovy/groovy-website.git          <i class="conum" data-value="1"></i><b>(1)</b>
cd groovy-website
./gradlew generate                                              <i class="conum" data-value="2"></i><b>(2)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>clones the repository</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>generates the website from templates</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The output will be visible in <code>&lt;project directory&gt;/site/build/site</code>. There&#8217;s also a <code>checkDeadlinks</code> tasks that we will
use once we get out of the beta phase to ensure that the generated pages do not contain any dead link.</p>
</div>
<div class="paragraph">
<p>Internally, we use our <a href="http://ci.groovy-lang.org/viewType.html?buildTypeId=Groovy_Website&amp;guest=1">CI server</a> to deploy
changes to the <code>master</code> branch live. So any commit which is pushed onto the master branch is automatically published
(in general, takes less than 2 minutes).</p>
</div>
</div>
<div class="sect2">
<h3 id="_adding_contents">Adding contents</h3>
<div class="paragraph">
<p>Even if the site is statically generated, we still have data. In this project, there&#8217;s an important file, named
<a href="https://github.com/groovy/groovy-website/blob/master/site/src/site/sitemap.groovy">sitemap.groovy</a> which handles a lot
of the contents of the website. It is our "low cost" database and as you can see, it&#8217;s a DSL describing the contents
of the website.</p>
</div>
<div class="paragraph">
<p>For example, you can see the <code>menu</code> section which looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint groovy language-groovy"><code>menu {
    group('Groovy') {
        item 'Learn',                       'learn.html'
        item 'Documentation',               'documentation.html'
        item 'Download',                    'download.html'
        item 'Community',                   'community.html'
        item 'Ecosystem',                   'ecosystem.html'
    }

    group('About') {
        item 'Contributing',                'contribute.html'
        item 'Source code',                 'https://github.com/groovy/groovy-core'
        item 'Books',                       'learn.html#books'
        item 'Sponsors',                    'sponsors.html'
        item 'FAQ',                         'faq.html'
        item 'Search',                      'search.html'
    }

    // ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is a purely declarative description of the site menus. Actually, the "Groups" are used in the footer of the page,
while the main <code>Groovy</code> group is used to generate the top navigation bar. Using a simple descriptive DSL is very interesting,
because it decouples templates from the contents of the menu. We make sure that those templates do not contain any element
which is hardcoded and reduce the risks of forgetting to update the footer, for example, if a section is added.</p>
</div>
<div class="paragraph">
<p>The same file is used to describe the list of downloads:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint groovy language-groovy"><code>downloads {
    // ...
    distribution('Groovy 2.3') {
        description {
            yield 'Groovy 2.3 is our latest official '
            a(href: 'versioning.html', 'version')
            yield ' of Groovy.'
        }

        version('2.3.4') {
            stable true
            releaseNotes 'https://jira.codehaus.org/secure/ReleaseNote.jspa?projectId=10242&amp;version=20432'
            windowsInstaller 'http://dist.codehaus.org/groovy/distributions/installers/windows/nsis/groovy-2.3.4-installer.exe'
        }
    }
    // ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the books which are listed on the <a href="http://beta.groovy-lang.org/learn.html">learn page</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint groovy language-groovy"><code>books {
    book('Groovy in Action, 2nd edition') {
        authors "Dierk König, Guillaume Laforge, Paul King, Cédric Champeau, Hamlet D'Arcy, Erik Pragt, and Jon Skeet"
        cover 'img/books/regina.png'
        url 'http://www.manning.com/koenig2/'
        description 'The undisputed definitive reference on the Groovy programming language, authored by core members of the development team.'
    }
    // ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The same is done for all contents that need regular updates: user groups, events, projects of the ecosystem, &#8230; I think
this DSL provides a very nice way to add contents to the website without caring about where it has to be done. You can
really think of it as a small database, but making use of a Groovy DSL.</p>
</div>
<div class="paragraph">
<p>In addition, this file also declares the <a href="https://github.com/groovy/groovy-website/blob/03e3806cf26af6b13d99e6ee7473687e3f36fedd/site/src/site/sitemap.groovy#L62-L74">mapping between pages in the documentation section</a>
and <a href="http://beta.groovy-lang.org/documentation.html">the documentation page</a>. Last but not least, it lists the individual
pages that the website contain. Those pages make use of the <a href="http://beta.groovy-lang.org/docs/latest/html/documentation/markup-template-engine.html">markup template engine</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_eat_your_own_dog_food">Eat your own dog food</h3>
<div class="paragraph">
<p>In Groovy 2.3, we introduced a new <a href="http://beta.groovy-lang.org/docs/latest/html/documentation/markup-template-engine.html">markup template engine</a>. We decided that the new web site was an excellent showcase of
this template engine, and a real life use case. This template engine has several remarkable features, like static compilation
of templates (even if the model is dynamic), layouts and of course a human readable builder like syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint groovy language-groovy"><code>html {
   head {
    title 'Groovy markup template engine in action!'
   }
   body {
    ul {
        features.each { f-&gt; li(f.name) }
    }
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>It has already been integrated into <a href="https://spring.io/blog/2014/05/28/using-the-innovative-groovy-template-engine-in-spring-boot">Spring Boot</a>
and <a href="http://www.ratpack.io/">Ratpack</a> will use it in the next version (to be released on August 1st). A hint about its performance can be found <a href="https://github.com/ratpack/ratpack/pull/370">here</a>.
If you are interested in details about how it works, you can find the documentation <a href="http://beta.groovy-lang.org/docs/latest/html/documentation/markup-template-engine.html">here</a>
and you can read my <a href="http://melix.github.io/blog/2014/02/markuptemplateengine.html">blog posts</a> about it.</p>
</div>
<div class="paragraph">
<p>The website subproject is therefore organized accordingly. Inside the <a href="https://github.com/groovy/groovy-website/tree/master/site/src/site">main source tree</a>, you&#8217;ll find the following directories:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>assets: contains static assets, like Javascript, CSS, images, &#8230;</p>
</li>
<li>
<p>html: contains pure HTML files which are easier to embed as is than using a markup syntax</p>
</li>
<li>
<p>includes: contains elements of code which are shared among multiple templates</p>
</li>
<li>
<p>layouts: contains template layouts, as defined in the <a href="http://beta.groovy-lang.org/docs/latest/html/documentation/markup-template-engine.html#_layouts">documentation</a></p>
</li>
<li>
<p>pages: contains the main pages of the website</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In general, consider <code>pages</code> as the entry point. A page generally makes use of one layout. As an example, let&#8217;s see how
the <a href="http://beta.groovy-lang.org/ecosystem.html">Ecosystem</a> page is generated. The source file consists of this:</p>
</div>
<div class="listingblock">
<div class="title">ecosystem.groovy</div>
<div class="content">
<pre class="prettyprint groovy language-groovy"><code>layout 'layouts/main.groovy', true,                                             <i class="conum" data-value="1"></i><b>(1)</b>
    pageTitle: 'The Groovy programming language - Ecosystem',                   <i class="conum" data-value="2"></i><b>(2)</b>
    mainContent: contents {                                                     <i class="conum" data-value="3"></i><b>(3)</b>
      div(id: 'content', class: 'page-1') {
        section(class: 'row') {
          div(class: 'row-fluid') {
            // ... snip side menu ...
            div(class: 'col-lg-8 col-lg-pull-0') {
              include template: 'includes/contribute-button.groovy'             <i class="conum" data-value="4"></i><b>(4)</b>
              h1 {
                i(class: 'fa fa-leaf') {}
                yield ' Ecosystem'
              }
              p {
                yield '''
                    Beside the language and its API, Groovy gave birth   ...
                    on various themes such as web frameworks, desktop    ...
                    In this section, we will highlight a few of the most ...
                    which leverage Groovy at their core.
              '''
              }
              hr(class: 'divider')

              ecosys.eachWithIndex { e, index -&gt;                                <i class="conum" data-value="5"></i><b>(5)</b>
                def (name, item) = [e.key, e.value]
                article {
                  a(name: "${name}") {}
                  div(class:"content-heading clearfix media") {
                    div {
                      if (item.logo) {
                        img class: "pull-${(index % 2 == 0) ? 'left' : 'right'}",
                          src: item.logo, alt: name, hspace: '20px'
                      } else {
                        h2(name)
                      }
                      p(item.description)
                    }
                    a(href: item.url, target:'_blank', "Learn more...")
                  }
                }
                hr(class: 'divider')
              }
              // ...
            }
          }
        }
      }
    }</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>make use of the <code>main</code> layout</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>the layout requires a <code>pageTitle</code> variable</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>as well as a <code>mainContent</code> section corresponding to the main page contents</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>example of use of an <code>include</code></td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>iterates over the <code>ecosys</code> variable which contains the list of ecosystem projects as found in the sitemap</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As you can see, this template format has the advantage of taking care of generating markup for you. You won&#8217;t hit your
head again on the wall to find an unclosed tag. Everything is embedded, readable and concise.</p>
</div>
</div>
<div class="sect2">
<h3 id="_lessons_learnt">Lessons learnt</h3>
<div class="paragraph">
<p>Using the <a href="http://beta.groovy-lang.org/docs/latest/html/documentation/markup-template-engine.html">markup template engine</a> for this project was interesting, because it was probably the first "real life" project
to use it intensively. And as such, we discovered usability issues, but also bugs. Hopefully, none of those bugs or
usability features were critical, and everything could be worked around, but expect some fixes in Groovy 2.3.5. It is
also the reason why the project initially used <a href="http://www.gradle.org">Gradle 2</a>: it comes with Groovy 2.3.2 which embeds the <a href="http://beta.groovy-lang.org/docs/latest/html/documentation/markup-template-engine.html">markup template engine</a>,
so it was possible to use it <strong>without</strong> organizing the project into separate modules like we have. In fact, the early
versions of the site didn&#8217;t use subprojects. It&#8217;s only when we wanted to leverage improvements from Groovy 2.3.4 that
we had to <a href="https://github.com/groovy/groovy-website/commit/e922701f747dbb78a7e695796c60d2b783f7e7ee">switch to that architecture</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_a_team_work">A team work</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the end, I can&#8217;t finish this blog post without mentionning the team work it implied. In particular:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://twitter.com/oodamien">Damien Vitrac</a> designed the website and produced HTML sketches. If you think the new site
looks good, thank this guy!</p>
</li>
<li>
<p><a href="https://twitter.com/glaforge">Guillaume Laforge</a> designed the site architecture, wrote contents, tweaked the CSS, that is to
say produced almost all contents. He spent countless hours fixing responsiveness issues and digging into front-end dev.</p>
</li>
<li>
<p><a href="https://twitter.com/CedricChampeau">I streamlined</a> the process by setting up the Gradle project, designing the sitemap DSL,
the integration of the <a href="http://beta.groovy-lang.org/docs/latest/html/documentation/markup-template-engine.html">markup template engine</a>, CI integration, &#8230; that is to say pretty much all the "backend" stuff.</p>
</li>
<li>
<p><strong>You</strong>, as a community, provided awesome <a href="https://github.com/groovy/groovy-website/pulls?direction=desc&amp;page=1&amp;sort=created&amp;state=closed">pull requests</a> within hours. Keep them coming, we love it!</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each of us have different skills. Guillaume is far better than I am in any kind of web design, styling issues, etc for example, so in the
end, I think the combination works quite good and that the site as it is now is already pretty usable.</p>
</div>
<div class="paragraph">
<p>Let us know what you think, and don&#8217;t forget that you can contribute, it&#8217;s easy!</p>
</div>
</div>
</div></p>
			<p><a href="/blog/2014/07/new-groovy-website.html#disqus_thread">Comments</a></p>
  			<a href="/blog/2014/06/contribute-groovy-ide.html"><h1>Contributing for the Groovy language: setting up IntelliJ IDEA</h1></a>
  			<p>24 June 2014</p>
			<p><em>Tags: </em>
		<a href="/blog/tags/groovy.html">groovy</a> 
	
		<a href="/blog/tags/intellij.html">intellij</a> 
	
		<a href="/blog/tags/gradle.html">gradle</a> 
	</p>
			<a href="https://twitter.com/share" class="twitter-share-button" data-text="Contributing for the Groovy language: setting up IntelliJ IDEA" data-url="http://melix.github.io/blog/2014/06/contribute-groovy-ide.html" data-via="CedricChampeau" data-lang="fr">Tweeter</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
			<div class="g-plusone" data-size="medium" data-href="http://melix.github.io/blog/2014/06/contribute-groovy-ide.html"></div>
		        <script id='fbvpgng2014/06/contribute-groovy-ide.html'>(function(i){var f,s=document.getElementById(i);f=document.createElement('iframe');f.src='//api.flattr.com/button/view/?uid=CedricChampeau&button=compact&url='+encodeURIComponent('http://melix.github.io/blog/2014/06/contribute-groovy-ide.html');f.title='Flattr';f.height=20;f.width=110;f.style.borderWidth=0;s.parentNode.insertBefore(f,s);})('fbvpgng2014/06/contribute-groovy-ide.html');</script>

			<script type="IN/Share" data-url="http://melix.github.io/blog/2014/06/contribute-groovy-ide.html" data-counter="right"></script>
			<div class="fb-like" data-href="http://melix.github.io/blog/2014/06/contribute-groovy-ide.html" data-layout="button_count" data-action="like" data-show-faces="false" data-share="true"></div>

  			<p><div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Often people ask us how you can setup a development environment to contribute on the Groovy project. If you use IntelliJ IDEA, it&#8217;s actually very easy, so I decided to make a video for it. It&#8217;s my first screencast ever, I think I will try to do more in the future, so please excuse my hesitations and enjoy! You&#8217;ll notice that apparently Google Hangouts dislikes my face, but hopefully, the screensharing stuff worked ;-)</p>
</div>
<div class="paragraph">
<p>Here&#8217;s the video:</p>
</div>
<iframe width="560" height="315" src="//www.youtube.com/embed/EhJa-Z8XDVw" frameborder="0" allowfullscreen></iframe>
<div class="paragraph">
<p>Of course, you can ask me if you have issues with the setup, but it should really be straightforward!</p>
</div>
</div>
</div></p>
			<p><a href="/blog/2014/06/contribute-groovy-ide.html#disqus_thread">Comments</a></p>
	
	<hr />
	
	<p>Older posts are available in the <a href="/blog/archive.html">archive</a>.</p>

		</div>
		<div id="push"></div>
    </div>
    
    <div id="footer">
      <div class="container">
	<p class="muted credit">All posts on this blog are published with a <em>Creative Commons by-nc-sa</em> license.<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/2.0/fr/"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-nc-sa/2.0/fr/88x31.png"/></a></p>
        <p class="muted credit">&copy; 2013 | Mixed with <a href="http://twitter.github.com/bootstrap/">Bootstrap v3.0.3</a> | Baked with <a href="http://jbake.org">JBake v2.3.0</a></p>
      </div>
    </div>
    
    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="/blog/js/jquery-1.9.1.min.js"></script>
    <script src="/blog/js/bootstrap.min.js"></script>
    <script src="/blog/js/run_prettify.js"></script>
    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
    <script type="text/javascript">
    var disqus_shortname = 'melixblog';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
    </script>
<script type="text/javascript">
  window.___gcfg = {lang: 'fr'};

  (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  })();
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-45962373-1', 'melix.github.io');
  ga('send', 'pageview');

</script>
<script src="http://cdn.lanyrd.net/badges/person-v1.min.js"></script>
  </body>
</html>
