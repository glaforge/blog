<?xml version="1.0"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Cédric Champeau's blog</title>
    <link>http://melix.github.io/blog/</link>
    <atom:link href="http://melix.github.io/blog//feed.xml" rel="self" type="application/rss+xml" />
    <description>JBake Bootstrap Template</description>
    <language>en-gb</language>
    <pubDate>jeu., 2 mars 2017 14:33:55 +0100</pubDate>
    <lastBuildDate>jeu., 2 mars 2017 14:33:55 +0100</lastBuildDate>

    <item>
      <title>Pourquoi je soutiens Benoît Hamon</title>
      <link>http://melix.github.io/blog/2017/03/soutien-hamon.html</link>
      <pubDate>mer., 1 mars 2017 00:00:00 +0100</pubDate>
      <guid isPermaLink="false">2017/03/soutien-hamon.html</guid>
      	<description>
	&lt;div id=&quot;preamble&quot;&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Cette élection présidentielle est unique. A bien des égards. La première raison, qui m&amp;#8217;est insupportable, est que pour la première fois, une candidate FN, Marine Le Pen, est en position de gagner cette élection: un mirroir de ce qui se passe à l&apos;échelle mondiale, avec un repli sur soi et une montée inquiétante du populisme. La seconde, parce qu&apos;évidemment jamais le rejet des politiques en place n&amp;#8217;aura été aussi important. Pour autant, c&amp;#8217;est aussi une opportunité, pour une fois, de changer radicalement de société. Les choix qui s&amp;#8217;offrent à nous sont particulièrement clairs: une droite extrêmement dure avec Fillon et Le Pen, ou une gauche sans compromis avec Hamon ou Mélanchon. Sans oublier, bien sûr, l&amp;#8217;outsider désormais favori Macron, dont je ne sais toujours pas s&amp;#8217;il a des convictions ou s&amp;#8217;il est simplement le reflet de la nature, qui a horreur du vide (je ne sais pas où voter, allons là où tout le monde semble se rallier).&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Pour ma part, je vote par conviction. J&amp;#8217;aurais bientôt 38 ans, et je dois dire que jamais, je n&amp;#8217;ai été si proche des idées d&amp;#8217;un candidat. Je le suis depuis plusieurs mois, bien avant la primaire, et mes amis proches savent que je leur en parlais et que je croyais en sa victoire. Dans ce billet, je veux vous donner quelques pistes pour lesquelles je soutiens Benoît Hamon, et pourquoi je vous invite à le rejoindre.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;admonitionblock note&quot;&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td class=&quot;icon&quot;&gt;
&lt;div class=&quot;title&quot;&gt;Note&lt;/div&gt;
&lt;/td&gt;
&lt;td class=&quot;content&quot;&gt;
A mes lecteurs habituels, ce billet n&amp;#8217;a rien à voir avec mes interventions techniques. Libre à vous de l&amp;#8217;ignorer. Par ailleurs, je souligne évidemment que ce qui est écrit ici n&amp;#8217;engage que moi, et personne d&amp;#8217;autre que moi.
&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_le_revenu_universel&quot;&gt;Le revenu universel&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Commençons par le revenu universel, parce qu&amp;#8217;il est le plus clivant. Même pendant la primaire des gauches, j&amp;#8217;ai entendu des absurdités incroyables à son sujet, ou des questions très orientées des journalites simplement destinées à décridibiliser cette proposition. Pourtant, c&amp;#8217;est une idée neuve, défendue par de nombreux économistes, &lt;a href=&quot;http://www.sudouest.fr/2017/01/25/dix-economistes-defendent-le-revenu-universel-de-Benoît-hamon-3137718-705.php&quot;&gt;de droite comme de gauche&lt;/a&gt;, ainsi que d&apos;éminents chefs d&amp;#8217;entreprise, tels &lt;a href=&quot;http://www.numerama.com/politique/232346-elon-musk-juge-le-revenu-de-base-necessaire-face-aux-progres-de-la-robotique.html&quot;&gt;Elon Musk, le fondateur Tesla, Space X, devenu richissime avec la revente de PayPal&lt;/a&gt;, &amp;#8230; Pas spécialement un exemple de ratage. Rappelons son principe de base: donner, à chaque citoyen, un revenu identique (dont le montant varie selon les propositions), universel, indépendemment de ses resources, à compter de sa majorité. A droite, on &lt;a href=&quot;http://www.liberation.fr/debats/2017/02/06/non-le-revenu-universel-ne-decourage-pas-le-travail_1546717&quot;&gt;crie alors à l&amp;#8217;assistanat&lt;/a&gt;. A gauche, on hurle qu&amp;#8217;il ne faut pas donner aux riches qui ont déja bien assez.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Mais le monde change. Le travail change. Quiconque vous dit le contraire est soit aveuglé, soit vous ment. Je travaille dans l&amp;#8217;informatique, et par mon activité professionnelle qui m&amp;#8217;amène à rencontrer de nombreux développeurs du monde entier, je pense être assez bien placé pour voir que ce je développe, ce qui arrive, est une nouvelle révolution industrielle (mais pas seulement, les services sont aussi touchés).&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;En France, vous aurez déja remarqué que les caissières se font moins nombreuses, qu&amp;#8217;il n&amp;#8217;y a plus personne aux péages, que le métro n&amp;#8217;a plus de conducteur, qu&amp;#8217;on nous vend du pain frais dans un distributeur&amp;#8230; Mais nous sommes très en retard.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;ulist&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;En Chine, où sont fabriqués nos précieux smartphones, les monstrueuses usines employant des dizaines de milliers d&amp;#8217;ouvriers ont déja entamé leur migration vers une &lt;a href=&quot;http://alltrends.over-blog.net/2017/02/une-entreprise-remplace-90-de-ses-employes-par-des-robots.html&quot;&gt;robotisation intégrale&lt;/a&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;A Singapour et aux Etats-Unis, les &lt;a href=&quot;http://www.lemonde.fr/economie/article/2016/08/25/les-premiers-taxis-sans-chauffeur-roulent-a-singapour_4988089_3234.html&quot;&gt;taxis sont remplacés par les voitures autonomes&lt;/a&gt; (notez l&amp;#8217;ironie, au passage: pour un Fillon ou un Macron dont le modèle est &lt;a href=&quot;http://www.streetpress.com/sujet/1488276642-coursier-velo-se-fait-virer&quot;&gt;l&amp;#8217;Uberisation de la société, l&amp;#8217;auto-entreprenariat&lt;/a&gt;, là où il est clair depuis des mois que le but de cette même entreprise est le 0 salarié&amp;#8230;). Des &lt;a href=&quot;http://thegoodlife.thegoodhub.com/2016/05/19/otto-camion-se-conduit-seul/&quot;&gt;poids lours conduisent tout seuls sur des centaines de kilomètres&lt;/a&gt;. &lt;a href=&quot;http://www.lemonde.fr/technologies/article/2013/12/02/des-paquets-livres-par-drones-d-ici-cinq-ans_3523489_651865.html&quot;&gt;Amazon livre par drones&lt;/a&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Au Japon, ce sont mêmes des &lt;a href=&quot;http://www.numerama.com/tech/221747-une-i-a-remplace-34-employes-dune-assurance-au-japon.html&quot;&gt;employés d&amp;#8217;une assurance qui sont remplacés par une intelligence artificielle&lt;/a&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Watson, l&amp;#8217;IA développée par IBM, a déja &lt;a href=&quot;https://www.letemps.ch/sciences/2016/09/22/un-outil-diagnostic-medical-nomme-watson&quot;&gt;diagnostiqué une leucémie que les médecins avaient ratée&lt;/a&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Un &lt;a href=&quot;https://www.theguardian.com/technology/video/2017/feb/28/meet-handle-the-two-wheeled-four-legged-hybrid-robot-video&quot;&gt;robot pourra bientôt transporter des charges lourdes à notre place&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Quoi qu&amp;#8217;on en pense, à moyen terme, la &lt;strong&gt;révolution robotique&lt;/strong&gt; est en marche, et c&amp;#8217;est une bonne chose. Bien sûr, on ne parle pas d&amp;#8217;un remplacement à court terme. Tout celà est progressif. Des métiers vont disparaître, d&amp;#8217;autres se transformer, d&amp;#8217;autres encore vont apparaître, mais il est indéniable que le volume de travail global disponible à l&amp;#8217;humain fond comme neige : nous sommes toujours plus nombreux sur la planète, le &lt;a href=&quot;https://data.oecd.org/chart/4KKb&quot;&gt;PIB augmente, pour autant le volume d&amp;#8217;heures travaillées évolue peu&lt;/a&gt;. L&apos;étude la plus optimiste de l&amp;#8217;OCDE indique que &lt;a href=&quot;http://www.lemonde.fr/economie/article/2016/05/20/pour-l-ocde-9-des-emplois-sont-menaces-par-les-robots_4923165_3234.html&quot;&gt;près de 10% des emplois sont menacés à court terme&lt;/a&gt;. Une autre étude parle elle de &lt;a href=&quot;http://www.francetvinfo.fr/replay-radio/nouveau-monde/les-robots-le-chomage-et-les-emplois-de-2030_1777669.html&quot;&gt;50% des emplois remplaçables par des robots à l&amp;#8217;horizon 2030&lt;/a&gt;. Lorsqu&amp;#8217;on choisit une politique, il ne faut pas penser à court terme, mais à nos enfants. Même s&amp;#8217;il est idiot d&amp;#8217;affirmer que le travail va disparaitre (qui peut sérieusement le croire ?), il se transforme, et il faut embrasser cette transformation.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;J&amp;#8217;en suis convaincu, les politiques qui ignorent ces changements vivent dans un monde qui n&amp;#8217;existe plus: ils achètent leur pain au chocolat à 10 centimes, font leurs courses chez Prisunic et rêvent de payer leurs assistants parlementaires européens en Francs. Ignorer les changements du travail, c&amp;#8217;est ignorer l&amp;#8217;avenir, s&amp;#8217;aliéner à ceux qui embrassent ce changement, perdre notre souveraineté. Au lieu de combattre ce futur, il faut au contraire s&amp;#8217;y préparer et repenser notre société autour de ces changements. L&amp;#8217;automatisation, la robotisation, n&amp;#8217;engendre pas de perte de valeur: celle-ci est toujours présente, les prix ne baissent en général pas: la productivité augmente et on réduit la pénibilité. Deux choix de société s&amp;#8217;engagent alors: profiter de cette amélioration pour vivre mieux, ou une fuite en avant productiviste. A ce sujet, je conseille la lecture de &lt;a href=&quot;https://crew.co/blog/why-you-shouldnt-work-set-hours/&quot;&gt;ce billet&lt;/a&gt; à mes lecteurs anglophones: ou comment le temps de travail est fonction des évolutions de la société, pas une constante.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Ceci appelle à une révolution fiscale: là où aujourd&amp;#8217;hui on taxe le travail, il faudra demain &lt;a href=&quot;http://www.lci.fr/elections/quelle-est-donc-cette-taxe-robots-proposee-par-Benoît-hamon-qui-seduit-jusqu-a-bill-gates-2026781.html&quot;&gt;taxer les robots&lt;/a&gt;, comme &lt;a href=&quot;http://fortune.com/2017/02/18/bill-gates-robot-taxes-automation/&quot;&gt;le propose aussi Bill Gates&lt;/a&gt;. Si ce terme peut faire sourire, il cache en réalité de nombreuses ramifications: évasion fiscale en particulier. Quelle pire injustice que de voir nos petites entreprises crouler sous des 30% de taxes, lorsque les grandes entreprises étrangères qu&amp;#8217;on utilise tous (smartphones, distribution), qui robotisent, automatisent et n&amp;#8217;embauchent quasiment pas, placent &quot;leur&quot; argent dans des paradis fiscaux et ne paient pas d&amp;#8217;impôts, grâce à des montages financiers complexes avec la complicité de nos cabinets comptables ? Ne marchons nous pas sur la tête ?&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Alors, oui, on peut continuer à sourire, dire qu&amp;#8217;il faut baisser les charges pour les entreprises et les salariés (ce qui serait une bonne chose), mais si on n&amp;#8217;embrasse pas cette virtualisation de l&apos;économie, on ne fait que réduire l&amp;#8217;assiète des cotisations, et se ruiner un peu plus.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Alors que vient faire le revenu universel là dedans ? Il permet:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;ulist&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;de mettre fin à la grande pauvreté, en particulier en remplaçant le RSA, belle idée mais tellement complexe que nombreux sont ceux qui y ont droit et ne le demandent pas. Par ailleurs, si le revenu est effectivement universel, l&amp;#8217;argument de la fraude aux aides ne tient plus: tout le monde y a droit, point.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;de favoriser le temps partiel. Dans certains Etats, comme les &lt;a href=&quot;http://www.lemonde.fr/economie/article/2016/02/03/aux-pays-bas-on-travaille-en-moyenne-30-heures-par-semaine_4858496_3234.html&quot;&gt;Pays-Bas, c&amp;#8217;est déja la norme, y compris chez les hommes&lt;/a&gt;, réduisant ainsi les inégalités homme-femme. Le PIB de ce pays n&amp;#8217;a pas chuté, les employés n&amp;#8217;en sont que plus heureux.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;de maintenir l&amp;#8217;emploi. Des histoires d&amp;#8217;agriculteurs qui travaillent comme des fous et ne s&amp;#8217;en sortent plus, on en lit tous les jours. Avec &lt;a href=&quot;https://twitter.com/Benoîthamon/status/836905767571697664&quot;&gt;350€&lt;/a&gt; par mois, franchement, vous resteriez? Je connais personnellement l&amp;#8217;un d&amp;#8217;entre eux qui a fini par abandonner. Avec le revenu universel, on permet à ces travailleurs pauvres de rester en poste.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;de choisir de travailler plutôt que rester à la maison. Je ne sais pas pour vous, mais le nombre de fois où j&amp;#8217;ai entendu quelqu&amp;#8217;un me dire &quot;avec mes frais de garde et de transport, ça me revient plus cher d&amp;#8217;aller travailler que de rester chez moi&quot;. Pas franchement encourageant, non?&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;de valoriser des activités non commerciales mais importantes pour la société : travail associatif, aides à la personne, &amp;#8230;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;de partager le travail: à coût égal pour une entreprise, il sera possible de prendre 2 salariés au lieu d&amp;#8217;un seul, et ainsi donc réduire les risques de TMS (pour les travaux manuels) ou burn-outs : il existe une limite physique à la productivité.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;En revanche, le RU ne rend pas les riches plus riches. C&amp;#8217;est un &lt;strong&gt;revenu&lt;/strong&gt;. En conséquence, il est imposable. Il s&amp;#8217;ajoute donc à votre salaire et suivant vos revenus, vous devrez payer ou non des impôts dessus. Il est donc incorrect de dire que ça coute 400 milliards (ou plus). En pratique, il coûte sensiblement moins, en particulier si son implémentation se fait &lt;em&gt;via&lt;/em&gt; un crédit d&amp;#8217;impôt. La justice fiscale est maintenue. Le soumettre à conditions de ressources, c&amp;#8217;est augmenter son coût intrinsèque (gestion, contrôles) ou inciter à la fraude pour quelque chose qui ne change au final rien. Quant à l&amp;#8217;argument de l&amp;#8217;incitation à l&amp;#8217;oisiveté, il me fait doucement sourire. A tous ceux qui me l&amp;#8217;ont avancé, je leur ai posé une question simple: si on vous donnait 600€ par mois, est-ce que vous quitteriez votre boulot ? Est-ce que ça vous suffirait ? Je pense que je n&amp;#8217;ai pas besoin de vous donner les réponses&amp;#8230;&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Alors, certains taxent cette proposition d&amp;#8217;irréaliste, utopique, irréalisable et j&amp;#8217;en passe. Ils doutent de sa crédibilité. Mais que proposent-ils ? Toujours les mêmes solutions ! Réduire les charges des entreprises (merci Fillon pour son exonération sur les bas salaires, effet d&amp;#8217;aubaine pour n&amp;#8217;augmenter personne, alors que la répartition de la valeur n&amp;#8217;a &lt;a href=&quot;http://www.inegalites.fr/spip.php?page=article&amp;amp;id_article=1156&quot;&gt;jamais été aussi dévaforable aux pauvres et classes moyennes&lt;/a&gt;). Augmenter la TVA (belle justice fiscale !). Qui se souvient, à l&amp;#8217;inverse, de la baisse de la TVA pour la restauration, en l&apos;échange, soit disant, d&amp;#8217;emplois et de baisses de prix ? Qui se souvient encore du badge &lt;a href=&quot;http://www.lemonde.fr/emploi/article/2014/09/24/pierre-gattaz-oui-il-est-possible-de-creer-un-million-d-emplois_4493160_1698637.html&quot;&gt;1 million d&amp;#8217;emplois de Pierre Gattaz&lt;/a&gt; en l&apos;échange du pacte de compétitivité ? Travailler plus, en défiscalisant les heures supplémentaires, encore une mesure populaire, mais qui ne crée pas d&amp;#8217;emplois (la vraie injustice), et n&amp;#8217;est qu&amp;#8217;un pansement sur une jambe de bois: est-ce que cette politique a déja une seule fois marché ?&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Autre question: qui peut encore croire que repousser l&apos;âge de la retraite est une solution, alors même que les seniors sont &lt;a href=&quot;http://www.lemonde.fr/societe/article/2011/07/29/chomage-les-seniors-sont-indesirables-dans-les-entreprises_1553945_3224.html&quot;&gt;&quot;trop vieux pour travailler&quot; dès 50 ans&lt;/a&gt; ? Je ne suis fondamentalement pas contre repousser l&apos;âge de la retraite (qui finalemement va de pair avec l&amp;#8217;augmentation de l&amp;#8217;espérance de vie), mais faire ça alors même que nos seniors sont au chômage n&amp;#8217;a aucun sens. Il faut d&amp;#8217;abord revaloriser l&amp;#8217;expérience, changer notre vision. Comment peut-on imaginer créer des emplois en faisant travailler plus ceux qui ont la chance d&amp;#8217;en avoir un, &lt;a href=&quot;http://www.francetvinfo.fr/replay-radio/on-s-y-emploie-de-philippe-duport/l-inquietante-progression-des-troubles-musculo-squelettiques_1790187.html&quot;&gt;quitte à les briser&lt;/a&gt; ?&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;60 milliards ont été engloutis dans le CICE, pour quel résultat ? Autre solution classique, se reposer sur une croissance, dont les prévisions sont systématiquement revues à la baisse, et donc les conséquences sur notre planète commencent sérieusement à se faire sentir ? Ou faciliter le licenciement, en croyant dogmatiquement que ça facilite l&amp;#8217;embauche ? Ce dont ont besoin les entreprises, ce n&amp;#8217;est pas de pouvoir licencier. Personne ne veut licencier par plaisir. Ce qu&amp;#8217;il faut, c&amp;#8217;est de la stabilité. Connaitre les règles du jeu à l&amp;#8217;avance, et qu&amp;#8217;elles ne changent pas tous les jours, ainsi qu&amp;#8217;une juste concurrence : que les petites paient les mêmes impôts que les grosses, et que les différences de législation entre partenaires commerciaux ne soient pas un frein aux entreprises locales (donc, un protectionnisme &lt;em&gt;raisonné&lt;/em&gt;). Alors, dites-moi, qui est irréaliste et utopique ?&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Alors, on va nous parler de &quot;valeur travail&quot;. Ou la réalisation par le travail. Est-ce là une valeur que je veux transmettre à mes enfants ? Non. Si le travail est important, il ne doit pas être le critère de réalisation, en particulier dans une société ou le travail se raréfie. C&amp;#8217;en est de plus insultant pour tous ceux qui ne trouvent pas d&amp;#8217;emploi, ou pour ceux qui s&amp;#8217;investissent autrement (associations, sportifs, artistes) et contribuent à la grandeur de notre pays. Ce que j&amp;#8217;enseigne à mes enfants, c&amp;#8217;est qu&amp;#8217;il faut se donner à fond et ne pas se fermer de portes. Je leur apprends la tolérance. Je leur apprends à apprécier la chance qu&amp;#8217;ils ont par rapport à d&amp;#8217;autres. Je leur apprends que l&amp;#8217;effort est récompensé, mais que parfois, la vie est injuste. Travailler, oui, mais choisir. Le choix, la liberté sont la clé de la réalisation.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Et d&amp;#8217;avenir, parlons-en.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_la_r_volution_cologique&quot;&gt;La révolution écologique&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Lorsqu&amp;#8217;on parle de révolution industrielle, on ne peut ignorer la transition écologique à mener, et son potentiel énorme en termes d&amp;#8217;emplois. La France a trop longtemps dirigé tous ses crédits vers le nucléaire, en en ignorant volontairement le coût réel (démantèlement, notamment) et son impact sur l&amp;#8217;environnement (bien sûr, un accident n&amp;#8217;arrive jamais). Mais le plus gros mensonge, c&amp;#8217;est encore notre fameuse indépendence énergétique. Faut-il rappeler d&amp;#8217;où vient le combustible si précieux dont nous avons besoin ? Pour autant, il ne faut pas être naif: sortir du nucléaire prend du temps, mais c&amp;#8217;est aussi une énorme opportunité. En échelonnant dans le temps, comme le propose Benoît Hamon, on permet de maintenir notre capacité de production, tout en ouvrant de nouvelles voies de développement, créant des emplois. La catastrophe serait de faire comme en Allemagne, où toutes les centrales ont été remplacées par des centrales à charbon, dont le bilan carbone est redoutable&amp;#8230; Cette &lt;a href=&quot;http://www.electricitymap.org/&quot;&gt;carte interactive&lt;/a&gt; est plus que parlante&amp;#8230;&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Mais l&apos;écologie ne se limite pas au nucléaire. L&amp;#8217;opposition ferme de Benoît Hamon aux perturbateurs endocriniens est un autre exemple de ce que j&amp;#8217;aime dans sa vision: il est temps d&amp;#8217;en finir avec la dictature de la croissance, qui détruit notre environnement et provoque de graves maladies. Penser que je puisse être responsable du futur cancer de mes enfants m&amp;#8217;est juste impossible: si je peux faire quelque chose aujourd&amp;#8217;hui, quitte à sacrifier un peu de confort (je suis le premier à changer de smartphone tous les 3/4 ans, mais en ai-je vraiment besoin ?), faisons-le. Il existe des solutions: circuits courts, production raisonnée, retour à une agriculture prenant en compte les spécificités régionales, réduction de notre consommation de viande, &amp;#8230; Nous devons aussi nous responsabiliser en tant que consommateurs: acheter toujours moins cher, c&amp;#8217;est inciter à la baisse des salaires ou à la délocalisation.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_la_r_publique&quot;&gt;La République&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Un des derniers points que je souhaite discuter ici est ma vision de la République. Tout d&amp;#8217;abord, je souhaite le retour au septennat. Je pense que le passage au quinquénat a été une catastrophe, contribuant à la peopolisation de la politique: on ne cherche plus à faire un projet, on parle tout de suite de la prochaine élection. Même si je n&amp;#8217;ai pas d&amp;#8217;idée précise de ce que doit être la prochaine République, il me semble clair que celle-ci est à bout de souffle. Conçue pour le Général de Gaulle, l&amp;#8217;homme providentiel. Je pense qu&amp;#8217;il faut revoir le rôle de Président, et qu&amp;#8217;il ne soit plus qu&amp;#8217;un garant de nos institutions. Pour celà, il nous faut une assemblée consistuante. Benoît Hamon n&amp;#8217;en parle pas spécialemement, et c&amp;#8217;est peut-être un des points où je suis plus en accord avec un Mélanchon que lui: il faut bien des points de désaccord. En particulier, je trouve l&amp;#8217;idée du 49-3 citoyen avec seulement 1% du corps électoral potentiellement dangereuse : la Manif pour Tous aurait pu bloquer le mariage homosexuel (oui, je suis de ceux qui pensent que donner des droits égaux à tous les citoyens n&amp;#8217;est pas supprimer vos propres droits), ou, du temps de Mitterand, je doute que la peine de mort aurait pu être abolie. En clair, je suis plutôt pour une proportionnelle intégrale, répondant à une crise de représentativité qu&amp;#8217;entretient élégamment le FN. Mais je suis aussi surtout pour la &lt;a href=&quot;https://fr.wikipedia.org/wiki/Tirage_au_sort_en_politique#Stochocratie&quot;&gt;stochocratie&lt;/a&gt;, où le fait de tirer au sort des représentants qui, eux, éliront ceux qui nous gouvernent.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_la_cit_et_peur_de_l_autre&quot;&gt;Laïcité et peur de l&amp;#8217;autre&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Une de mes plus grandes désillusions de l&apos;ère Hollande. C&amp;#8217;est là que le Parti Socialiste m&amp;#8217;a perdu. J&amp;#8217;ai été affligé par la Loi Renseignement. Non seulement elle est liberticide, mais elle est aussi dangereuse pour nos entreprises, réduisant considérablement les sécurités et garanties qu&amp;#8217;elles peuvent mettre en place pour leurs clients. Mais le plus grave, le divorce, ce fut la déchéance de nationalité. Sous prétexte de protéger nos concitoyens, nous créons deux catégories de personnes, ce qui est le contraire même des fondements de notre République. Plus encore, une trahison des valeurs de gauche. Aux élections qui ont suivi, pour la première fois de ma vie, je n&amp;#8217;ai pas voté PS. Fort heureusement, cette mesure n&amp;#8217;est jamais passé, j&amp;#8217;aurais eu honte, franchement.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;En ce qui concerne le débat sur la laïcité, là encore, je suis à 100% derrière la position de Benoît Hamon: la loi 1901 et rien que la loi 1901. En clair, il s&amp;#8217;agit de respecter la liberté de culte. Et respecter &lt;em&gt;toutes&lt;/em&gt; les religions. Point. Il faut être sacrément culotté (ou aigri), pour dire &quot;Benoît Hamon est en résonance avec une frange islamo-gauchiste&quot;. Malek Boutih, je vous le dis sincèrement, cest propos sont une honte pour la gauche. Les simples sous-entendus de cette phrase me dégoutent. Pire, vous avez donné des arguments à l&amp;#8217;extrème droite, que nous combattons de tout notre coeur. C&amp;#8217;est indigne et tellement typique de cette gauche archaïque (un paradoxe quand vous vous qualifiez de progressiste) et loin de ses valeurs. Après de telles sorties, ne soyez plus surpris que les gens votent FN et vous bottent les fesses aux élections.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Non, je crois aux valeurs humaines. Le FN tente de nous faire croire que 2000 migrants sont responsables du chômage en France, par pitié, non. Pire encore, les migrants violent nos femmes et mangent nos enfants. Et ils n&amp;#8217;avaient qu&apos;à &lt;a href=&quot;https://s2.qwant.com/thumbr/0x0/d/4/f17a15e2d5fe46ad9f63b25011b969/b_1_q_0_p_0.jpg?u=http%3A%2F%2Fd.ibtimes.co.uk%2Fen%2Ffull%2F1410255%2Faleppo-syria.jpg&amp;amp;q=0&amp;amp;b=1&amp;amp;p=0&amp;amp;a=1&quot;&gt;rester chez eux&lt;/a&gt;, ou &lt;a href=&quot;http://www.bfmtv.com/international/migrations-l-europe-sous-le-choc-apres-la-photo-d-un-enfant-mort-noye-911785.html&quot;&gt;apprendre à nager&lt;/a&gt;. Nom d&amp;#8217;un chien, où est passé le coeur de la France ? Doit-on laisser mourrir tous ces gens, les suspecter des pires crimes, ou être à la hauteur de notre histoire, nous, le pays des Droits de l&amp;#8217;Homme ? Se dire que l&amp;#8217;allemagne accueille des millions de migrants dans le même temps où l&amp;#8217;on fait des procès à &lt;a href=&quot;http://www.francetvinfo.fr/monde/europe/migrants/aide-aux-migrants-cedric-herrou-le-passeur-condamne_2056739.html&quot;&gt;Cédric Hérrou&lt;/a&gt;. Dois-je vous rappeler ce que la stigmatisation nous a apporté voici 80 ans ? Ce monde tourne sur la tête&amp;#8230;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_les_cas_macron_m_lanchon&quot;&gt;Les cas Macron / Mélanchon&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Pour terminer, parlons rapidement d&amp;#8217;Emmanuel Macron et Jean-Luc Mélanchon. A la lecture de ce billet, certains peuvent se dire que je pourrais choisir Mélanchon. C&amp;#8217;est vrai, lui et Hamon partagent beaucoup d&amp;#8217;idées, tout comme les Verts et à ce titre je suis dépité qu&amp;#8217;un accord entre les 3 n&amp;#8217;ait pas eu lieu. C&apos;était, à mon humble avis, une opportunité unique pour la gauche compte-tenu de la conjecture actuelle. Je pense, pour ma part, que Benoît Hamon a véritablement compris la transition économique qui nous attend et a une personnalité moins clivante. Les solutions de repli sur soi ne fonctionneront pas. Pas plus que les solutions de Macron, qui reste une énigme. Ses discours sont d&amp;#8217;une platitude déconcertante, ses solutions en matière d&apos;économie sont peu ou prou les mêmes que celles de Fillon (libéralisation à outrance du marché du travail), et pourtant&amp;#8230; il monte, il monte&amp;#8230; Le ralliement de François Bayrou, celui là même qui disait, il y a quelques semaines, que &lt;a href=&quot;http://www.lefigaro.fr/elections/presidentielles/2017/02/22/35003-20170222ARTFIG00291-avant-de-le-soutenir-bayrou-attaquait-durement-macron.php&quot;&gt;Macron était piloté par les banquiers&lt;/a&gt; (ce qui est toujours possible puisqu&amp;#8217;il refuse d&amp;#8217;indiquer qui le finance)&amp;#8230; Je peux me tromper, mais je ne crois pas non plus à la fin du clivage droite-gauche. Nos idées sont différentes. Nos visions de la société sont différentes. Progresser, c&amp;#8217;est choisir une vision, et y aller. Faire cohabiter des idées si différentes au sein d&amp;#8217;un même gouvernement ne peut conduire qu&apos;à prendre de &quot;petites&quot; décisions ne frustrant personne. Soyez rassurez, cependant, je ne mets pas Emmanuel Macron au même niveau que François Fillon ou Marine Le Pen&amp;#8230;&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;En conclusion, je ne suis pas crédule non plus, tout ceci n&amp;#8217;est pas réalisable en un jour et c&amp;#8217;est pour celà je j&amp;#8217;aime l&amp;#8217;approche de Benoît Hamon: &lt;strong&gt;jamais&lt;/strong&gt; il ne s&amp;#8217;est présenté comme le candidat providentiel, qui a la réponse à tout. Il faut laisser le temps à une politique de se mettre en place (d&amp;#8217;où le septennat). Hamon est un homme qui a une vision, il a travaillé ses dossiers, mais c&amp;#8217;est aussi un &lt;a href=&quot;https://www.Benoîthamon2017.fr/2017/02/22/rejoignez-le-conseil-citoyen/&quot;&gt;team player&lt;/a&gt;. Toutes ses mesures sont réfléchies, travaillées, et vont dans le sens d&amp;#8217;un projet à long terme: un avenir désirable.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;La société que l&amp;#8217;on souhaite pour nos enfants. C&amp;#8217;est à eux que je pense en le choisissant. Ce dont ils ont besoin, c&amp;#8217;est d&amp;#8217;espoir. Je ne veux pas qu&amp;#8217;ils grandissent dans ce monde qu&amp;#8217;on nous promet:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;ulist&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://www.marianne.net/societe/auchan-city-de-tourcoing-apres-la-fausse-couche-d-une-caissiere-les-inquietants-recits-de&quot;&gt;https://www.marianne.net/societe/auchan-city-de-tourcoing-apres-la-fausse-couche-d-une-caissiere-les-inquietants-recits-de&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;http://www.streetpress.com/sujet/1488276642-coursier-velo-se-fait-virer&quot;&gt;http://www.streetpress.com/sujet/1488276642-coursier-velo-se-fait-virer&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;http://www.bfmtv.com/societe/vaucluse-suicide-d-un-agriculteur-dont-l-exploitation-etait-en-difficulte-963138.html&quot;&gt;http://www.bfmtv.com/societe/vaucluse-suicide-d-un-agriculteur-dont-l-exploitation-etait-en-difficulte-963138.html&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://francais.rt.com/france/19526-hauts-seine&amp;#8212;tabassee-pour&quot;&gt;https://francais.rt.com/france/19526-hauts-seine&amp;#8212;tabassee-pour&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Et vous ?&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
	</description>
    </item>
    <item>
      <title>Gradle and Kotlin, a personal perspective</title>
      <link>http://melix.github.io/blog/2016/05/gradle-kotlin.html</link>
      <pubDate>dim., 22 mai 2016 00:00:00 +0200</pubDate>
      <guid isPermaLink="false">2016/05/gradle-kotlin.html</guid>
      	<description>
	&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_gradle_embraces_kotlin_what_about_groovy&quot;&gt;Gradle embraces Kotlin, what about Groovy?&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;First of all, it&amp;#8217;s been a long time since I last blogged, and I&amp;#8217;d like to remind that everything written here are opinions of my own and not the views of my employer, which happens to be Gradle Inc as write those lines.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;A few days ago, &lt;a href=&quot;http://gradle.org/blog/kotlin-meets-gradle/&quot;&gt;Gradle and Jetbrains announced a partnership to make Kotlin a first class language for Gradle builds&lt;/a&gt;, both for build scripts and plugins. Most likely, you know Gradle has been using Groovy since its inception. Lots of people think that Gradle is written in Groovy, which is actually wrong. Most of Gradle is written in Java. The builds scripts are written in Groovy, lots of plugins are written in Groovy, our test cases are written in Groovy (using the best testing framework out there, Spock), but Gradle itself is written in Java.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;From my perspective, this is situation has been very disturbing and continues to be so. I have very good friends in the Groovy community, and this move has been seen by some of them as a betrayal. As an Apache Groovy committer, and someone who spent almost 4 years full time implementing new features of the language, most importantly its static compiler, seeing Kotlin promoted as the language of choice for Gradle&amp;#8217;s future, it&amp;#8217;s a little &lt;em&gt;strange&lt;/em&gt;. One could legitimely say, &lt;em&gt;WTF?&lt;/em&gt; I&amp;#8217;ve been aware of this work for several months now, and my colleagues Rodrigo B. de Oliveira and Chris Beams have done an amazing job in a very short period of time. From a long time Groovy user and Groovy developer point of view, it&amp;#8217;s hard not to make this move an emotional thing. However, business is not about emotions. In particular, what are we trying to acheive with Gradle? We&amp;#8217;re trying to help developers build their applications. We&amp;#8217;re trying to make this elegant, reproducible, scalable and fast. We&amp;#8217;re language agnostic. We can build Java, Groovy, Scala, Kotlin, C++, Python, &amp;#8230; Gradle has never been the tool to build Groovy applications: it&amp;#8217;s been a tool to build software. It&amp;#8217;s a tool about automation. And I&amp;#8217;ve been complaining enough about communities that build their own tool for their very specific language to understand that this is super important: Gradle is (or aims at) the best tool for building any kind of software. In short, we must think in terms of what is best for our users, and sometimes, this means changing technogies. A product should not be bound to a technology, but a company should even less be bound to it. And given the response that we had after the announcement, supporting Kotlin seem to drive a lot of excitement around Gradle, and that&amp;#8217;s a very good thing. So, let&amp;#8217;s take that out, and think what it means for Groovy.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_groovy_support_is_not_abandoned&quot;&gt;Groovy support is not abandoned&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;First of all, I already said it several times, but better continue to spread the message: support for Groovy in Gradle is &lt;strong&gt;not&lt;/strong&gt; deprecated nor removed. You can still write your scripts in Groovy, you can write your plugins in Groovy, and you will still be able to do it. But Gradle will likely encourage users to migrate to Kotlin. To be clear, Kotlin support is incubating, and there&amp;#8217;s a lot to do to make it as usable as the Groovy version. Second, there are tens of thousands of builds written using Groovy, hundreds of plugins written in Groovy, so it&amp;#8217;s not tomorrow that Kotlin is going to replace Groovy. However, we care about the future, so we need to think about what it means in the long term. Should we be excited about supporting Kotlin? Yes we should, because Kotlin is an amazing language. Should we continue to be excited about Groovy? Of course we should, because it&amp;#8217;s also an amazing language. But it&amp;#8217;s old and as such brings a lot of legacy with it. As someone who implemented the static compiler for Groovy, I know it very well. There are things that are hard to change, because a large part of the Groovy community is very fond of its dynamic behavior.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;So let&amp;#8217;s focus on the two major aspects that led to embracing Kotlin in Gradle. The fist one, and principal, is IDE support. Let&amp;#8217;s face it: even before I joined Gradle, when I was giving talks about it, people were complaining about IDE support. Compared to a tool like Maven, supporting Gradle build scripts is complicated. Supporting XML is easy (to some extent). Supporting a &lt;em&gt;dynamic DSL&lt;/em&gt; is not. Some say it&amp;#8217;s Groovy&amp;#8217;s fault, and I want to correct this statement right now: it&amp;#8217;s not Groovy&amp;#8217;s fault. While Groovy let&amp;#8217;s you design dynamic DSLs, the design of the DSL can be changed to make it easier for tools to &quot;discover&quot; things. But when Gradle was designed, there wasn&amp;#8217;t any statically compiled Groovy. The idiomatic way to write DSLs in Groovy, at that time, was to heavily rely on &lt;em&gt;runtime metaprogramming&lt;/em&gt;. While loving &lt;em&gt;metaprogramming&lt;/em&gt;, I&amp;#8217;ve always prefered &lt;em&gt;compile time&lt;/em&gt; metaprogramming over &lt;em&gt;runtime&lt;/em&gt; metaprogramming. For multiple reasons:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;ulist&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;because in most cases, what you want to do at runtime can be done in a unique, setup phase. For example, create your metaclasses, enrich existing types, configure &lt;em&gt;property missing&lt;/em&gt;, &lt;em&gt;method missing&lt;/em&gt;, &amp;#8230; If it&amp;#8217;s setup, it&amp;#8217;s better done at compile time, because you can report errors, and because it gives higher performance. This led the way I designed the static compiler, and more features of Groovy after that (traits, type checking extensions, &amp;#8230;) : describe what you want to do at compile time.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;because it makes the life of tools easier. While IntelliJ or Eclipse support &lt;em&gt;DSL descriptors&lt;/em&gt; that help them provide completion, those are hard to implement, and often inaccurate. They can only approximate what is going to happen at runtime. And in the end, you&amp;#8217;re doing the same job twice: you&amp;#8217;re writing a runtime for your DSL, which is dynamic, then you need to write a DSL descriptor for the IDE to understand it. Wouldn&amp;#8217;t it be better if all was done in a unique place? Something that both the compiler and the IDE can understand?&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;So while we &lt;em&gt;know&lt;/em&gt; we can describe dynamic Groovy DSLs so that they are understood by IDEs, it&amp;#8217;s effectively a lot of work. And if you want to support multiple IDEs, it&amp;#8217;s even more work. But in the case of Gradle, it&amp;#8217;s even worse: each plugin can provide it&amp;#8217;s own &quot;micro DSL&quot;. While there&amp;#8217;s an &quot;idiomatic&quot; way to configure Gradle builds, it&amp;#8217;s no single rule. One can implement it&amp;#8217;s own Groovy DSL within the Gradle build. And no luck the IDE would ever understand it. Another pain point is that Gradle adds complexity to complexity in terms of DSL capabilities. For example, when you have a build script that has:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;prettyprint&quot;&gt;&lt;code&gt;dependencies {
   compile libraries.groovy
}

greeter {
   message = &apos;hello&apos;
}

sign {
   signature = top
}
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;often people do not realize that:
   - &lt;code&gt;dependencies&lt;/code&gt; is found on a &lt;code&gt;Project&lt;/code&gt; instance
   - &lt;code&gt;libraries&lt;/code&gt; is a user declared variable, that can be found in a plugin, another build script, a project properties file, &amp;#8230; (how does the IDE find about it?)
   - &lt;code&gt;greeter&lt;/code&gt; is a &lt;em&gt;convention object&lt;/em&gt;, defined by a plugin, to configure the default values of its task
   - &lt;code&gt;sign&lt;/code&gt; is a &lt;em&gt;task&lt;/em&gt;, which has a &lt;code&gt;signature&lt;/code&gt; property, and &lt;code&gt;top&lt;/code&gt; references an &lt;em&gt;extension property&lt;/em&gt; from the project&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;So while this build script is &lt;em&gt;simple to read&lt;/em&gt;, it&amp;#8217;s &lt;em&gt;hard to understand how it effectively works&lt;/em&gt;, because objects can be found at different places, can be provided by different providers (plugins, properties, extensions), but everything is accessed using a single notation. This is bad, because it makes it almost impossible for an IDE to understand what is going on.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The question is, is it Groovy&amp;#8217;s fault? My answer is &lt;em&gt;not totally&lt;/em&gt;. The fault is mostly on the DSL design, and Groovy made it too easy to do so. But again, that was designed at a time when dynamic Groovy was the rule. I gave a talk, recently, about &lt;a href=&quot;https://www.google.fr/url?sa=t&amp;amp;rct=j&amp;amp;q=&amp;amp;esrc=s&amp;amp;source=web&amp;amp;cd=1&amp;amp;cad=rja&amp;amp;uact=8&amp;amp;ved=0ahUKEwiW2Mftt-7MAhWKSRoKHQJtCcIQtwIIHTAA&amp;amp;url=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DnqqGtdvPzus&amp;amp;usg=AFQjCNH57qeR_jUUIAmGKZiQOK99v0669w&quot;&gt;building modern DSLs with Groovy&lt;/a&gt;, where I discourage such practices, and encourage the use of &lt;em&gt;static DSLs&lt;/em&gt; instead.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;That leads me to the second main reason of embracing Kotlin in Gradle: performance. When we talk about performance, lots of folks tend to think that Groovy is slow. This is not the case. Groovy is pretty fast. However, depending on the design of the DSL, you can easily fall into traps that can lead to catastrophic performance. Before I go further with it, I&amp;#8217;m reading way to often that Gradle is slow &lt;em&gt;because it&amp;#8217;s written in Groovy&lt;/em&gt; and that &lt;em&gt;Groovy is dynamic so it&amp;#8217;s slow&lt;/em&gt;. F* no, those who tell you that just didn&amp;#8217;t profile a build. As I said, Gradle is mostly written in Java. And I&amp;#8217;ve spent the last 3 months optimizing the performance of Gradle, and I can tell you that of the dramatic performance improvements that one can see in Gradle 2.13 and 2.14, almost none was obtained by rewriting Groovy to Java, or rewriting Groovy code. None! Most of the hotspots were pure Java code. Period. However, as soon as you use plugins, which are today mostly written in dynamic Groovy, or that your build scripts imply a lot of nested closures, things start to become complicated for &quot;Groovy&quot;. Let me explain that clearly. I think at some point, someone made a terrible design decision in Groovy. I don&amp;#8217;t know who it was, but the idea was to rely on exceptions to control the flow of resolution of properties. This means that when a property is &lt;em&gt;missing&lt;/em&gt;, typically in a closure, an exception is thrown. When a method is not found, an exception is thrown. When a property is not found, an exception is thrown. That seemed to be a good idea, because in the end, you want to provide the user with an error, but in practice, this is catastrophic, because Groovy can capture those exceptions. Typically, in a delegation chain (nested closures), a containing closure or class can actually have this property defined, or implement &lt;em&gt;property missing&lt;/em&gt;/&lt;em&gt;method missing&lt;/em&gt;. Now, re-think a second about the &quot;simple&quot; example of Gradle build above: how do you now where to look up for &lt;code&gt;message&lt;/code&gt;, &lt;code&gt;top&lt;/code&gt;, &lt;code&gt;signature&lt;/code&gt;, &amp;#8230;? Now you know: f* exceptions are thrown, stack traces are filled, and eventually captured because some composite dynamic object finally wants to answer the message&amp;#8230; In practice, for some builds I have profiled, it was tens of thousands of exceptions being thrown and stack traces filled for nothing. And that has a terrible impact on performance. So even if we have implemented strategies in Gradle to try to avoid throwing those exceptions (which are responsible for part of the performance improvements in 2.14), this is very hard to do it, and we&amp;#8217;re still throwing way too many of them. A static language doesn&amp;#8217;t have this problem, because every single reference in source is resolved at compile time. So, if you&amp;#8217;re writing a plugin in Groovy, for the sake of performance, please add &lt;code&gt;@CompileStatic&lt;/code&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;So there goes Kotlin. Kotlin has excellent static builders support, that make it practical both for IDE support, which will dramatically improve user experience in terms of understanding what do write, what is an error, having documentation, refactorings, &amp;#8230; and is a very pleasant language to work with. Honestly, I don&amp;#8217;t have anything bad to say about the language (apart from the &lt;em&gt;fun&lt;/em&gt; keyword that I don&amp;#8217;t like). To some degree, it&amp;#8217;s not very surprising: Kotlin has heavily inspired by Groovy and another popular JVM language: Scala. And again, being the one behind the static compiler of Groovy, I can&amp;#8217;t blame them for doing what I like about static languages. Their builder support is awesome, and very elegant. And it&amp;#8217;s supported out of the box by IntelliJ of course, but also Eclipse.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_a_static_dsl_for_groovy&quot;&gt;A static DSL for Groovy?&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Ok, so one might think at this point that I&amp;#8217;m mad. I wrote a &quot;competing&quot; language, and I&amp;#8217;m happy to see Kotlin being promoted in Gradle. I wrote the static compiler, that is capable of doing everything Kotlin can do (minus reified generics, plus superior scripting support, type checking extensions, &amp;#8230;), so wtf? Ok, so let&amp;#8217;s be very clear: I have absolutely no doubt that Groovy can do everything that we&amp;#8217;ve done with the Kotlin support in Gradle. It can be statically compiled, provide an elegant DSL that is statically compiled, and it can be understood by the IDE. I had no doubt before the Kotlin work started, I have even less doubts now. And I can say I have no doubts because I tried it: I implemented experimental support for statically compiled Gradle scripts, written in Groovy. Here&amp;#8217;s an example:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;prettyprint&quot;&gt;&lt;code&gt;apply plugin: &apos;java&apos;
apply plugin: &apos;eclipse&apos;
apply plugin: &apos;idea&apos;
apply plugin: &apos;groovy&apos;
apply plugin: GreetingPlugin

repositories {
    mavenCentral()
}

dependencies {
    compile &apos;commons-lang:commons-lang:2.5&apos;
    compile &quot;commons-httpclient:commons-httpclient:3.0&quot;
    compile &quot;commons-codec:commons-codec:1.2&quot;
    compile &quot;org.slf4j:jcl-over-slf4j:1.7.10&quot;
    compile &quot;org.codehaus.groovy:groovy:2.4.4&quot;
    testCompile &apos;junit:junit:4.12&apos;
    runtime &apos;com.googlecode:reflectasm:1.01&apos;
}

tasks.configure(&apos;test&apos;, Test) {
    jvmArgs &apos;-XX:MaxPermSize=512m&apos;, &apos;-XX:+HeapDumpOnOutOfMemoryError&apos;
}

dependencies {
    compile &apos;org.codehaus:groovy:groovy-all:2.4.4&apos;
}

extension(GreetingPluginExtension) {
    message = &apos;Hi&apos;
    greeter = findProperty(&apos;greeter&apos;)?:&apos;static Gradle!&apos;
}

tasks.create(&apos;dependencyReport&apos;, DependencyReportTask) {
    outputs.upToDateWhen { false }
    outputFile = new File( project.buildDir, &quot;dependencies.txt&quot;)
}

class GreetingPlugin implements Plugin&amp;lt;Project&amp;gt; {
    void apply(Project project) {
        project.extensions.create(&quot;greeting&quot;, GreetingPluginExtension)
        project.task(&apos;hello&apos;) &amp;lt;&amp;lt; {
            println &quot;${project.extension(GreetingPluginExtension).message} from ${project.extension(GreetingPluginExtension).greeter}&quot;
        }
    }
}

class GreetingPluginExtension {
    String message
    String greeter
}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This is an example Gradle build that is compiled statically. It has none of the problems I described about the Groovy implementation in Gradle above. It uses all the techniques that static Groovy provides: extension methods, powerful scripting with implicit imports, type checking extensions, &amp;#8230; All this works. And interestingly, the work that is done to enable support for Kotlin also benefits to statically compiled Groovy, and Java! Let&amp;#8217;s not forget about the latter, which is years behind in terms of &quot;modern&quot; languages support. So if this works, why do we need Kotlin? To be honest, I asked it to myself many times. It was very difficult to me, because I knew Groovy could do it. Again, I had no doubt about the language capabilities, no doubt about the performance impact of doing this. However, I missed two critical points:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;olist arabic&quot;&gt;
&lt;ol class=&quot;arabic&quot;&gt;
&lt;li&gt;
&lt;p&gt;IDE support. Even if support of Groovy in IntelliJ is by far the most advanced of all other IDEs, it still lacks behind when static compilation is on. But more importantly, it doesn&amp;#8217;t know that my script is statically compiled, nor does it now about my custom extension methods. I tried to implement a &lt;code&gt;GDSL&lt;/code&gt; descriptor to make it aware of them, and it somehow worked: I do have code completion, but errors are not marked as errors, and the IDE still doesn&amp;#8217;t understand that it should only suggest to me what is relevant in the context. With Kotlin scripts which are &lt;em&gt;natively static&lt;/em&gt;, there&amp;#8217;s no such issue. The IDE understands everything natively, in IntelliJ and Eclipse. So, I have no doubt that Jetbrains can implement support for this, just like I had no doubt I could implement a static Groovy DSL, but who is going to write this? Me? Gradle? I don&amp;#8217;t have the time to do it. And it&amp;#8217;s not Gradle&amp;#8217;s job to write IDE plugins. And what about Eclipse? One big issue that the Groovy community has, &lt;strong&gt;today&lt;/strong&gt;, is that nobody is supporting Eclipse since Pivotal dropped sponsorship of Groovy. After more than one year, nobody took over the development of Groovy Eclipse. Nobody. While Groovy itself saw lots of new contributors, while we saw a lot of bugfixes, new contributors and that the download numbers where never as high as they are today, IDE support is critical. And nobody took over the development of it. I saw some people referring to what Jetbrains is doing as &quot;blackmailing&quot;. Seriously? Jetbrains? Think of what they&amp;#8217;ve done for Groovy. Groovy would never has been as popular as it is without them. They provided us with the best Groovy IDE possible. They are constantly supporting new features of the language, adding support for AST transformations, traits, &amp;#8230; They even added the ability, in IDEA 14, to use Groovy (and not Kotlin, guys!) as the language to evaluate expressions in the debugger. And they would try to kill Groovy? Kill part of their business? Come on guys! So yes, they invested a lot in Kotlin and want to promote it, but how could it be otherwise? And it&amp;#8217;s not like if the language sucked: it&amp;#8217;s awesome!&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Does it make sense? Now that we made the decision to support Kotlin, that we proved it would provide the level of user friendliness we want and that it is statically compiled by default, does it make sense to put resources to support static Groovy in addition? I don&amp;#8217;t have an answer to this. I thought yes, but now I&amp;#8217;m not sure. Kotlin does the job. And honestly, they have great engineers working on the language. Even if it lacks behind in terms of scripting and compilation times compared to Groovy, I have no doubt they will fix it. How arrogant would we be if we thought other languages could not do what we&amp;#8217;ve done with Groovy?&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_the_future_of_groovy&quot;&gt;The future of Groovy&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The last point I want to address is what it means for the future of Groovy, and what it means for &lt;strong&gt;my&lt;/strong&gt; future in Groovy. First of all, I always thought that the future of Groovy was in the hands of its community. It&amp;#8217;s not Gradle that has Groovy&amp;#8217;s future in its hands. It&amp;#8217;s &lt;strong&gt;you&lt;/strong&gt;. The move to the Apache Software Foundation was also done for this very same reason: community first. If you want to continue to use Groovy, to improve it, to support it, all you have to do is f* do it! And I will continue! I love this language, I know too well how far it can go in terms of DSL support, AST transformations, now in 2.5 we have macros, that&amp;#8217;s just a crazily powerful language that&amp;#8217;s super fun to use. Should we fear competition? No, we shouldn&amp;#8217;t. Competition is good. It should be inspiring. And if Gradle moving to Kotlin means the death of Groovy, maybe the problem is elsewhere. And even if lots of people get introduced to Groovy through Gradle, it&amp;#8217;s not the only entry point. Grails is another. Jenkins (through Flow) is another. And many, many more. There was a tweet a few days ago which showed the 100 most popular dependencies in GitHub projects. Groovy was one of them. No Kotlin. No Scala. Groovy. It&amp;#8217;s everywhere, and it&amp;#8217;s going to be there for a long time.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Part of the fears of the community is, after the Pivotal demise, if Groovy is a dying language. It&amp;#8217;s not. It has never been so widely used. The move to Apache Software Foundation drove a lot of attention and brought us many more contributors. But the community has to realize what the problems with Groovy are, and it has to face them: the introduction of the static compiler was too late. IDE support is important. Java 9 support is going to be super important. If you love your language, contribute. Help it. Help yourselves. The future of Groovy &lt;strong&gt;must&lt;/strong&gt; be in your hands. I can&amp;#8217;t recall how many times I told this, since I joined VMware, a few years ago, to develop Groovy. In every talk I give, I&amp;#8217;m always telling how important it is that &lt;strong&gt;you&lt;/strong&gt; contribute. Jetbrains is not going to write Groovy Eclipse for you.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;And I would like to finish with one word: if people move from Groovy to Kotlin, is it really a problem? Isn&amp;#8217;t any technology inspired by another? Aren&amp;#8217;t we, developers, always rebuilding the same things, but improving them, learning lessons from the past? Is Kotlin a better Groovy? I don&amp;#8217;t have the answer yet. Maybe it is. Maybe not. Today Groovy remains greatly superior in terms of scripting, DSL support, but it comes with a price that Gradle doesn&amp;#8217;t want to pay. And let&amp;#8217;s not forget the original community of Groovy: a &lt;strong&gt;dynamic&lt;/strong&gt; language for the JVM. There are still &lt;strong&gt;lots&lt;/strong&gt; of people who like this aspect of the language (and I do too, typically when I write Groovy scripts in place of bash scripts, I don&amp;#8217;t care about types). It&amp;#8217;s compile time metaprogramming features also make it incredibly powerful. Modern Groovy definitely doesn&amp;#8217;t deserve its &quot;bad press&quot;. Would you compare Java 8 with Java 1? No. So don&amp;#8217;t compare Groovy 2.4 with Groovy 1 either. Reputation should change, and you can help there too.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This leads me to what I should do. And there, I&amp;#8217;m a bit lost, to be honest. I work for a company that embraced Groovy, that is now embracing Kotlin. I love my job, I love working with Gradle, I love Groovy, and I quite enjoy Kotlin. I&amp;#8217;m a passionate developer. I just want to continue having fun. But if you think that as such, I&amp;#8217;m not a good representative of the Groovy community anymore, maybe I should step off from the Groovy project. I would hate that, but I&amp;#8217;ve kind of been hurt by the bad comments we (Gradle) received from some members of the Groovy community. I don&amp;#8217;t want to fall into a language war, I don&amp;#8217;t care about this. I care about users. What I love to do is helping people, period.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I would like to finish this post with a thought about what I&amp;#8217;m going to do, as a Gradle developer, for you, Groovy users. In particular, I am convinced that the success of Gradle is largely due to its Groovy DSL, despite its problems. The fact that it&amp;#8217;s simple, easy to read, is super important. I joined the Groovy project because I was using Groovy as a DSL platform in a natural language processing context. Groovy is super powerful for this. And I learnt a lot in terms of DSL design. In particular, I will try to make sure that it doesn&amp;#8217;t become a Kotlin API. What I mean by that is that I think we should elevate from a Groovy DSL to a Gradle language. And this language is meant at &lt;strong&gt;describing&lt;/strong&gt; builds. And our users are not Kotlin developers. Most of them are not Groovy developers either. They are, as I described earlier, from different horizons. And I would hate if a user would have to understand concepts like generics or type inference to write a build script. That would be horribly wrong. A build author should understand how to &lt;em&gt;model an application&lt;/em&gt;, not what is a type, what is an extension method, or generic return type inference. It&amp;#8217;s different for &lt;em&gt;plugin authors&lt;/em&gt;, but for a &lt;em&gt;build author&lt;/em&gt;, it&amp;#8217;s super important. So I will try to make sure that Kotlin scripting support improves, even if it means that it would go even closer to what Groovy supports. I would do this not because I want Groovy to die, I don&amp;#8217;t (and it wouldn&amp;#8217;t help my royalties for Groovy in Action 2 ;)), but it would help users or Gradle. That&amp;#8217;s what I care most about, just like I care about what Groovy users want when I work on the Groovy project.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;As for talking about Gradle, Groovy and its future, I&amp;#8217;ll be a GR8Conf next week, I&amp;#8217;d be happy to answer you in person there too!&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Keep on Groovying!&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
	</description>
    </item>
    <item>
      <title>A week fighting a PermGen leak</title>
      <link>http://melix.github.io/blog/2015/08/permgenleak.html</link>
      <pubDate>sam., 29 août 2015 00:00:00 +0200</pubDate>
      <guid isPermaLink="false">2015/08/permgenleak.html</guid>
      	<description>
	&lt;h1 id=&quot;_a_challenge_at_gradle&quot; class=&quot;sect0&quot;&gt;A challenge at Gradle&lt;/h1&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_a_new_job&quot;&gt;A new job&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This is my first blog post after 4 months being a full time employee of &lt;a href=&quot;https://www.gradle.org&quot;&gt;Gradle Inc.&lt;/a&gt;! I am pretty excited by this job, even though so far it didn&amp;#8217;t give me much time to contribute to &lt;a href=&quot;http://groovy-lang.org&quot;&gt;Apache Groovy&lt;/a&gt; (but we did manage to release 2.4.4 though). One of the reasons I joined the company was because I love technical challenges. And &lt;a href=&quot;https://www.gradle.org&quot;&gt;Gradle&lt;/a&gt; has a lot of them, with an incredible team of smart people working together to make software automation better. This week, I worked on my first true challenge, and I must confess that I miserably failed :-) This is a long post, and anyone who ever fought against the infamous &quot;PermGen space error&quot; in their application is going to understand why&amp;#8230;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_codenarc_as_the_source_of_a_leak&quot;&gt;CodeNarc as the source of a leak?&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The first suspicious piece of code that draw our attention was &lt;a href=&quot;http://codenarc.sourceforge.net/&quot;&gt;CodeNarc&lt;/a&gt;. CodeNarc is a source code quality analysis tool for Groovy, which is used by a lot of Groovy developers, including in Gradle itself (since Gradle intensively makes use of Groovy). &lt;a href=&quot;http://codenarc.sourceforge.net/&quot;&gt;CodeNarc&lt;/a&gt; can be seen as the equivalent of FindBugs for Groovy code. And problems seemed to start with an upgrade of the Gradle CodeNarc plugin to use CodeNarc 0.23. We actually saw reports like &lt;a href=&quot;https://discuss.gradle.org/t/codenarc-performance-drop-after-versions-update/9677&quot;&gt;this one&lt;/a&gt; in the forums or &lt;a href=&quot;https://github.com/CodeNarc/CodeNarc/issues/116&quot;&gt;this other one&lt;/a&gt; in GitHub but thought that the PermGen error was just a consequence of &lt;a href=&quot;http://codenarc.sourceforge.net/&quot;&gt;CodeNarc&lt;/a&gt; including more rules: rules are written in Groovy, so compiled down to classes and classes eat PermGen. So increasing the PermGen space was enough, and it did actually solve the error. Problem solved. Or not. The riddle only started for me with a seemingly insignificant question on our internal mailing lists: &quot;Can some investigate why our build sometimes fails with a PermGen space error?&quot;, and I volunteered.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Interestingly, I had just finished pushing an upgrade of &lt;a href=&quot;https://www.gradle.org&quot;&gt;Gradle&lt;/a&gt; to Groovy 2.4.4 on our master branch, and I had noticed that I had to increase the PermGen space too. At first, I naively thought that it was also required because Groovy 2.4 consumed more memory, but I was wrong. I should have known, because before joining Gradle, I had actually worked on Groovy for Android, and a consequence of this work was that Groovy 2.4 had a reduced memory footprint: we generate less bytecode, which directly relates to a reduced PermGen space usage. So why on earth would Groovy 2.4 require more memory? And what is the relation with the CodeNarc plugin? Actually this plugin works in a Gradle version that uses Groovy 2.3.10, so why would there be a relation between the two?&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;In such a case, your best friend is a profiler. But as I will explain here, it can also lead you to wrong tracks. Be careful. The second best friend is the JVM options &lt;code&gt;-XX:+TraceClassLoading&lt;/code&gt; and &lt;code&gt;+XX:+TraceClassUnloading&lt;/code&gt;. I also used &lt;code&gt;-XX:SoftRefLRUPolicyMSPerMB=0&lt;/code&gt;, an option that I had no idea it existed before my friend David Gageot told me. Basically, it will force the garbage collector to agressively collect all soft references, which is very useful to understand, in combination with the 2 other options, from which classloader we are leaking memory.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The first wrong track was actually thinking that &lt;a href=&quot;http://codenarc.sourceforge.net/&quot;&gt;CodeNarc&lt;/a&gt; was the source of the problem. I &lt;a href=&quot;https://groups.google.com/d/topic/gradle-dev/w9F0PsCfI4Y/discussion&quot;&gt;wrote an email on the gradle-dev list&lt;/a&gt;, explaining my findings, and I had indeed found a lot of classes from &lt;a href=&quot;http://codenarc.sourceforge.net/&quot;&gt;CodeNarc&lt;/a&gt; were not unloaded. Before I go further, let&amp;#8217;s explain how the JVM is supposed to behave with regards to classes in Java 7. We all know that objects are garbage collected, but for a lot of people, classes are not. That&amp;#8217;s why we have the PermGen space (which has disappeared in Java 8 but that&amp;#8217;s another story): this segregated space of the JVM memory is used to store classes. And in Java, a class is loaded by a classloader. There is a strong reference between a class and its classloader. But what the JVM is able to do is actually simple: if there&amp;#8217;s no instance of the class which is strongly reachable &lt;strong&gt;and&lt;/strong&gt; that the classloader is neither strongly reachable, then both the class and the classloader can be unloaded. This means that PermGen can be recovered, and it is pretty useful, especially for a language like Groovy which can generate a lot of classes at runtime.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;In Gradle, and particularily in the Gradle CodeNarc plugin, &lt;a href=&quot;http://codenarc.sourceforge.net/&quot;&gt;CodeNarc&lt;/a&gt; is executed through an Ant task, which spawns its own isolated classloader, containing both the &lt;a href=&quot;http://codenarc.sourceforge.net/&quot;&gt;CodeNarc&lt;/a&gt; and Groovy classes. So when the plugin execution is finished, if we do not keep track of the classloader, classes should be garbage collected. So a good candidate for the memory leak was actually the &lt;code&gt;IsolatedAntBuilder&lt;/code&gt; that Gradle uses to execute the Ant task. And guess what? There is such a leak, because the &lt;code&gt;DefaultIsolatedAntBuilder&lt;/code&gt; performs classloader caching! That was also discovered by my colleague Sterling, who immediately spot that: while we do cache the classloaders, keeping a strong reference on them, we don&amp;#8217;t have any code to release the classloader in case of memory pressure. Conclusion, we&amp;#8217;ve found the memory leak, hurray! And it has nothing to do with &lt;a href=&quot;http://codenarc.sourceforge.net/&quot;&gt;CodeNarc&lt;/a&gt; or &lt;a href=&quot;http://groovy-lang.org&quot;&gt;Apache Groovy&lt;/a&gt;, pfiew!&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;So I immediately tried to disable the cache, which turned to be pretty trivial. Run the build again and&amp;#8230; another PermGen space error. No CodeNarc classes unloaded, no Groovy classes unloaded. Wow. So the problem wasn&amp;#8217;t solved, first &quot;oh my!&quot; moment of the week: there was &lt;strong&gt;another&lt;/strong&gt; leak.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;One test I did, then, is to totally comment out the code that, in the ant builder code, performed the definition of the CodeNarc task. Eventually, there was only that code left in the CodeNarc plugin:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;prettyprint groovy language-groovy&quot;&gt;&lt;code&gt;    @TaskAction
    void run() {
        logging.captureStandardOutput(LogLevel.INFO)
        def classpath = new DefaultClassPath(getCodenarcClasspath())
        antBuilder.withClasspath(classpath.asFiles).execute {
            // ... thou shalt not leak!
        }
    }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I executed the code again, and there was definitely a leak: after several loops, a PermGen error occurred. &lt;a href=&quot;http://codenarc.sourceforge.net/&quot;&gt;CodeNarc&lt;/a&gt; was ruled out as the source of the leak. After some hours of trials, study of memory snapshots, I eventually came out with a piece of code that reproduces the problem independently of Gradle:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;prettyprint java language-java&quot;&gt;&lt;code&gt;int i = 0;
try {
    while (true) {
        i++;
	URLClassLoader loader = new URLClassLoader(
            new URL[]{new File(GROOVY_JAR).toURI().toURL()},
            ClassLoader.getSystemClassLoader().getParent());
        Class system = loader.loadClass(&quot;groovy.lang.GroovySystem&quot;);
        system.getDeclaredMethod(&quot;getMetaClassRegistry&quot;).invoke(null);
        loader.close();
    }
} catch (OutOfMemoryError e) {
    System.err.println(&quot;Failed after &quot; + i + &quot; loadings&quot;);
}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;As you can see, the code is very simple: it creates a new isolated classloader, which only contains Groovy on classpath. Then it invokes the creation of the Groovy runtime, by asking the metaclass registry, then it closes the classloader. On my JVM, after about 40 runs, the code fails with a PermGen space error: despite the fact that no class, no object is kept out of the classloader, the Groovy runtime is not unloaded, leading to a memory leak. The key point here is that I had noticed some oddities during my hours of debugging: a class, named &lt;code&gt;ClassInfo&lt;/code&gt;, was at the center of those oddities.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;imageblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;img src=&quot;https://groups.google.com/group/gradle-dev/attach/cb238029e9b0/leak.png?part=0.1&amp;authuser=0&quot; alt=&quot;ClassInfo leak&quot;&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;In particular, although &lt;a href=&quot;https://www.yourkit.com/features/&quot;&gt;YourKit&lt;/a&gt; (the profiler I was using) was telling me that all classes, all classloaders were weakly or softly reachable (btw, it&amp;#8217;s really a pity that &lt;a href=&quot;https://www.yourkit.com/features/&quot;&gt;YourKit&lt;/a&gt; doesn&amp;#8217;t show them separately, that is, weakly referenced objects from softly referenced ones), the classes were not garbage collected. Also strangely, some classes appeared as GC roots, meaning they could be collected, but they weren&amp;#8217;t! And when I navigated through some of the duplicate classes I was seeing, &lt;code&gt;ClassInfo&lt;/code&gt; was present, as a value of a map entry of class value. Here we are, I had found the real source of the leak. Something had changed in Groovy. And the fact that &lt;a href=&quot;http://codenarc.sourceforge.net/&quot;&gt;CodeNarc&lt;/a&gt; was leaking since 0.23 was just a side effect of upgrading its dependency to Groovy 2.4! So despite Gradle was using Groovy 2.3.10, CodeNarc, by default, was using a more recent version of Groovy. That doesn&amp;#8217;t explain &lt;strong&gt;why&lt;/strong&gt; it leaks yet, but we now know who is responsible: Groovy.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_classvalue_friend_or_foe&quot;&gt;ClassValue, friend or foe?&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Since Groovy 2.4, Groovy uses a new mechanism for storing its runtime metadata in case you run on JDK 7 or later: &lt;code&gt;ClassValue&lt;/code&gt;. &lt;code&gt;ClassValue&lt;/code&gt; allows storing information on the class level. Typically, a language like Groovy would use it to store the metaclass of a class. In practice, Groovy doesn&amp;#8217;t directly store the metaclass here, but a higher level concept called &lt;code&gt;ClassInfo&lt;/code&gt;, which in turns gives access to the metaclass of a class.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Before Groovy 2.4, all that information was stored directly in the &lt;code&gt;ClassInfo&lt;/code&gt; class itself, through a private static field. &lt;code&gt;ClassInfo&lt;/code&gt; is therefore the global entry point for accessing runtime information about a class. While Groovy 2.4 still uses &lt;code&gt;ClassInfo&lt;/code&gt; as an entry point, there are 2 possible storage mechanisms, based on the underlying JDK. If &lt;code&gt;ClassValue&lt;/code&gt; is available; which is the case for any JDK 7+, then it is used, otherwise we fallback on the old mechanism. &lt;code&gt;ClassValue&lt;/code&gt; is supposed to be more efficient and more direct. Of course, in any case (old and new storage mechanism), it is memory sensitive: in case a class is not available anymore, its &lt;code&gt;ClassInfo&lt;/code&gt; is removed. What &lt;code&gt;ClassValue&lt;/code&gt; storage provides is basically the same as ThreadLocal, but at the Class level instead of the Thread level. Users are allowed to store information here, but one should be aware that as thread locals, if you start using it, you may face memory leaks if you don&amp;#8217;t use it properly.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;That&amp;#8217;s for the theory, let&amp;#8217;s see how in practice this change led to a giant memory leak in the Gradle build.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The theory is that &lt;code&gt;ClassValue&lt;/code&gt; should behave like ThreadLocal. That is, the entries stored in the internal map of the Class class, should be garbage collected when the referent is not strongly referenced anymore. This behavior is however not what the JVM does. It was confirmed to me by Charles Nutter (JRuby) a few hours later: although we all expected the JVM to collect the unreachable, it does not.&lt;/p&gt;
&lt;/div&gt;
&lt;blockquote class=&quot;twitter-tweet&quot; lang=&quot;fr&quot;&gt;&lt;p lang=&quot;en&quot; dir=&quot;ltr&quot;&gt;&lt;a href=&quot;https://twitter.com/iNikem&quot;&gt;@inikem&lt;/a&gt; &lt;a href=&quot;https://twitter.com/CedricChampeau&quot;&gt;@cedricchampeau&lt;/a&gt; I talked with &lt;a href=&quot;https://twitter.com/haupz&quot;&gt;@haupz&lt;/a&gt; at JVMLS and he agrees that ClassValue *should* work like ThreadLocal wrt dereferencing.&lt;/p&gt;&amp;mdash; Charles Nutter (@headius) &lt;a href=&quot;https://twitter.com/headius/status/636910965817143297&quot;&gt;27 Août 2015&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async src=&quot;//platform.twitter.com/widgets.js&quot; charset=&quot;utf-8&quot;&gt;&lt;/script&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Uh. Second &quot;oh my!&quot; moment of the week. I had now a candidate (Groovy) and a reason (&lt;code&gt;ClassInfo&lt;/code&gt; leaking). However, it doesn&amp;#8217;t explain by itself why the class loader is not garbage collected: if Groovy stores information on classes, it&amp;#8217;s ok, as long as the classes to which it writes some metadata are from the classloader, or any child classloader, of the Groovy runtime itself. Everything would be self-contained, meaning we would have a graph of objects that do not leak outside of the isolated classloader. However&amp;#8230; Groovy uses Strings, integers, List, &amp;#8230; all coming from the system classloader. And that is the main difference with the old metadata storage mechanism: the old one only &lt;strong&gt;referenced&lt;/strong&gt; classes from the system classloader. With &lt;code&gt;ClassValue&lt;/code&gt;, we are &lt;strong&gt;modifying&lt;/strong&gt; classes from the system classloader too! That is, the String class, for example, contains in its class value map, information from the Groovy runtime! The famous &lt;code&gt;ClassInfo&lt;/code&gt; instance is present there! There we are! We leaked a &lt;code&gt;ClassInfo&lt;/code&gt; instance into the system classloader! So what happens is that when we are done with our &quot;isolated&quot; Groovy runtime, we think it should unload because nothing references any object or class from that classloader. However, the Groovy runtime did update classes from the system classloader, and it started leaking into it! The ghost in the shell! Groovy is spoiling everywhere&amp;#8230;&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;So far so good, I had the explanation, I could write a workaround: let&amp;#8217;s iterate over all those classes that Groovy updated, remove the &lt;code&gt;ClassInfo&lt;/code&gt;, and we&amp;#8217;re done. I wrote that code, and it turned out to be a bit ugly, but&amp;#8230; it worked! Here is, for information, the cleanup code:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;prettyprint java language-java&quot;&gt;&lt;code&gt;    static void removeClassFromGlobalClassSet(Class&amp;lt;?&amp;gt; classInfoClass) throws Exception {
        Field globalClassValueField = classInfoClass.getDeclaredField(&quot;globalClassValue&quot;);
        globalClassValueField.setAccessible(true);
        Object globalClassValue = globalClassValueField.get(null);
        Method removeFromGlobalClassValue = globalClassValueField.getType().getDeclaredMethod(&quot;remove&quot;, Class.class);
        removeFromGlobalClassValue.setAccessible(true);

        Field globalClassSetField = classInfoClass.getDeclaredField(&quot;globalClassSet&quot;);
        globalClassSetField.setAccessible(true);
        Object globalClassSet = globalClassSetField.get(null);
        globalClassSetField = globalClassSet.getClass().getDeclaredField(&quot;items&quot;);
        globalClassSetField.setAccessible(true);
        Object globalClassSetItems = globalClassSetField.get(globalClassSet);

        Field clazzField = classInfoClass.getDeclaredField(&quot;klazz&quot;);
        clazzField.setAccessible(true);


        Iterator it = (Iterator) globalClassSetItems.getClass().getDeclaredMethod(&quot;iterator&quot;).invoke(globalClassSetItems);

        while (it.hasNext()) {
            Object classInfo = it.next();
            Object clazz = clazzField.get(`ClassInfo`);
            removeFromGlobalClassValue.invoke(globalClassValue, clazz);
        }

    }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;After executing that code, no &lt;code&gt;ClassInfo&lt;/code&gt; instance was leaking anymore into the system classloader, and the runtime could be shutdown properly. The garbage collector did its job, and yay! I&amp;#8217;m so happy, I&amp;#8217;ll be able to sleep soon! That was tuesday night. And that night, I thought I had found the solution.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_memory_sensitive_classloader_caching&quot;&gt;Memory sensitive classloader caching&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;So wednesday, I spent the day trying to implement the same strategy inside Gradle. More precisely, inside the &lt;code&gt;IsolatedAntBuilder&lt;/code&gt; thing I told you. I implemented the code, launched my test again and hurray! it worked! My test passed! No more PermGen space error! So all I had to do, now, was to reactivate classloader caching, otherwise, we would loose a feature that is important performance wise.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;So I reactivated the cache, and boom! That time, the Gradle build did &lt;strong&gt;not&lt;/strong&gt; fail with a PermGen error, but with very strange errors like this one:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre&gt;groovy.lang.MissingMethodException: No signature of method: java.lang.Integer.plus() is applicable for argument types: (java.lang.Integer) values: [0]
&amp;gt;  Possible solutions: plus(java.lang.String), plus(java.lang.Character), abs(), use([Ljava.lang.Object;), split(groovy.lang.Closure), minus(java.lang.Character)&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Mmmmmm&amp;#8230; 3rd &quot;oh my!&quot; moment of the week. I understood what I had just done. By clearing the &lt;code&gt;ClassInfo&lt;/code&gt; stuff from the classloader, I had effectively shutdown the Groovy runtime that was initiated in that cached classloader. So when some code was trying to reuse the runtime from that cached classloader, since I had disabled it, it was failing! And there&amp;#8217;s no option to reinitialize the Groovy runtime. It&amp;#8217;s just not doable, because everything happens in static initializers (private final fields, &amp;#8230;). So unless the JVM had an option to allow to re-execute the static initializers of a class (and who knows what oddities it would lead to), I had no luck.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;That&amp;#8217;s about when I told my mates at Gradle &quot;I think we have to choose between caching and leaking memory&quot;. But the night came, and I actually had an idea. I could implement a memory sensitive cache: by writing a smart cache structure with appropriate SoftReferences and reference queues, I would be able to execute the shutdown code only when I know that the GC is trying to reclaim memory. The idea is simple: we have a map, which key is a SoftRefence&amp;lt;String&amp;gt;, and the value is our cached classloader. The &lt;code&gt;String&lt;/code&gt; represents the classpath that we are caching for the classloader.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Now imagine that the GC is out of memory. The semantics of &lt;code&gt;SoftReference&lt;/code&gt; are clear: before throwing an OutOfMemoryError, the JVM will do its best and clear all soft references. Doing so, using a custom reference queue, we can be notified that the reference is cleared. Then, we can execute the Groovy runtime shutdown code, which will in turn make the ClassLoader collectible.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Honestly I was pretty happy with my implementation. I executed the code and it worked! Caching was working until the GC tried to reclaim memory, then I saw my shutdow code executed, memory reclaimed and green tests. Woooo!!! I had eventually knocked that memory leak down! Ha ha!&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Then I remembered that my colleague Sterling had a test which involved a loop in an integration test. To make sure I had &lt;strong&gt;really&lt;/strong&gt; fixed the leak, I asked him to tell me how he did that. The code was very simple, just involving a loop thanks to &lt;code&gt;@Unroll&lt;/code&gt; in a &lt;a href=&quot;https://docs.spockframework.org&quot;&gt;Spock specification&lt;/a&gt;. I did it and&amp;#8230; PermGen error showed up again. WAT?!&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;That was the fourth &quot;oh my!&quot; moment. And not the last one. I really then spent hours in modifying my caching code, refactored my code to add more complicated memory leak strategies, seeing that there were still thread locals, clearing them explicitly, adding a memory leak strategy for Ant itself, for the Java Beans introspector, &amp;#8230; None of my attempts worked. In the end, it always failed. But there was always one mystery: I saw that the Groovy classes were unloading. But the Ant classes were not&amp;#8230; And the rest, I should have discovered that much sooner. But when you have so many potential source leaks, that are much more evident, it&amp;#8217;s so hard to figure out.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;In particular, one thing would have made things much easier to discover. In &lt;a href=&quot;https://www.yourkit.com/features/&quot;&gt;YourKit&lt;/a&gt;, you can see that there are duplicate classes. Classes that have the same name, but come from different class loaders. However, there&amp;#8217;s nothing that will &lt;strong&gt;show&lt;/strong&gt; you those duplicates. You have to find them yourself. And in the end, when in the dump you see an instance of that class, all you can see is that it is an instance of &lt;code&gt;ClassInfo&lt;/code&gt;. Nothing, visually, tells you that the instance of &lt;code&gt;ClassInfo&lt;/code&gt; that you are seeing actually comes from a different classloader from the one you are seeing just next to it. A bit of color, for example, would help&amp;#8230;. And it would have helped me seeing that some &lt;code&gt;ClassInfo&lt;/code&gt; elements that I was seeing in the classes from Ant didn&amp;#8217;t come from the &quot;disposable&quot; Groovy runtime&amp;#8230; No. They were coming from&amp;#8230; the Gradle runtime itself!&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_where_it_all_ends&quot;&gt;Where it all ends&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Ok, That was the last &quot;oh my!&quot; moment of the week. The one that killed all my hopes. And to understand the problem, I now have to explain to you how &lt;code&gt;IsolatedAntBuilder&lt;/code&gt; works. It&amp;#8217;s a very small, yet very smart and practical piece of code. Maybe too smart.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Gradle, as a core feature, lets you execute Ant tasks thanks to code inherited from the Groovy codebase itself: AntBuilder. It&amp;#8217;s a very elegant piece of code, that lets you write things like:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;prettyprint groovy language-groovy&quot;&gt;&lt;code&gt;task check &amp;lt;&amp;lt; {
    ant.taskdef(name: &apos;pmd&apos;,
                classname: &apos;net.sourceforge.pmd.ant.PMDTask&apos;,
                classpath: configurations.pmd.asPath)
    ant.pmd(shortFilenames: &apos;true&apos;,
            failonruleviolation: &apos;true&apos;,
            rulesetfiles: file(&apos;pmd-rules.xml&apos;).toURI().toString()) {
        formatter(type: &apos;text&apos;, toConsole: &apos;true&apos;)
        fileset(dir: &apos;src&apos;)
    }
}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;While this works, there&amp;#8217;s actually a lot involved behind that. Including classloader magic. In particular, in the example above, we create a task definition in Ant, which uses a classpath defined in Gradle. &quot;ant&quot; here is a global object which is shared accross the build, but it is possible to avoid the classes from the Ant tasks to be mixed with the Gradle classpath itself by using antBuilder instead. That&amp;#8217;s what the &lt;a href=&quot;http://codenarc.sourceforge.net/&quot;&gt;CodeNarc&lt;/a&gt; plugin does:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;prettyprint groovy language-groovy&quot;&gt;&lt;code&gt;antBuilder.withClasspath(classpath.asFiles).execute {
}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;means &quot;Gradle, please, create an isolated classloader for me, that will contain the classpath only necessary for CodeNarc, and execute that Ant task with it&quot;. It seems very trivial, but there is a problem. The code that you see here is found in a Gradle script. It means that the &quot;antBuilder&quot; object that you are seeing here comes from Gradle. It is our &lt;code&gt;IsolatedAntBuilder&lt;/code&gt; instance. When we call &quot;withClasspath&quot;, a new instance of &lt;code&gt;IsolatedAntBuilder&lt;/code&gt; will be created, with an isolated classloader corresponding to the supplied classpath. Then calling execute with a closure that lets you configure the ant task using the Groovy AntBuilder syntax.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;So the &quot;Closure&quot; class that we are seeing here comes from Gradle. Then, we have a classloader which contains the Ant runtime, and a &quot;bridge&quot; class, written in Groovy, called &quot;AntBuilderDelegate&quot;, which has one responsibility: when the code of the Ant builder is going to be executed, it is likely that the version of Groovy which will be found on classpath will be &lt;strong&gt;different&lt;/strong&gt; from the one that Gradle uses. That is exactly what happens with &lt;a href=&quot;http://codenarc.sourceforge.net/&quot;&gt;CodeNarc&lt;/a&gt;: Gradle 2.6 uses Groovy 2.3.10, but the &lt;a href=&quot;http://codenarc.sourceforge.net/&quot;&gt;CodeNarc&lt;/a&gt; plugin executes with Groovy 2.4.1, so the Ant task works with a different &quot;Closure&quot; class than the one that Gradle has. We will really have two distinct &quot;Closure&quot; classes here, and &quot;AntBuilderDelegate&quot; is responsible for filling the gap: when the Ant configuration code, which will use AntBuilder from the Ant classpath, is going to be executed, it will be calling AntBuilderDelegate instead of directly the Closure code. And that code will intercept the missing methods in order to &quot;reroute&quot; them to the builder. You don&amp;#8217;t have to understand that in detail, it&amp;#8217;s not really the point here, but it is important to understand that this &quot;AntBuilderDelegate&quot; class is instantiated&amp;#8230; in Gradle, using the Gradle classloader.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Now you may see it coming. I told you I had upgraded Gradle to use Groovy 2.4.4. So what does it mean? Gradle now uses Groovy with &lt;code&gt;ClassValue&lt;/code&gt;. And what is the problem with &lt;code&gt;ClassValue&lt;/code&gt;? All classes &quot;touched&quot; by Groovy will have them &quot;polluted&quot; with necessary metadata information. So when we create an instance of &quot;AntBuilderDelegate&quot;, we&amp;#8217;re doing that using the Groovy 2.4 runtime from Gradle, which comes with its own &lt;code&gt;ClassInfo&lt;/code&gt;. And that delegate references and AntBuilder which is instantiated using the Ant classloader, with a different Groovy runtime, having its own &lt;code&gt;ClassInfo&lt;/code&gt;. So what I had found earlier was that the &lt;code&gt;ClassInfo&lt;/code&gt; from the Groovy &quot;Ant&quot; runtime was leaking into Gradle. But I hadn&amp;#8217;t realized that the opposite was also true! By bridging the runtimes, we were leaking Groovy &quot;Gradle&quot; into the isolated classloader, through &lt;code&gt;ClassValue&lt;/code&gt;!&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;So, what happened, is that the Groovy classes from the isolated classpath were garbage collected, because no &lt;code&gt;ClassInfo&lt;/code&gt; from Gradle leaked into them. However, the Ant classes were touched. And they were NOT collectible then.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;And this is were I stopped. Because if I found a way to &quot;unload&quot; &lt;code&gt;ClassInfo&lt;/code&gt; from the isolated classpath and the touched classes from the system classloader, I haven&amp;#8217;t found a way to do the same for the &lt;code&gt;ClassInfo&lt;/code&gt; instances that leak into the Ant runtime&amp;#8230; Of course I tried a &quot;brute force&quot; thing, by removing all &lt;code&gt;ClassInfo&lt;/code&gt; from those classes, but as you understood, it&amp;#8217;s a desperate attempt: it&amp;#8217;s equivalent to shutting down the runtime. And then, it totally breaks subsequent calls in the Gradle build, we&amp;#8217;ve just broken the Groovy runtime from Gradle&amp;#8230;&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;To add some confusion to the problem, I think it&amp;#8217;s now a good time to explain that I actually simplified the isolated ant builder classloader hierarchy. There are actually (at least) 3 classloaders involved:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;ulist&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;The classloader from Gradle, which loads the Gradle runtime, the &lt;code&gt;IsolatedAntBuilder&lt;/code&gt; instance and also the &lt;code&gt;AntBuilderDelegate&lt;/code&gt; instance&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;A classloader for the Ant runtime, which is isolated from Gradle, apart from logging classes necessary for Gradle to be able to capture the output. This classloader is per classpath, and is the one which is cached.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;A classloader that is &lt;strong&gt;filtering&lt;/strong&gt; some classes from the Gradle runtime classloader to make them available. This is what the bridging Ant builder uses. This classloader is shared among all isolated ant builder instances.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;So when I say that something leaks, it can leak to any of those classloaders, and any of the parent loaders&amp;#8230;&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;That&amp;#8217;s were I felt desperate. After a week fighting those memory leaks, and so many &quot;ah ah, got you!&quot; moments, I was in front of a wall. Basically, while in the first case (isolated &lt;code&gt;ClassInfo&lt;/code&gt; leaking into Gradle), I know I can totally clean all the &lt;code&gt;ClassInfo&lt;/code&gt; references because I know I can shutdown the Groovy runtime, in the second case (Gradle &lt;code&gt;ClassInfo&lt;/code&gt; leaking), I basically have no idea that a class comes from the isolated classloader or not. So it&amp;#8217;s hard to say if you should remove the &lt;code&gt;ClassInfo&lt;/code&gt; or not. I am currently experimenting a brute force &quot;try to determine if a class belongs in the class loader hierarchy&quot;, but it is weak (ah ah!) because I need to know about several potential class loader types.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_what_s_next&quot;&gt;What&amp;#8217;s next?&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;So, what can we do next? One has to remember that fixing Groovy is not the ultimate solution because Gradle uses Groovy internally, but the various tasks can very well use a different Groovy version which is beyond our control.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;olist arabic&quot;&gt;
&lt;ol class=&quot;arabic&quot;&gt;
&lt;li&gt;
&lt;p&gt;rollback Groovy in Gradle to use Groovy 2.3.10. It would avoid the Groovy classes from Gradle to leak into the Isolated classloaders, but is also unfortunate given the improvements that this version provides. Also, those who write Groovy applications for Android use Groovy 2.4+&amp;#8230;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;http://codenarc.sourceforge.net/&quot;&gt;CodeNarc&lt;/a&gt; would still use Groovy 2.4+, we could downgrade it too. However, if people rely on features of Groovy 2.4+, they just have no choice, so we would still have the problem.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Use smarter techniques like instrumentation to track the leakages of &lt;code&gt;ClassInfo&lt;/code&gt;, record them, and revert when we&amp;#8217;re done. It&amp;#8217;s doable, but it&amp;#8217;s a huge amount of work, and relying on instrumentation for Gradle would be very bad for performance.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Update Gradle to use FilteringClassLoader everywhere, including in its main process, to prevent &lt;code&gt;ClassValue&lt;/code&gt; to be found. This would work because without that class, Groovy wouldn&amp;#8217;t use &lt;code&gt;ClassValue&lt;/code&gt; to store the metadata and fall back to the old mechanism.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Wait for a fix in Groovy. Jochen is already working on that, but we know that the old mechanism isn&amp;#8217;t perfect either, and has memory leaks too. That was one of the reasons to migrate to &lt;code&gt;ClassValue&lt;/code&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Wait for a fix of the JVM. That&amp;#8217;s beyond our control.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Increase the PermGen space for builds that use the code quality plugins, which internally use AntBuilder. It&amp;#8217;s what we do today. It works, but it&amp;#8217;s just hiding the problem. And we have to explain to our users to do it too.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Some smart people come with a smart solution, that&amp;#8217;s why I wrote this too. During that week, I got help from lots of people, including Jochen &quot;Groovy&quot; Theodorou, Henri &quot;EasyMock&quot; Tremblay, David Gageot or Nikita Salnikov from Plumbr, thank you guys!&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;By the way, if you wonder, the same problem exist in JDK 8 too, it&amp;#8217;s just not visible immediately because of the metaspace that appeared to replace the PermGen space.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Now, it was fun writing this &quot;post-mortem&quot;, I hope it wasn&amp;#8217;t too obscure, it helped me a lot because I had so many &quot;got it&quot; and &quot;oh noes!&quot; moments that I felt it was very interesting to share this story with you. And if you like technical challenges, do not forget that &lt;a href=&quot;https://gradle.org/gradle-jobs/&quot;&gt;Gradle is hiring&lt;/a&gt;!&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;&lt;strong&gt;Update&lt;/strong&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;After writing this post, I made great progress, and I did manage to get rid of the leak, but I also discovered that the leak happens with the various &lt;code&gt;GroovyCompile&lt;/code&gt;
tasks&amp;#8230; Anyway you can follow my progress on &lt;a href=&quot;https://github.com/gradle/gradle/tree/cc-oom-codenarc&quot;&gt;this branch&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
	</description>
    </item>
    <item>
      <title>Improved sandboxing of Groovy scripts</title>
      <link>http://melix.github.io/blog/2015/03/sandboxing.html</link>
      <pubDate>ven., 27 mars 2015 00:00:00 +0100</pubDate>
      <guid isPermaLink="false">2015/03/sandboxing.html</guid>
      	<description>
	&lt;div id=&quot;preamble&quot;&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;One of the most current uses cases of Groovy is scripting. Groovy makes it very easy to execute code dynamically, at runtime. Depending
on the application, scripts can be found in multiple sources: file system, databases, remote services, &amp;#8230; but more importantly, the
designer of the application which executes scripts is not necessarily the one writing those scripts. Moreover, the scripts might run in a
constrained environment (limited memory, file descriptors, time, &amp;#8230;) or your you simply don&amp;#8217;t want to allow users to access the full
capabilities of the language from a script.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;openblock INFO&quot;&gt;&lt;div class=&quot;title&quot;&gt;What you will learn in this post&lt;/div&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;div class=&quot;ulist&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;why Groovy is a good fit to write internal DSLs&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;what it implies in terms of security in your applications&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;how you can customize compilation to improve the DSL&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;the meaning of &lt;code&gt;SecureASTCustomizer&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;what are type checking extensions&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;how you can rely on type checking extensions to offer proper sandboxing&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;For example, imagine that you want to offer users the ability to evaluate mathematical expressions. One option would be to implement your
own internal DSL, create a parser and eventually an interpreter for those expressions. Obviously this involves a bit of work, but if in
the end you need to improve performance, for example by generating bytecode for the expressions instead of evaluating them, or introduce
caching of those runtime generated classes, then Groovy is probably a very good option.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;There are lots of options available, described in the &lt;a href=&quot;http://docs.groovy-lang.org/latest/html/documentation/index.html#_integrating_groovy_in_a_java_application&quot;&gt;documentation&lt;/a&gt;
but the most simple example is just using the &lt;code&gt;Eval&lt;/code&gt; class:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;title&quot;&gt;Example.java&lt;/div&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;prettyprint java language-java&quot;&gt;&lt;code&gt;int sum = (Integer) Eval.me(&quot;1+1&quot;);&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The code &lt;code&gt;1+1&lt;/code&gt; is parsed, compiled to bytecode, loaded and eventually executed by Groovy at runtime. Of course in this example the code is very simple, and you will want to
add parameters, but the idea is that the code which is executed here is arbitrary. This is probably not what you want. For a calculator, you want to allow expressions like:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;prettyprint groovy language-groovy&quot;&gt;&lt;code&gt;1+1
x+y
1+(2*x)**y
cos(alpha)*r
v=1+x&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;but certainly not&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;prettyprint groovy language-groovy&quot;&gt;&lt;code&gt;println &apos;Hello&apos;
(0..100).each { println &apos;Blah&apos; }
Pong p = new Pong()
println(new File(&apos;/etc/passwd&apos;).text)
System.exit(-1)
Eval.me(&apos;System.exit(-1)&apos;) // a script within a script!&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This is where things start to become complicated, and where we start seeing actually multiple needs:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;ulist&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;restricting the grammar of the language to a subset of its capabilities&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;preventing users from executing unexpected code&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;preventing users from executing malicious code&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The calculator example is pretty simple, but for more complex DSLs, people might actually start writing problematic code without noticing, especially if the DSL is suffiently elegant to be used
by &lt;em&gt;non developers&lt;/em&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I was in this situation a few years ago, when I designed an engine that used Groovy &quot;scripts&quot; written by linguists. One of the problems was that they could unintentionally create infinite loops,
for example. Code was executing on the server, and then you had a thread eating 100% of the CPU and had no choice but restart the application server so I had to find a way to mitigate that
problem without compromising the DSL nor the tooling or the performance of the application.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Actually, lots of people have similar needs. During the past 4 years, I spoke to tons of users who had a similar question: &lt;em&gt;How can I prevent users from doing bad things in Groovy scripts?&lt;/em&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_compilation_customizers&quot;&gt;Compilation customizers&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;At that time, I had implemented my own solution, but I knew that other people also had implemented similar ones. In the end, Guillaume Laforge
suggested to me that I wrote something that would help fixing those issues and make into Groovy core. This happened in Groovy 1.8.0 with
&lt;a href=&quot;http://docs.groovy-lang.org/latest/html/documentation/index.html#compilation-customizers&quot;&gt;compilation customizers&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Compilation customizers are a set of classes that are aimed at tweaking the compilation of Groovy scripts. You can write your own customizer but Groovy ships with:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;ulist&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;an import customizer, which aims at adding imports transparently to scripts, so that users do not have to add &quot;import&quot; statements&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;an AST (Abstract Syntax Tree) transformation customizer, which allows to add AST transformations transparently to scripts&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;a secure AST customizer, which aims at restricting the grammar and syntactical constructs of the language&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The AST transformation customizer allowed me to solve the infinite loop issue, by applying the &lt;a href=&quot;http://docs.groovy-lang.org/latest/html/gapi/groovy/transform/ThreadInterrupt.html&quot;&gt;@ThreadInterrupt&lt;/a&gt;
transformation, but the &lt;a href=&quot;http://docs.groovy-lang.org/latest/html/api/org/codehaus/groovy/control/customizers/SecureASTCustomizer.html&quot;&gt;SecureASTCustomizer&lt;/a&gt; is probably the one which has
been the most misinterpreted of the whole.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I must apologize for this. Back then, I had no better name in mind. The important part of SecureASTCustomizer is &lt;strong&gt;AST&lt;/strong&gt;. It was aimed at restricting access to some features of the AST. The
&quot;secure&quot; part is actually not a good name at all, and I will illustrate why. You can even find a blog post from Kohsuke Kawagushi, of Jenkins fame, named
Groovy SecureASTCustomizer is harmful[&lt;a href=&quot;http://kohsuke.org/2012/04/27/groovy-secureastcustomizer-is-harmful/&quot;&gt;http://kohsuke.org/2012/04/27/groovy-secureastcustomizer-is-harmful/&lt;/a&gt;]. It is very true. The SecureASTCustomizer has never been designed with sandboxing
in mind. It was designed to restrict the language at compile time, not runtime. So a much better name, in retrospect, would have been &lt;em&gt;GrammarCustomizer&lt;/em&gt;. But as you&amp;#8217;re certainly aware, there
are two hard things in computer science: cache invalidation, naming things and off by one errors.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;So imagine that you think of the secure AST customizer as a way of securing your script, and that you want to use this to prevent a user from calling &lt;code&gt;System.exit&lt;/code&gt; from a script. The
documentation says that you can prevent calls on some specific receivers by defining either a blacklist or a whitelist. In terms of securing something, I would always recommand to use a
whitelist, that is to say to list explicitly what is allowed, rather than a blacklist, saying what is disallowed. The reason is that hackers always think of things you don&amp;#8217;t, so let&amp;#8217;s illustrate
this.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Here is how a naive &quot;sandbox&quot; script engine could be configured using the &lt;code&gt;SecureASTCustomizer&lt;/code&gt;. I am writing the examples of configuration in Java, even though I could write them in Groovy, just
to make the difference between the integration code and the scripts clear.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;prettyprint java language-java&quot;&gt;&lt;code&gt;public class Sandbox {
    public static void main(String[] args)  {
        CompilerConfiguration conf = new CompilerConfiguration();				&lt;i class=&quot;conum&quot; data-value=&quot;1&quot;&gt;&lt;/i&gt;&lt;b&gt;(1)&lt;/b&gt;
        SecureASTCustomizer customizer = new SecureASTCustomizer();				&lt;i class=&quot;conum&quot; data-value=&quot;2&quot;&gt;&lt;/i&gt;&lt;b&gt;(2)&lt;/b&gt;
        customizer.setReceiversBlackList(Arrays.asList(System.class.getName()));		&lt;i class=&quot;conum&quot; data-value=&quot;3&quot;&gt;&lt;/i&gt;&lt;b&gt;(3)&lt;/b&gt;
        conf.addCompilationCustomizers(customizer);						&lt;i class=&quot;conum&quot; data-value=&quot;4&quot;&gt;&lt;/i&gt;&lt;b&gt;(4)&lt;/b&gt;
        GroovyShell shell = new GroovyShell(conf);						&lt;i class=&quot;conum&quot; data-value=&quot;5&quot;&gt;&lt;/i&gt;&lt;b&gt;(5)&lt;/b&gt;
        Object v = shell.evaluate(&quot;System.exit(-1)&quot;);						&lt;i class=&quot;conum&quot; data-value=&quot;6&quot;&gt;&lt;/i&gt;&lt;b&gt;(6)&lt;/b&gt;
        System.out.println(&quot;Result = &quot; +v);							&lt;i class=&quot;conum&quot; data-value=&quot;7&quot;&gt;&lt;/i&gt;&lt;b&gt;(7)&lt;/b&gt;
    }
}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;colist arabic&quot;&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td&gt;&lt;i class=&quot;conum&quot; data-value=&quot;1&quot;&gt;&lt;/i&gt;&lt;b&gt;1&lt;/b&gt;&lt;/td&gt;
&lt;td&gt;create a compiler configuration&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;i class=&quot;conum&quot; data-value=&quot;2&quot;&gt;&lt;/i&gt;&lt;b&gt;2&lt;/b&gt;&lt;/td&gt;
&lt;td&gt;create a secure AST customizer&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;i class=&quot;conum&quot; data-value=&quot;3&quot;&gt;&lt;/i&gt;&lt;b&gt;3&lt;/b&gt;&lt;/td&gt;
&lt;td&gt;declare that the &lt;code&gt;System&lt;/code&gt; class is blacklisted as the receiver of method calls&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;i class=&quot;conum&quot; data-value=&quot;4&quot;&gt;&lt;/i&gt;&lt;b&gt;4&lt;/b&gt;&lt;/td&gt;
&lt;td&gt;add the customizer to the compiler configuration&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;i class=&quot;conum&quot; data-value=&quot;5&quot;&gt;&lt;/i&gt;&lt;b&gt;5&lt;/b&gt;&lt;/td&gt;
&lt;td&gt;associate the configuration to the script shell, that is, try to create a sandbox&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;i class=&quot;conum&quot; data-value=&quot;6&quot;&gt;&lt;/i&gt;&lt;b&gt;6&lt;/b&gt;&lt;/td&gt;
&lt;td&gt;execute a nasty script&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;i class=&quot;conum&quot; data-value=&quot;7&quot;&gt;&lt;/i&gt;&lt;b&gt;7&lt;/b&gt;&lt;/td&gt;
&lt;td&gt;print the result of the execution of the script&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;If you run this class, when the script is executed, it will throw an error:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre&gt;General error during canonicalization: Method calls not allowed on [java.lang.System]
java.lang.SecurityException: Method calls not allowed on [java.lang.System]&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This is the result of the application of the secure AST customizer, which prevents the execution of methods on the &lt;code&gt;System&lt;/code&gt; class. Success! Now we have secured our script! Oh wait&amp;#8230;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_secureastcustomizer_pwned&quot;&gt;SecureASTCustomizer pwned!&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Secure you say? So what if I do:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;prettyprint groovy language-groovy&quot;&gt;&lt;code&gt;def c = System
c.exit(-1)&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Execute again and you will see that the program exits &lt;strong&gt;without&lt;/strong&gt; error and &lt;strong&gt;without&lt;/strong&gt; printing the result. The return code of the process is -1, which indicates that the user script has been executed!
What happened? Basically, at compile time, the secure AST customizer is not able to recognize that &lt;code&gt;c.exit&lt;/code&gt; is a call on &lt;code&gt;System&lt;/code&gt;, because it works at the AST level! It analyzes a method call, and
in this case the method call is &lt;code&gt;c.exit(-1)&lt;/code&gt;, then gets the receiver and checks if the receiver is in the whitelist (or blacklist). In this case, the receiver is &lt;code&gt;c&lt;/code&gt; and this variable is &lt;strong&gt;declared
with def&lt;/strong&gt;, which is equivalent to declaring it as &lt;code&gt;Object&lt;/code&gt;, so it will think that &lt;code&gt;c&lt;/code&gt; is &lt;code&gt;Object&lt;/code&gt;, not &lt;code&gt;System&lt;/code&gt;!&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Actually there are &lt;strong&gt;many&lt;/strong&gt; ways to workaround the various configurations that you can make on the secure AST customizer. Just for fun, a few of them:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;prettyprint groovy language-groovy&quot;&gt;&lt;code&gt;((Object)System).exit(-1)
Class.forName(&apos;java.lang.System&apos;).exit(-1)
(&apos;java.lang.System&apos; as Class).exit(-1)

import static java.lang.System.exit
exit(-1)&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;and there are &lt;strong&gt;much&lt;/strong&gt; more options. The dynamic nature of Groovy just makes it impossible to resolve those cases at compile time. There are solutions though. One option is to rely on the JVM standard
security manager. However this is a system wide solution which is often considered as a hammer. But it also doesn&amp;#8217;t really work for all cases, for example you might not want to prevent creation of
files, but only reads for example&amp;#8230;&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This limitation - or should I say frustration for lots of us - led several people to create a solution based on &lt;strong&gt;runtime checks&lt;/strong&gt;. Runtime checks do not suffer the same problem, because you
will have for example the actual receiver type of a message before checking if a method call is allowed or not. In particular, those implementations are of particular interest:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;ulist&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/jimwhite/Gondor/blob/master/src/org/ifcx/gondor/SecuredScript.java&quot;&gt;SecureScript&lt;/a&gt; by Jim White&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;http://groovy-sandbox.kohsuke.org/&quot;&gt;Groovy Sandbox&lt;/a&gt; by Kohsuke Kawagushi&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/simon-temple/groovy-sandbox&quot;&gt;Groovy Sandbox&lt;/a&gt; by Simon Temple&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;However none of those implementations is totally secure or reliable. For example, the version by Kohsuke relies on hacking the internal implementation of call site caching. The problem is that it is
not compatible with the invokedynamic version of Groovy, and those internal classes are going to be removed in future versions of Groovy. The version by Simon, on the other hand, relies on AST transformations
but misses a lot of possible hacks.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;As a result, with friends of mine Corinne Krych, Fabrice Matrat and Sébastien Blanc, we decided to create a new runtime sandboxing mechanism that would not have the issues of those projects. We started
implementing this during a hackathon in Nice, and &lt;a href=&quot;http://greachconf.com/speakers/fabrice-matrat-cedric-champeau-groovy-head-in-the-cloud/&quot;&gt;we gave a talk about this last year&lt;/a&gt; at the Greach conference.
It relies on AST transformations and heavily rewrites the code in order to perform a check before each method call, property access, increment of variable, binary expression, &amp;#8230;
The &lt;a href=&quot;https://github.com/rivieragug/groovy-core/tree/secureruntime&quot;&gt;implementation&lt;/a&gt; is still incomplete, and not much work has been done because I realized there was still a problem in case
of methods or properties called on &quot;implicit this&quot;, like in builders for example:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;prettyprint groovy language-groovy&quot;&gt;&lt;code&gt;xml {
   cars {				 // cars is a method call on an implicit this: &quot;this&quot;.cars(...)
     car(make:&apos;Renault&apos;, model: &apos;Clio&apos;)
   }
}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;As of today I still didn&amp;#8217;t find a way to properly handle this because of the design of the meta-object protocol in Groovy, that here relies on the fact that a receiver throws an exception when the method
is not found before trying another receiver. In short, it means that you cannot know the type of the receiver before the method is actually called. And if it is called, it&amp;#8217;s already too late&amp;#8230;&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Until earlier this year I had still no perfect solution to this problem, in case the script being executed is using the dynamic features of the language. But now has come the time to explain how you can
significantly improve the situation if you are ready to loose some of the dynamism of the language.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_type_checking&quot;&gt;Type checking&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Let&amp;#8217;s come back to the root problem of the SecureASTCustomizer: it works on the abstract syntax tree and has no knowledge of the concrete types of the receivers of messages. But since Groovy 2, Groovy has
optional compilation, and in Groovy 2.1, we added &lt;a href=&quot;http://docs.groovy-lang.org/latest/html/documentation/#_type_checking_extensions&quot;&gt;type checking extensions&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Type checking extensions are very powerful: they allow the designer of a Groovy DSL to help the compiler infer types, but it also lets you throw compilation errors when normally it should not. Type
checking extensions are even used internally in Groovy to support the static compiler, for example to implement traits or the
&lt;a href=&quot;http://docs.groovy-lang.org/latest/html/documentation/markup-template-engine.html&quot;&gt;markup template engine&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;What if, instead of relying on the information available after parsing, we could rely on information from the type checker? Take the following code that our hacker tried to write:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;prettyprint groovy language-groovy&quot;&gt;&lt;code&gt;((Object)System).exit(-1)&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;If you activate type checking, this code would not compile:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre&gt;1 compilation error:

[Static type checking] - Cannot find matching method java.lang.Object#exit(java.lang.Integer). Please check if the declared type is right and if the method exists.&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;So this code would not compile anymore. But what if the code is:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;prettyprint groovy language-groovy&quot;&gt;&lt;code&gt;def c = System
c.exit(-1)&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;You can verify that this passes type checking by wrapping the code into a method and running the script with the &lt;code&gt;groovy&lt;/code&gt; command line tool:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;prettyprint groovy language-groovy&quot;&gt;&lt;code&gt;@groovy.transform.TypeChecked // or even @CompileStatic
void foo() {
  def c = System
  c.exit(-1)
}
foo()&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Then the type checker will recognize that the &lt;code&gt;exit&lt;/code&gt; method is called on the &lt;code&gt;System&lt;/code&gt; class and is valid. It will not help us there. But what we know, if this code passes type checking, is that the
compiler recognized the call on the &lt;code&gt;System&lt;/code&gt; receiver. The idea, then, is to rely on a type checking extension to disallow the call.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_a_simple_type_checking_extension&quot;&gt;A simple type checking extension&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Before we dig into the details about sandboxing, let&amp;#8217;s try to &quot;secure&quot; our script using a traditional type checking extension. Registering a type checking extension is easy: just set the &lt;code&gt;extensions&lt;/code&gt;
parameter of the &lt;code&gt;@TypeChecked&lt;/code&gt; annotation (or &lt;code&gt;@CompileStatic&lt;/code&gt; if you want to use static compilation):&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;prettyprint groovy language-groovy&quot;&gt;&lt;code&gt;@TypeChecked(extensions=[&apos;SecureExtension1.groovy&apos;])
void foo() {
  def c = System
  c.exit(-1)
}
foo()&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The extension will be searched on classpath in source form (there&amp;#8217;s an option to have precompiled type checking extensions but this is beyond the scope of this blog post):&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;title&quot;&gt;SecureExtension1.groovy&lt;/div&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;prettyprint groovy language-groovy&quot;&gt;&lt;code&gt;onMethodSelection { expr, methodNode -&amp;gt;					&lt;i class=&quot;conum&quot; data-value=&quot;1&quot;&gt;&lt;/i&gt;&lt;b&gt;(1)&lt;/b&gt;
   if (methodNode.declaringClass.name==&apos;java.lang.System&apos;) {		&lt;i class=&quot;conum&quot; data-value=&quot;2&quot;&gt;&lt;/i&gt;&lt;b&gt;(2)&lt;/b&gt;
      addStaticTypeError(&quot;Method call is not allowed!&quot;, expr)		&lt;i class=&quot;conum&quot; data-value=&quot;3&quot;&gt;&lt;/i&gt;&lt;b&gt;(3)&lt;/b&gt;
   }
}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;colist arabic&quot;&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td&gt;&lt;i class=&quot;conum&quot; data-value=&quot;1&quot;&gt;&lt;/i&gt;&lt;b&gt;1&lt;/b&gt;&lt;/td&gt;
&lt;td&gt;when the type checker selects the target method of a call&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;i class=&quot;conum&quot; data-value=&quot;2&quot;&gt;&lt;/i&gt;&lt;b&gt;2&lt;/b&gt;&lt;/td&gt;
&lt;td&gt;then if the selected method belongs to the &lt;code&gt;System&lt;/code&gt; class&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;i class=&quot;conum&quot; data-value=&quot;3&quot;&gt;&lt;/i&gt;&lt;b&gt;3&lt;/b&gt;&lt;/td&gt;
&lt;td&gt;make the type checker throw an error&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;That&amp;#8217;s really all needed. Now execute the code again, and you will see that there&amp;#8217;s a compile time error!&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre&gt;/home/cchampeau/tmp/securetest.groovy: 6: [Static type checking] - Method call is not allowed!
 @ line 6, column 3.
     c.exit(-1)
     ^

1 error&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;So this time, thanks to the type checker, &lt;code&gt;c&lt;/code&gt; is really recognized as an instance of class &lt;code&gt;System&lt;/code&gt; and we can really disallow the call. This is a very simple example, but it doesn&amp;#8217;t really go as
far as what we can do with the secure AST customizer in terms of configuration. The extension that we wrote has &lt;strong&gt;hardcoded&lt;/strong&gt; checks, but it would probably be nicer if we could configure it. So let&amp;#8217;s
start working with a bit more complex example.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Imagine that your application computes a score for a document and that you allow the users to customize the score. Then your DSL:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;ulist&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;will expose (at least) a variable named &lt;code&gt;score&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;will allow the user to perform mathematical operations (including calling methods like &lt;em&gt;cos&lt;/em&gt;, &lt;em&gt;abs&lt;/em&gt;, &amp;#8230;)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;should disallow all other method calls&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;An example of user script would be:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;prettyprint groovy language-groovy&quot;&gt;&lt;code&gt;abs(cos(1+score))&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Such a DSL is easy to setup. It&amp;#8217;s a variant of the one we defined earlier:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;title&quot;&gt;Sandbox.java&lt;/div&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;prettyprint java language-java&quot;&gt;&lt;code&gt;CompilerConfiguration conf = new CompilerConfiguration();
ImportCustomizer customizer = new ImportCustomizer();
customizer.addStaticStars(&quot;java.lang.Math&quot;);                        &lt;i class=&quot;conum&quot; data-value=&quot;1&quot;&gt;&lt;/i&gt;&lt;b&gt;(1)&lt;/b&gt;
conf.addCompilationCustomizers(customizer);
Binding binding = new Binding();
binding.setVariable(&quot;score&quot;, 2.0d);                                 &lt;i class=&quot;conum&quot; data-value=&quot;2&quot;&gt;&lt;/i&gt;&lt;b&gt;(2)&lt;/b&gt;
GroovyShell shell = new GroovyShell(binding,conf);
Double userScore = (Double) shell.evaluate(&quot;abs(cos(1+score))&quot;);    &lt;i class=&quot;conum&quot; data-value=&quot;3&quot;&gt;&lt;/i&gt;&lt;b&gt;(3)&lt;/b&gt;
System.out.println(&quot;userScore = &quot; + userScore);&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;colist arabic&quot;&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td&gt;&lt;i class=&quot;conum&quot; data-value=&quot;1&quot;&gt;&lt;/i&gt;&lt;b&gt;1&lt;/b&gt;&lt;/td&gt;
&lt;td&gt;add an import customizer that will add &lt;code&gt;import static java.lang.Math.*&lt;/code&gt; to all scripts&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;i class=&quot;conum&quot; data-value=&quot;2&quot;&gt;&lt;/i&gt;&lt;b&gt;2&lt;/b&gt;&lt;/td&gt;
&lt;td&gt;make the &lt;code&gt;score&lt;/code&gt; variable available to the script&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;i class=&quot;conum&quot; data-value=&quot;3&quot;&gt;&lt;/i&gt;&lt;b&gt;3&lt;/b&gt;&lt;/td&gt;
&lt;td&gt;execute the script&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div class=&quot;admonitionblock tip&quot;&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td class=&quot;icon&quot;&gt;
&lt;i class=&quot;icon-tip&quot; title=&quot;Tip&quot;&gt;&lt;/i&gt;
&lt;/td&gt;
&lt;td class=&quot;content&quot;&gt;
There are options to cache the scripts, instead of parsing and compiling them each time. Please check the documentation for more details.
&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;So far, our script works, but nothing prevents a hacker from executing malicious code. Since we want to use type checking, I would recommand to use the &lt;code&gt;@CompileStatic&lt;/code&gt; transformation
transparently:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;ulist&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;it will activate type checking on the script, and we will be able to perform additional checks thanks to the type checking extension&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;it will improve the performance of the script&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Adding &lt;code&gt;@CompileStatic&lt;/code&gt; transparently is easy. We just have to update the compiler configuration:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;prettyprint java language-java&quot;&gt;&lt;code&gt;ASTTransformationCustomizer astcz = new ASTTransformationCustomizer(CompileStatic.class);
conf.addCompilationCustomizers(astcz);&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Now if you try to execute the script again, you will face a compile time error:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre&gt;Script1.groovy: 1: [Static type checking] - The variable [score] is undeclared.
 @ line 1, column 11.
   abs(cos(1+score))
             ^

Script1.groovy: 1: [Static type checking] - Cannot find matching method int#plus(java.lang.Object). Please check if the declared type is right and if the method exists.
 @ line 1, column 9.
   abs(cos(1+score))
           ^

2 errors&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;What happened? If you read the script from a &quot;compiler&quot; point of view, it doesn&amp;#8217;t know anything about the &quot;score&quot; variable. &lt;strong&gt;You&lt;/strong&gt;, as a developer, know that it&amp;#8217;s a variable
of type &lt;code&gt;double&lt;/code&gt;, but the compiler cannot infer it. This is precisely what type checking extensions are designed for: you can provide additional information to the compiler,
so that compilation passes. In this case, we will want to indicate that the &lt;code&gt;score&lt;/code&gt; variable is of type &lt;code&gt;double&lt;/code&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;So we will slightly change the way we transparently add the &lt;code&gt;@CompileStatic&lt;/code&gt; annotation:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;prettyprint java language-java&quot;&gt;&lt;code&gt;ASTTransformationCustomizer astcz = new ASTTransformationCustomizer(
        singletonMap(&quot;extensions&quot;, singletonList(&quot;SecureExtension2.groovy&quot;)),
        CompileStatic.class);&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This will &quot;emulate&quot; code annotated with &lt;code&gt;@CompileStatic(extensions=[&apos;SecureExtension2.groovy&apos;])&lt;/code&gt;. Of course now we need to write the extension which will recognize the &lt;code&gt;score&lt;/code&gt; variable:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;title&quot;&gt;SecureExtension2.groovy&lt;/div&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;prettyprint groovy language-groovy&quot;&gt;&lt;code&gt;unresolvedVariable { var -&amp;gt;			&lt;i class=&quot;conum&quot; data-value=&quot;1&quot;&gt;&lt;/i&gt;&lt;b&gt;(1)&lt;/b&gt;
   if (var.name==&apos;score&apos;) {			&lt;i class=&quot;conum&quot; data-value=&quot;2&quot;&gt;&lt;/i&gt;&lt;b&gt;(2)&lt;/b&gt;
      return makeDynamic(var, double_TYPE)	&lt;i class=&quot;conum&quot; data-value=&quot;3&quot;&gt;&lt;/i&gt;&lt;b&gt;(3)&lt;/b&gt;
   }
}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;colist arabic&quot;&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td&gt;&lt;i class=&quot;conum&quot; data-value=&quot;1&quot;&gt;&lt;/i&gt;&lt;b&gt;1&lt;/b&gt;&lt;/td&gt;
&lt;td&gt;in case the type checker cannot resolve a variable&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;i class=&quot;conum&quot; data-value=&quot;2&quot;&gt;&lt;/i&gt;&lt;b&gt;2&lt;/b&gt;&lt;/td&gt;
&lt;td&gt;if the variable name is &lt;code&gt;score&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;i class=&quot;conum&quot; data-value=&quot;3&quot;&gt;&lt;/i&gt;&lt;b&gt;3&lt;/b&gt;&lt;/td&gt;
&lt;td&gt;then instruct the compiler to resolve the variable dynamically, and that the type of the variable is &lt;code&gt;double&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;You can find a complete description of the type checking extension DSL in &lt;a href=&quot;http://docs.groovy-lang.org/latest/html/documentation/#&quot;&gt;http://docs.groovy-lang.org/latest/html/documentation/#&lt;/a&gt;&lt;em&gt;type_checking_extensions[this section of the documentation],
but you have here an example of _mixed mode compilation&lt;/em&gt; : the compiler is not able to resolve the &lt;code&gt;score&lt;/code&gt; variable. You, as the designer of the DSL, &lt;strong&gt;know&lt;/strong&gt; that the variable is in fact
found in the binding, and is of the &lt;code&gt;double&lt;/code&gt;, so the &lt;code&gt;makeDynamic&lt;/code&gt; call is here to tell the compiler: &quot;ok, don&amp;#8217;t worry, I know what I am doing, this variable can be resolved dynamically
and it will be of type &lt;code&gt;double&lt;/code&gt;&quot;. That&amp;#8217;s it!&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_first_completed_secure_extension&quot;&gt;First completed &quot;secure&quot; extension&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Now it&amp;#8217;s time to put this altogether. We wrote a type checking extension which is capable of preventing calls on &lt;code&gt;System&lt;/code&gt; on one side, and we wrote another which is able to resolve the &lt;code&gt;score&lt;/code&gt;
variable on another. So if we combine both, we have a first, complete, securing type checking extension:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;title&quot;&gt;SecureExtension3.groovy&lt;/div&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;prettyprint groovy language-groovy&quot;&gt;&lt;code&gt;// disallow calls on System
onMethodSelection { expr, methodNode -&amp;gt;
    if (methodNode.declaringClass.name==&apos;java.lang.System&apos;) {
        addStaticTypeError(&quot;Method call is not allowed!&quot;, expr)
    }
}

// resolve the score variable
unresolvedVariable { var -&amp;gt;
    if (var.name==&apos;score&apos;) {
        return makeDynamic(var, double_TYPE)
    }
}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Don&amp;#8217;t forget to update the configuration in your Java class to use the new type checking extension:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;prettyprint java language-java&quot;&gt;&lt;code&gt;ASTTransformationCustomizer astcz = new ASTTransformationCustomizer(
        singletonMap(&quot;extensions&quot;, singletonList(&quot;SecureExtension3.groovy&quot;)),
	CompileStatic.class);&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Execute the code again and it still works. Now, try to do:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre&gt;abs(cos(1+score))
System.exit(-1)&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;And the script compilation will fail with:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre&gt;Script1.groovy: 1: [Static type checking] - Method call is not allowed!
 @ line 1, column 19.
   abs(cos(1+score));System.exit(-1)
                     ^

1 error&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Congratulations, you just wrote your first type checking extension that prevents the execution of malicious code!&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_improving_configuration_of_the_extension&quot;&gt;Improving configuration of the extension&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;So far so good, we are able to prevent calls on &lt;code&gt;System&lt;/code&gt;, but it is likely that we are going to discover new vulnerabilities, and that we will want to
prevent execution of such code. So instead of hardcoding everything in the extension, we will try to make our extension generic and configurable. This is
probably the trickiest thing to do, because there&amp;#8217;s no direct way to provide context to a type checking extension. Our idea therefore relies on the (ugly)
thread locals to pass configuration data to the type checker.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The first thing we&amp;#8217;re going to do is to make the variable list configurable. Here is the code on the Java side of things:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;title&quot;&gt;Sandbox.java&lt;/div&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;prettyprint java language-java&quot;&gt;&lt;code&gt;public class Sandbox {
    public static final String VAR_TYPES = &quot;sandboxing.variable.types&quot;;

    public static final ThreadLocal&amp;lt;Map&amp;lt;String, Object&amp;gt;&amp;gt; COMPILE_OPTIONS = new ThreadLocal&amp;lt;&amp;gt;();		&lt;i class=&quot;conum&quot; data-value=&quot;1&quot;&gt;&lt;/i&gt;&lt;b&gt;(1)&lt;/b&gt;

    public static void main(String[] args) {
        CompilerConfiguration conf = new CompilerConfiguration();
        ImportCustomizer customizer = new ImportCustomizer();
        customizer.addStaticStars(&quot;java.lang.Math&quot;);
        ASTTransformationCustomizer astcz = new ASTTransformationCustomizer(
                singletonMap(&quot;extensions&quot;, singletonList(&quot;SecureExtension4.groovy&quot;)),			&lt;i class=&quot;conum&quot; data-value=&quot;2&quot;&gt;&lt;/i&gt;&lt;b&gt;(2)&lt;/b&gt;
                CompileStatic.class);
        conf.addCompilationCustomizers(astcz);
        conf.addCompilationCustomizers(customizer);

        Binding binding = new Binding();
        binding.setVariable(&quot;score&quot;, 2.0d);
        try {
            Map&amp;lt;String,ClassNode&amp;gt; variableTypes = new HashMap&amp;lt;String, ClassNode&amp;gt;();			&lt;i class=&quot;conum&quot; data-value=&quot;3&quot;&gt;&lt;/i&gt;&lt;b&gt;(3)&lt;/b&gt;
            variableTypes.put(&quot;score&quot;, ClassHelper.double_TYPE);					&lt;i class=&quot;conum&quot; data-value=&quot;4&quot;&gt;&lt;/i&gt;&lt;b&gt;(4)&lt;/b&gt;
            Map&amp;lt;String,Object&amp;gt; options = new HashMap&amp;lt;String, Object&amp;gt;();					&lt;i class=&quot;conum&quot; data-value=&quot;5&quot;&gt;&lt;/i&gt;&lt;b&gt;(5)&lt;/b&gt;
            options.put(VAR_TYPES, variableTypes);							&lt;i class=&quot;conum&quot; data-value=&quot;6&quot;&gt;&lt;/i&gt;&lt;b&gt;(6)&lt;/b&gt;
            COMPILE_OPTIONS.set(options);								&lt;i class=&quot;conum&quot; data-value=&quot;7&quot;&gt;&lt;/i&gt;&lt;b&gt;(7)&lt;/b&gt;
            GroovyShell shell = new GroovyShell(binding, conf);
            Double userScore = (Double) shell.evaluate(&quot;abs(cos(1+score));System.exit(-1)&quot;);
            System.out.println(&quot;userScore = &quot; + userScore);
        } finally {
            COMPILE_OPTIONS.remove();									&lt;i class=&quot;conum&quot; data-value=&quot;8&quot;&gt;&lt;/i&gt;&lt;b&gt;(8)&lt;/b&gt;
        }
    }
}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;colist arabic&quot;&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td&gt;&lt;i class=&quot;conum&quot; data-value=&quot;1&quot;&gt;&lt;/i&gt;&lt;b&gt;1&lt;/b&gt;&lt;/td&gt;
&lt;td&gt;create a &lt;code&gt;ThreadLocal&lt;/code&gt; that will hold the contextual configuration of the type checking extension&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;i class=&quot;conum&quot; data-value=&quot;2&quot;&gt;&lt;/i&gt;&lt;b&gt;2&lt;/b&gt;&lt;/td&gt;
&lt;td&gt;update the extension to &lt;code&gt;SecureExtension4.groovy&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;i class=&quot;conum&quot; data-value=&quot;3&quot;&gt;&lt;/i&gt;&lt;b&gt;3&lt;/b&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;variableTypes&lt;/code&gt; is a map variable name &amp;#8594; variable type&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;i class=&quot;conum&quot; data-value=&quot;4&quot;&gt;&lt;/i&gt;&lt;b&gt;4&lt;/b&gt;&lt;/td&gt;
&lt;td&gt;so this is where we&amp;#8217;re going to add the &lt;code&gt;score&lt;/code&gt; variable declaration&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;i class=&quot;conum&quot; data-value=&quot;5&quot;&gt;&lt;/i&gt;&lt;b&gt;5&lt;/b&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;options&lt;/code&gt; is the map that will store our type checking configuration&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;i class=&quot;conum&quot; data-value=&quot;6&quot;&gt;&lt;/i&gt;&lt;b&gt;6&lt;/b&gt;&lt;/td&gt;
&lt;td&gt;we set the &quot;variable types&quot; value of this configuration map to the map of variable types&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;i class=&quot;conum&quot; data-value=&quot;7&quot;&gt;&lt;/i&gt;&lt;b&gt;7&lt;/b&gt;&lt;/td&gt;
&lt;td&gt;and assign it to the thread local&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;i class=&quot;conum&quot; data-value=&quot;8&quot;&gt;&lt;/i&gt;&lt;b&gt;8&lt;/b&gt;&lt;/td&gt;
&lt;td&gt;eventually, to avoid memory leaks, it is important to remove the configuration from the thread local&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;And now, here is how the type checking extension can use this:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;prettyprint groovy language-groovy&quot;&gt;&lt;code&gt;import static Sandbox.*

def typesOfVariables = COMPILE_OPTIONS.get()[VAR_TYPES]				&lt;i class=&quot;conum&quot; data-value=&quot;1&quot;&gt;&lt;/i&gt;&lt;b&gt;(1)&lt;/b&gt;

unresolvedVariable { var -&amp;gt;
    if (typesOfVariables[var.name]) {						&lt;i class=&quot;conum&quot; data-value=&quot;2&quot;&gt;&lt;/i&gt;&lt;b&gt;(2)&lt;/b&gt;
        return makeDynamic(var, typesOfVariables[var.name])			&lt;i class=&quot;conum&quot; data-value=&quot;3&quot;&gt;&lt;/i&gt;&lt;b&gt;(3)&lt;/b&gt;
    }
}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;colist arabic&quot;&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td&gt;&lt;i class=&quot;conum&quot; data-value=&quot;1&quot;&gt;&lt;/i&gt;&lt;b&gt;1&lt;/b&gt;&lt;/td&gt;
&lt;td&gt;Retrieve the list of variable types from the thread local&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;i class=&quot;conum&quot; data-value=&quot;2&quot;&gt;&lt;/i&gt;&lt;b&gt;2&lt;/b&gt;&lt;/td&gt;
&lt;td&gt;if an unresolved variable is found in the map of known variables&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;i class=&quot;conum&quot; data-value=&quot;3&quot;&gt;&lt;/i&gt;&lt;b&gt;3&lt;/b&gt;&lt;/td&gt;
&lt;td&gt;then declare to the type checker that the variable is of the type found in the map&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Basically, the type checking extension, because it is executed when the type checker verifies the script, can access the
configuration through the thread local. Then, instead of using hard coded names in &lt;code&gt;unresolvedVariable&lt;/code&gt;, we can just check
that the variable that the type checker doesn&amp;#8217;t know about is actually declared in the configuration. If it is, then we
can tell it which type it is. Easy!&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Now we have to find a way to explicitly declare the list of allowed method calls. It is a bit trickier to find a proper
configuration for that, but here is what we came up with.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_configuring_a_white_list_of_methods&quot;&gt;Configuring a white list of methods&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The idea of the whitelist is simple. A method call will be allowed if the method descriptor can be found in the whitelist. This whitelist consists of regular expressions, and
the method descriptor consists of the fully-qualified class name of the method, it&amp;#8217;s name and parameters. For example, for &lt;code&gt;System.exit&lt;/code&gt;, the descriptor would be:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre&gt;java.lang.System#exit(int)&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;So let&amp;#8217;s see how to update the Java integration part to add this configuration:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;prettyprint java language-java&quot;&gt;&lt;code&gt;public class Sandbox {
    public static final String WHITELIST_PATTERNS = &quot;sandboxing.whitelist.patterns&quot;;

    // ...

    public static void main(String[] args) {
        // ...
        try {
            Map&amp;lt;String,ClassNode&amp;gt; variableTypes = new HashMap&amp;lt;String, ClassNode&amp;gt;();
            variableTypes.put(&quot;score&quot;, ClassHelper.double_TYPE);
            Map&amp;lt;String,Object&amp;gt; options = new HashMap&amp;lt;String, Object&amp;gt;();
            List&amp;lt;String&amp;gt; patterns = new ArrayList&amp;lt;String&amp;gt;();					&lt;i class=&quot;conum&quot; data-value=&quot;1&quot;&gt;&lt;/i&gt;&lt;b&gt;(1)&lt;/b&gt;
            patterns.add(&quot;java\\.lang\\.Math#&quot;);						&lt;i class=&quot;conum&quot; data-value=&quot;2&quot;&gt;&lt;/i&gt;&lt;b&gt;(2)&lt;/b&gt;
            options.put(VAR_TYPES, variableTypes);
            options.put(WHITELIST_PATTERNS, patterns);						&lt;i class=&quot;conum&quot; data-value=&quot;3&quot;&gt;&lt;/i&gt;&lt;b&gt;(3)&lt;/b&gt;
            COMPILE_OPTIONS.set(options);
            GroovyShell shell = new GroovyShell(binding, conf);
            Double userScore = (Double) shell.evaluate(&quot;abs(cos(1+score));System.exit(-1)&quot;);
            System.out.println(&quot;userScore = &quot; + userScore);
        } finally {
            COMPILE_OPTIONS.remove();
        }
    }
}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;colist arabic&quot;&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td&gt;&lt;i class=&quot;conum&quot; data-value=&quot;1&quot;&gt;&lt;/i&gt;&lt;b&gt;1&lt;/b&gt;&lt;/td&gt;
&lt;td&gt;declare a list of patterns&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;i class=&quot;conum&quot; data-value=&quot;2&quot;&gt;&lt;/i&gt;&lt;b&gt;2&lt;/b&gt;&lt;/td&gt;
&lt;td&gt;add all methods of &lt;code&gt;java.lang.Math&lt;/code&gt; as allowed&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;i class=&quot;conum&quot; data-value=&quot;3&quot;&gt;&lt;/i&gt;&lt;b&gt;3&lt;/b&gt;&lt;/td&gt;
&lt;td&gt;put the whitelist to the type checking options map&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Then on the type checking extension side:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;prettyprint groovy language-groovy&quot;&gt;&lt;code&gt;import groovy.transform.CompileStatic
import org.codehaus.groovy.ast.ClassNode
import org.codehaus.groovy.ast.MethodNode
import org.codehaus.groovy.ast.Parameter
import org.codehaus.groovy.transform.stc.ExtensionMethodNode

import static Sandbox.*

@CompileStatic
private static String prettyPrint(ClassNode node) {
    node.isArray()?&quot;${prettyPrint(node.componentType)}[]&quot;:node.toString(false)
}

@CompileStatic
private static String toMethodDescriptor(MethodNode node) {								&lt;i class=&quot;conum&quot; data-value=&quot;1&quot;&gt;&lt;/i&gt;&lt;b&gt;(1)&lt;/b&gt;
    if (node instanceof ExtensionMethodNode) {
        return toMethodDescriptor(node.extensionMethodNode)
    }
    def sb = new StringBuilder()
    sb.append(node.declaringClass.toString(false))
    sb.append(&quot;#&quot;)
    sb.append(node.name)
    sb.append(&apos;(&apos;)
    sb.append(node.parameters.collect { Parameter it -&amp;gt;
        prettyPrint(it.originType)
    }.join(&apos;,&apos;))
    sb.append(&apos;)&apos;)
    sb
}
def typesOfVariables = COMPILE_OPTIONS.get()[VAR_TYPES]
def whiteList = COMPILE_OPTIONS.get()[WHITELIST_PATTERNS]								&lt;i class=&quot;conum&quot; data-value=&quot;2&quot;&gt;&lt;/i&gt;&lt;b&gt;(2)&lt;/b&gt;

onMethodSelection { expr, MethodNode methodNode -&amp;gt;
    def descr = toMethodDescriptor(methodNode)										&lt;i class=&quot;conum&quot; data-value=&quot;3&quot;&gt;&lt;/i&gt;&lt;b&gt;(3)&lt;/b&gt;
    if (!whiteList.any { descr =~ it }) {										&lt;i class=&quot;conum&quot; data-value=&quot;4&quot;&gt;&lt;/i&gt;&lt;b&gt;(4)&lt;/b&gt;
        addStaticTypeError(&quot;You tried to call a method which is not allowed, what did you expect?: $descr&quot;, expr)	&lt;i class=&quot;conum&quot; data-value=&quot;5&quot;&gt;&lt;/i&gt;&lt;b&gt;(5)&lt;/b&gt;
    }
}

unresolvedVariable { var -&amp;gt;
    if (typesOfVariables[var.name]) {
        return makeDynamic(var, typesOfVariables[var.name])
    }
}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;colist arabic&quot;&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td&gt;&lt;i class=&quot;conum&quot; data-value=&quot;1&quot;&gt;&lt;/i&gt;&lt;b&gt;1&lt;/b&gt;&lt;/td&gt;
&lt;td&gt;this method will generate a method descriptor from a &lt;code&gt;MethodNode&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;i class=&quot;conum&quot; data-value=&quot;2&quot;&gt;&lt;/i&gt;&lt;b&gt;2&lt;/b&gt;&lt;/td&gt;
&lt;td&gt;retrieve the whitelist of methods from the thread local option map&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;i class=&quot;conum&quot; data-value=&quot;3&quot;&gt;&lt;/i&gt;&lt;b&gt;3&lt;/b&gt;&lt;/td&gt;
&lt;td&gt;convert a selected method into a descriptor string&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;i class=&quot;conum&quot; data-value=&quot;4&quot;&gt;&lt;/i&gt;&lt;b&gt;4&lt;/b&gt;&lt;/td&gt;
&lt;td&gt;if the descriptor doesn&amp;#8217;t match any of the whitelist entries, throw an error&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;So if you execute the code again, you will now have a very cool error:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre&gt;Script1.groovy: 1: [Static type checking] - You tried to call a method which is not allowed, what did you expect?: java.lang.System#exit(int)
 @ line 1, column 19.
   abs(cos(1+score));System.exit(-1)
                     ^

1 error&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;There we are! We now have a type checking extension which handles both the types of the variables that you export in the binding &lt;strong&gt;and&lt;/strong&gt;
a whitelist of allowed methods. This is still not perfect, but we&amp;#8217;re very close to the final solution! It&amp;#8217;s not perfect because we only
took care of method calls here, but you have to deal with more than that. For example, properties (like &lt;code&gt;foo.text&lt;/code&gt; which is implicitly
converted into &lt;code&gt;foo.getText()&lt;/code&gt;).&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_putting_it_altogether&quot;&gt;Putting it altogether&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Dealing with properties is a bit more complicated because the type checker doesn&amp;#8217;t have a handler for &quot;property selection&quot; like it does
for methods. We can work around that, and if you are interested in seeing the resulting code, check it out below. It&amp;#8217;s
a type checking extension which is not written exactly as you have seen in this blog post, because it is meant to be precompiled
for improved performance. But the idea is exactly the same.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;title&quot;&gt;SandboxingTypeCheckingExtension.groovy&lt;/div&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;prettyprint groovy language-groovy&quot;&gt;&lt;code&gt;import groovy.transform.CompileStatic
import org.codehaus.groovy.ast.ClassCodeVisitorSupport
import org.codehaus.groovy.ast.ClassHelper
import org.codehaus.groovy.ast.ClassNode
import org.codehaus.groovy.ast.MethodNode
import org.codehaus.groovy.ast.Parameter
import org.codehaus.groovy.ast.expr.PropertyExpression
import org.codehaus.groovy.control.SourceUnit
import org.codehaus.groovy.transform.sc.StaticCompilationMetadataKeys
import org.codehaus.groovy.transform.stc.ExtensionMethodNode
import org.codehaus.groovy.transform.stc.GroovyTypeCheckingExtensionSupport
import org.codehaus.groovy.transform.stc.StaticTypeCheckingSupport

import static Sandbox.*

class SandboxingTypeCheckingExtension extends GroovyTypeCheckingExtensionSupport.TypeCheckingDSL {

    @CompileStatic
    private static String prettyPrint(ClassNode node) {
        node.isArray()?&quot;${prettyPrint(node.componentType)}[]&quot;:node.toString(false)
    }

    @CompileStatic
    private static String toMethodDescriptor(MethodNode node) {
        if (node instanceof ExtensionMethodNode) {
            return toMethodDescriptor(node.extensionMethodNode)
        }
        def sb = new StringBuilder()
        sb.append(node.declaringClass.toString(false))
        sb.append(&quot;#&quot;)
        sb.append(node.name)
        sb.append(&apos;(&apos;)
        sb.append(node.parameters.collect { Parameter it -&amp;gt;
            prettyPrint(it.originType)
        }.join(&apos;,&apos;))
        sb.append(&apos;)&apos;)
        sb
    }

    @Override
    Object run() {

        // Fetch white list of regular expressions of authorized method calls
        def whiteList = COMPILE_OPTIONS.get()[WHITELIST_PATTERNS]
        def typesOfVariables = COMPILE_OPTIONS.get()[VAR_TYPES]

        onMethodSelection { expr, MethodNode methodNode -&amp;gt;
            def descr = toMethodDescriptor(methodNode)
            if (!whiteList.any { descr =~ it }) {
                addStaticTypeError(&quot;You tried to call a method which is not allowed, what did you expect?: $descr&quot;, expr)
            }
        }

        unresolvedVariable { var -&amp;gt;
            if (isDynamic(var) &amp;amp;&amp;amp; typesOfVariables[var.name]) {
                storeType(var, typesOfVariables[var.name])
                handled = true
            }
        }

        // handling properties (like foo.text) is harder because the type checking extension
        // does not provide a specific hook for this. Harder, but not impossible!

        afterVisitMethod { methodNode -&amp;gt;
            def visitor = new PropertyExpressionChecker(context.source, whiteList)
            visitor.visitMethod(methodNode)
        }
    }

    private class PropertyExpressionChecker extends ClassCodeVisitorSupport {
        private final SourceUnit unit
        private final List&amp;lt;String&amp;gt; whiteList

        PropertyExpressionChecker(final SourceUnit unit, final List&amp;lt;String&amp;gt; whiteList) {
            this.unit = unit
            this.whiteList = whiteList
        }

        @Override
        protected SourceUnit getSourceUnit() {
            unit
        }

        @Override
        void visitPropertyExpression(final PropertyExpression expression) {
            super.visitPropertyExpression(expression)

            ClassNode owner = expression.objectExpression.getNodeMetaData(StaticCompilationMetadataKeys.PROPERTY_OWNER)
            if (owner) {
                if (expression.spreadSafe &amp;amp;&amp;amp; StaticTypeCheckingSupport.implementsInterfaceOrIsSubclassOf(owner, classNodeFor(Collection))) {
                    owner = typeCheckingVisitor.inferComponentType(owner, ClassHelper.int_TYPE)
                }
                def descr = &quot;${prettyPrint(owner)}#${expression.propertyAsString}&quot;
                if (!whiteList.any { descr =~ it }) {
                    addStaticTypeError(&quot;Property is not allowed: $descr&quot;, expression)
                }
            }
        }
    }
}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;And a final version of the sandbox that includes assertions to make sure that we catch all cases:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;title&quot;&gt;Sandbox.java&lt;/div&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;prettyprint java language-java&quot;&gt;&lt;code&gt;public class Sandbox {
    public static final String WHITELIST_PATTERNS = &quot;sandboxing.whitelist.patterns&quot;;
    public static final String VAR_TYPES = &quot;sandboxing.variable.types&quot;;

    public static final ThreadLocal&amp;lt;Map&amp;lt;String, Object&amp;gt;&amp;gt; COMPILE_OPTIONS = new ThreadLocal&amp;lt;Map&amp;lt;String, Object&amp;gt;&amp;gt;();

    public static void main(String[] args) {
        CompilerConfiguration conf = new CompilerConfiguration();
        ImportCustomizer customizer = new ImportCustomizer();
        customizer.addStaticStars(&quot;java.lang.Math&quot;);
        ASTTransformationCustomizer astcz = new ASTTransformationCustomizer(
                singletonMap(&quot;extensions&quot;, singletonList(&quot;SandboxingTypeCheckingExtension.groovy&quot;)),
                CompileStatic.class);
        conf.addCompilationCustomizers(astcz);
        conf.addCompilationCustomizers(customizer);

        Binding binding = new Binding();
        binding.setVariable(&quot;score&quot;, 2.0d);
        try {
            Map&amp;lt;String, ClassNode&amp;gt; variableTypes = new HashMap&amp;lt;String, ClassNode&amp;gt;();
            variableTypes.put(&quot;score&quot;, ClassHelper.double_TYPE);
            Map&amp;lt;String, Object&amp;gt; options = new HashMap&amp;lt;String, Object&amp;gt;();
            List&amp;lt;String&amp;gt; patterns = new ArrayList&amp;lt;String&amp;gt;();
            // allow method calls on Math
            patterns.add(&quot;java\\.lang\\.Math#&quot;);
            // allow constructors calls on File
            patterns.add(&quot;File#&amp;lt;init&amp;gt;&quot;);
            // because we let the user call each/times/...
            patterns.add(&quot;org\\.codehaus\\.groovy\\.runtime\\.DefaultGroovyMethods&quot;);
            options.put(VAR_TYPES, variableTypes);
            options.put(WHITELIST_PATTERNS, patterns);
            COMPILE_OPTIONS.set(options);
            GroovyShell shell = new GroovyShell(binding, conf);
            Object result;
            try {
                result = shell.evaluate(&quot;Eval.me(&apos;1&apos;)&quot;); // error
                assert false;
            } catch (MultipleCompilationErrorsException e) {
                System.out.println(&quot;Successful sandboxing: &quot;+e.getMessage());
            }
            try {
                result = shell.evaluate(&quot;System.exit(-1)&quot;); // error
                assert false;
            } catch (MultipleCompilationErrorsException e) {
                System.out.println(&quot;Successful sandboxing: &quot;+e.getMessage());
            }
            try {
                result = shell.evaluate(&quot;((Object)Eval).me(&apos;1&apos;)&quot;); // error
                assert false;
            } catch (MultipleCompilationErrorsException e) {
                System.out.println(&quot;Successful sandboxing: &quot;+e.getMessage());
            }

            try {
                result = shell.evaluate(&quot;new File(&apos;/etc/passwd&apos;).getText()&quot;); // getText is not allowed
                assert false;
            } catch (MultipleCompilationErrorsException e) {
                System.out.println(&quot;Successful sandboxing: &quot;+e.getMessage());
            }

            try {
                result = shell.evaluate(&quot;new File(&apos;/etc/passwd&apos;).text&quot;);  // getText is not allowed
                assert false;
            } catch (MultipleCompilationErrorsException e) {
                System.out.println(&quot;Successful sandboxing: &quot;+e.getMessage());
            }

            Double userScore = (Double) shell.evaluate(&quot;abs(cos(1+score))&quot;);
            System.out.println(&quot;userScore = &quot; + userScore);
        } finally {
            COMPILE_OPTIONS.remove();
        }
    }
}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_conclusion&quot;&gt;Conclusion&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This post has explored the interest of using Groovy as a platform for scripting on the JVM. It introduced various mechanisms for integration, and showed that this
comes at the price of security. However, we illustrated some concepts like compilation customizers that make it easier to sandbox the environment of execution of
scripts. The current list of customizers available in the Groovy distribution, and the currently available sandboxing projects in the wild, are not sufficient
to guarantee security of execution of scripts in the general case (dependending, of course, on your users and where the scripts come from).&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;We then illustrated how you could, if you are ready to pay the price of loosing some of the dynamic features of the language, properly workaround those limitations
through type checking extensions. Those type checking extensions are so powerful that you can even introduce your own error messages during the compilation of
scripts. Eventually, by doing this and caching your scripts, you will also benefit from dramatic performance improvements in script execution.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Eventually, the sandboxing mechanism that we illustrated is &lt;strong&gt;not&lt;/strong&gt; a replacement for the &lt;code&gt;SecureASTCustomizer&lt;/code&gt;. We recommand that you actually use &lt;strong&gt;both&lt;/strong&gt;, because they
work on different levels: the secure AST customizer will work on the grammar level, allowing you to restrict some language constructs (for example preventing the
creation of closures or classes inside the script), while the type checking extension will work after type inference (allowing you to reason on inferred types
rather than declared types).&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Last but not least, the solution that I described here is incomplete. It is not available in Groovy core. As I will have less time to work on Groovy, I would be very
glad if someone or some people improve this solution and make a pull request so that we can have something!&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
	</description>
    </item>
    <item>
      <title>Who is Groovy?</title>
      <link>http://melix.github.io/blog/2015/02/who-is-groovy.html</link>
      <pubDate>mer., 4 mars 2015 00:00:00 +0100</pubDate>
      <guid isPermaLink="false">2015/02/who-is-groovy.html</guid>
      	<description>
	&lt;div id=&quot;preamble&quot;&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;With all the changes that the Groovy project is seeing since the beginning of the year, I thought it was a good time to
make a summary about its history. In particular, with the &lt;a href=&quot;http://blog.pivotal.io/pivotal/news-2/groovy-2-4-and-grails-3-0-to-be-last-major-releases-under-pivotal-sponsorship&quot;&gt;end of sponsorship from Pivotal&lt;/a&gt;, as well as
&lt;a href=&quot;http://restlet.com/blog/2015/03/02/head-of-groovy-project-joins-restlet-to-lead-api-development-tools/&quot;&gt;Guillaume Laforge annoucing he is joining Restlet&lt;/a&gt;, a lot of people state that Groovy is done. It will be the occasion to talk about
the history of the project, both in terms of community and sponsorship.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;First of all, Groovy is, and will remain, alive. Groovy is a community project and we are pleased to announce that &lt;strong&gt;&lt;a href=&quot;http://glaforge.appspot.com/article/groovy-projects-intends-to-join-the-apache-software-foundation&quot;&gt;Groovy
has started the process to join the Apache Software Foundation&lt;/a&gt;&lt;/strong&gt;. The community deserved it, and even if it will mean some adaptations on
our side, we think that the &lt;a href=&quot;http://apache.org&quot;&gt;ASF&lt;/a&gt; will be a great fit for the project.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;To build the statistics you will read in this post, I have used a &lt;a href=&quot;https://github.com/melix/blog/blob/master/src/jbake/content/2015/02/commit-stats.groovy&quot;&gt;Groovy script&lt;/a&gt; (of course!) that
takes as reference the number of commits. This is far from being a perfect number, because some commits are just
for fixing typos, while others are full new features and it also totally misses the fact that patches, before Git, didn&amp;#8217;t carry the author
information or the problem that we maintain multiple branches
of Groovy, requiring a lot of work, but it gives an idea&amp;#8230; And because people think that end of sponsorship
may be equivalent to death, I separated commits in two categories: sponsored and community. Sponsored commits are commits
which are likely to have been made by someone directly paid to contribute on Groovy. We will see how this proportion evolved
over time.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;If you think Groovy is dead, please read the following carefully. Let&amp;#8217;s start our journey back in time!&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_2003_a_dynamic_language_for_the_jvm&quot;&gt;2003: A dynamic language for the JVM&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;&lt;strong&gt;Total&lt;/strong&gt;: 476 commits &lt;strong&gt;Community&lt;/strong&gt;: 476 commits (100%)&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;olist arabic&quot;&gt;
&lt;ol class=&quot;arabic&quot;&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;span class=&quot;red&quot;&gt;James Strachan : 374 commits (78%)&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Bob McWhirter : 76 commits (15%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Sam Pullara : 23 commits (4%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Kasper Nielsen : 2 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Aslak Hellesoy : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;2003 is the inception year of Groovy. &lt;strong&gt;James Strachan&lt;/strong&gt;, in August 2003, wanted to create a dynamic language for the JVM, inspired by Ruby,
but closer to Java. Groovy was born, and the idea never changed over time: Groovy is the perfect companion for Java, a language which can
be very close to Java in terms of syntax but also removes a lot of its boilerplate. Bob McWhirter is a famous name in the JVM world, he is
now Director of Polyglot at Red Hat, so you can see that when he started contributing to the language back then, there was already a story
for him! Sam Pullara is another very smart guy in the JVM world and he worked for top companies like BEA, Yahoo! or Twitter to name a few.
He is a technical reviewer for the JavaOne conference.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_2004_guillaume_laforge_joins_the_project&quot;&gt;2004: Guillaume Laforge joins the project&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;&lt;strong&gt;Total&lt;/strong&gt;: 871 commits &lt;strong&gt;Community&lt;/strong&gt;: 871 commits (100%)&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;olist arabic&quot;&gt;
&lt;ol class=&quot;arabic&quot;&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;span class=&quot;red&quot;&gt;James Strachan : 495 commits (56%)&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Guillaume Laforge : 101 commits (11%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;John Wilson : 70 commits (8%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Sam Pullara : 66 commits (7%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Jeremy Rayner : 33 commits (3%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Chris Poirier : 28 commits (3%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Bing Ran : 21 commits (2%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Steve Goetze : 12 commits (1%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;John Stump : 10 commits (1%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Russel Winder : 8 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Zohar Melamed : 8 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Jochen Theodorou : 7 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Damage Control : 4 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Bob McWhirter : 3 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Christiaan ten Klooster : 3 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Yuri Schimke : 2 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Groovy is hosted at &lt;a href=&quot;http://www.codehaus.org/&quot;&gt;Codehaus&lt;/a&gt; (which just has annouced its retirement) and 2004 sees the appearance of famous names of the community. In particular,
you can already see &lt;strong&gt;Guillaume Laforge&lt;/strong&gt; and &lt;strong&gt;Jochen Theodorou&lt;/strong&gt;. Both of them still directly work on the project as today. John Wilson started contributing
the famous XML support of Groovy, and you can also note names like Russel Winder of Gant and &lt;a href=&quot;http://gpars.codehaus.org/&quot;&gt;GPars&lt;/a&gt; fame. Jeremy Rayer&amp;#8217;s work is famous in the Groovy
community since he wrote the first versions of the Groovy grammar using Antlr.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_2005_jochen_theodorou_joins_the_project&quot;&gt;2005: Jochen Theodorou joins the project&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;&lt;strong&gt;Total&lt;/strong&gt;: 934 commits &lt;strong&gt;Community&lt;/strong&gt;: 934 commits (100%)&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;olist arabic&quot;&gt;
&lt;ol class=&quot;arabic&quot;&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;span class=&quot;red&quot;&gt;Jochen Theodorou : 244 commits (26%)&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;James Strachan : 162 commits (17%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Pilho Kim : 104 commits (11%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;John Wilson : 79 commits (8%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Guillaume Laforge : 75 commits (8%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Dierk Koenig : 70 commits (7%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Jeremy Rayner : 62 commits (6%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Christian Stein : 48 commits (5%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Alan Green : 20 commits (2%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Russel Winder : 20 commits (2%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Martin C. Martin : 14 commits (1%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Sam Pullara : 10 commits (1%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;John Rose : 8 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Hein Meling : 7 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Scott Stirling : 6 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Franck Rasolo : 5 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I would tend to think that 2005 is the year when Jochen Theodorou took the technical lead of Groovy. In 2005, he becomes the most prolific contributor,
even beyond the creator of the language himself. Dierk Koenig makes an appearance here: he is known for his work on &lt;a href=&quot;http://gpars.codehaus.org/&quot;&gt;GPars&lt;/a&gt;, but also for the reference book for Groovy: &lt;a href=&quot;http://www.manning.com/koenig2/&quot;&gt;Groovy in Action&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_2006_rise_of_paul_king&quot;&gt;2006: Rise of Paul King&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;&lt;strong&gt;Total&lt;/strong&gt;: 480 commits &lt;strong&gt;Community&lt;/strong&gt;: 480 commits (100%)&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;olist arabic&quot;&gt;
&lt;ol class=&quot;arabic&quot;&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;span class=&quot;red&quot;&gt;Jochen Theodorou : 221 commits (46%)&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;John Wilson : 56 commits (11%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Paul King : 54 commits (11%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Guillaume Laforge : 47 commits (9%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Dierk Koenig : 37 commits (7%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Jeremy Rayner : 23 commits (4%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Russel Winder : 14 commits (2%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Guillaume Alleon : 12 commits (2%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Joachim Baumann : 6 commits (1%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Martin C. Martin : 4 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Graeme Rocher : 2 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Marc Guillemot : 2 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Christian Stein : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Steve Goetze : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;2006 is a very calm year for Groovy in terms of code production. James, the creator of the language, already disappeared from the contributors, and will not contribute anymore. &lt;strong&gt;Guillaume Laforge&lt;/strong&gt;, in agreement with the other contributors, &lt;strong&gt;takes the project lead&lt;/strong&gt; (he is still the lead today).&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;With half as many commits as in 2007, in retrospect, I would say that this was a critical year: either the project would die, or it would have become what it is today. And my personal feeling is that the person who saved Groovy just appeared in the contributors list: Paul King. &lt;strong&gt;Paul is undoubtfully the most active contributor to Groovy&lt;/strong&gt;. He wrote a lot of the Groovy Development Kit, that is to say the APIs without which a language would be nothing. Having a nice language is one thing, having proper APIs and libraries that unleash its full potential is another. Paul King did it. Look at his ranking here: 3rd place. You will never see him ranked lower than that. And guess what? Paul is &lt;strong&gt;not&lt;/strong&gt; paid to do this. He &lt;a href=&quot;http://www.asert.com.au/&quot;&gt;runs his own business&lt;/a&gt; and if you want to work with a Groovy expert, he&amp;#8217;s probably the best.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Joachim Baumann is a name some people would recognize: he is still working with Groovy and one of the most regular contributors, with the Windows installer. Joachim takes time, for each Groovy release, to produce a Windows installer, which today we are still not capable of handling automatically.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_2007_groovy_1_0&quot;&gt;2007: Groovy 1.0&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;olist arabic&quot;&gt;
&lt;ol class=&quot;arabic&quot;&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;span class=&quot;red&quot;&gt;Paul King : 447 commits (30%)&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Jason Dillon : 265 commits (18%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Jochen Theodorou (Sponsored) : 242 commits (16%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Danno Ferrin : 101 commits (6%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Alex Tkachman (Sponsored) : 87 commits (5%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Graeme Rocher (Sponsored) : 61 commits (4%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Russel Winder : 46 commits (3%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Marc Guillemot : 36 commits (2%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Andres Almiray : 34 commits (2%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Guillaume Laforge (Sponsored) : 33 commits (2%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Jeremy Rayner : 26 commits (1%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Alexandru Popescu : 24 commits (1%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;John Wilson : 22 commits (1%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Joachim Baumann : 21 commits (1%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Jeff Brown : 8 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Dierk Koenig : 6 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Martin C. Martin : 6 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Guillaume Alleon : 4 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;2007 is an important year in the history of Groovy. On January, 2d, Groovy 1.0 is out. &lt;strong&gt;Paul King ranks #1 for the first time, and will
remain on top for a long time&lt;/strong&gt;. This year also sees the creation of G2One, the first company build specifically for Groovy and Grails, by Guillaume
Laforge, Graeme Rocher and Alex Tkachman. Both Graeme and Alex make their first appearance in the contributors graph, and both of them made
significant contributions to the Groovy ecosystem: Graeme is famous for co-creating the Grails framework, and is still the lead of the project,
while Alex is the one who contributed major performance improvements to the Groovy runtime (call site caching) and first experimented with
a static compiler for Groovy (Groovy++).&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Danno Ferrin contributed what is still one of my personal favorite features of Groovy, AST transformations, and probably one of the reasons
I got paid to work on Groovy so thank you Danno! Andrés Almiray,
listed here for the first time, is famous for the &lt;a href=&quot;http://griffon.codehaus.org/&quot;&gt;Griffon&lt;/a&gt; framework, a Grails-like framework for desktop applications which is still
actively developed. He spent a lot of time improving the Swing support in Groovy.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Starting from 2007, you will see that the &lt;em&gt;sponsored&lt;/em&gt; ratio of commits is changing. People who were employed by G2One fall into that category. As you
can see, 2007 is more than important for Groovy, it is its second birth. And to conclude that, Groovy won the first prize at JAX 2007 innovation award.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_2008_the_g2one_era&quot;&gt;2008: The G2One era&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;&lt;strong&gt;Total&lt;/strong&gt;: 1069 commits &lt;strong&gt;Sponsored&lt;/strong&gt;: 287 commits (26%) &lt;strong&gt;Community&lt;/strong&gt;: 782 commits (73%)&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;olist arabic&quot;&gt;
&lt;ol class=&quot;arabic&quot;&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;span class=&quot;red&quot;&gt;Paul King : 445 commits (41%)&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Danno Ferrin : 176 commits (16%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Jochen Theodorou (Sponsored) : 126 commits (11%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Alex Tkachman (Sponsored) : 125 commits (11%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Guillaume Laforge (Sponsored) : 33 commits (3%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Jim White : 32 commits (2%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Russel Winder : 31 commits (2%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Martin Kempf : 22 commits (2%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Roshan Dawrani : 19 commits (1%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Jeremy Rayner : 14 commits (1%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Martin C. Martin : 12 commits (1%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Jason Dillon : 9 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Andres Almiray : 8 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Thom Nichols : 5 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Graeme Rocher (Sponsored) : 3 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Jeff Brown : 3 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;John Wilson : 3 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;James Williams : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Marc Guillemot : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Vladimir Vivien : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;In 2008, &lt;strong&gt;Paul King still ranks #1&lt;/strong&gt; and you can see that the people who were sponsored by G2One were actually not the main contributors. Actually, most
of them did consulting to pay salaries, which doesn&amp;#8217;t leave much time to contribute to the language. Hopefully, a great project such as Groovy can rely
on its community! Guillaume, Graeme and Alex were looking for an opportunity to spend more time on actual development, and it happened in November 2008
when G2One got acquired by SpringSource.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Some of the contributors you see in this list are still actively using Groovy or contributing: Jim White for example is famous for his contributions on the scripting sides of the language. Roshan Dawrani is one of the few guys capable of opening cryptic code and fixing bugs. Jeff Brown is a name you should know, since he is now a key member of the Grails team.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_2009_milestones_and_the_inappropriate_quote&quot;&gt;2009: milestones and the inappropriate quote&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;&lt;strong&gt;Total&lt;/strong&gt;: 835 commits &lt;strong&gt;Sponsored&lt;/strong&gt;: 183 commits (21%) &lt;strong&gt;Community&lt;/strong&gt;: 652 commits (78%)&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;olist arabic&quot;&gt;
&lt;ol class=&quot;arabic&quot;&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;span class=&quot;red&quot;&gt;Paul King : 342 commits (40%)&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Roshan Dawrani : 128 commits (15%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Jochen Theodorou (Sponsored) : 101 commits (12%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Alex Tkachman (Sponsored) : 41 commits (4%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Guillaume Laforge (Sponsored) : 40 commits (4%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Jason Dillon : 31 commits (3%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Jim White : 31 commits (3%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Danno Ferrin : 24 commits (2%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Peter Niederwieser : 23 commits (2%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Hamlet D&amp;#8217;Arcy : 18 commits (2%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Russel Winder : 14 commits (1%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Martin C. Martin : 13 commits (1%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Thom Nichols : 13 commits (1%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Andres Almiray : 12 commits (1%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Vladimir Vivien : 3 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Graeme Rocher (Sponsored) : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;2009 is another important year concluding with the release of Groovy 1.7, the first version of Groovy supporting inner classes
or the famous power asserts from Peter Niederwieser. If you know Groovy, you must know Peter, the father of the famous Spock testing
framework which &lt;a href=&quot;http://groovy.329449.n5.nabble.com/Ann-Spock-1-0-has-been-released-td5722915.html&quot;&gt;just reached 1.0&lt;/a&gt;!&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;&lt;strong&gt;Hamlet D&amp;#8217;Arcy contributed a lot in terms of code quality&lt;/strong&gt;, but also became the first specialist of AST transformations. 2009 is also the year I started to use Groovy, as a user. I never stopped and actually I started contributing back
then. At that time, Groovy was still using Subversion (we&amp;#8217;re now using Git like all the cool kids), so it was the good old patch way,
loosing authorship.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This year is also the year when James Strachan wrote a very famous quote about Groovy. This quote is probably the most innapropriately
used quote about Groovy of all time, because it was done by its creator, but remember that James left the project in 2005!&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;quoteblock&quot;&gt;
&lt;blockquote&gt;
I can honestly say if someone had shown me the Programming in Scala book by Martin Odersky, Lex Spoon &amp;amp; Bill Venners back in 2003 I&amp;#8217;d probably have never created Groovy.
&lt;/blockquote&gt;
&lt;div class=&quot;attribution&quot;&gt;
&lt;cite&gt;on his blog&lt;/cite&gt;&lt;br&gt;
&amp;#8212; James Strachan
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;First of all James says nothing about the language itself here. He had already left the project and says that &lt;strong&gt;if&lt;/strong&gt; he had known about Scala before, he &lt;strong&gt;wouldn&amp;#8217;t&lt;/strong&gt; have created Groovy. I am today very happy that he didn&amp;#8217;t know about it, or we would have missed an incredibly powerful language. Groovy today
is &lt;strong&gt;nothing close&lt;/strong&gt; to what it was when James left the project, thanks to the lead of Guillaume Laforge and incredibly talented people like Paul King, Jochen Theodorou and all the contributors listed on this page. Groovy and Scala both have their communities, but also different use cases. I wouldn&amp;#8217;t sell one for the other&amp;#8230;&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;In the end of 2009, another important milestone occurred for project, with VMware acquiring SpringSource.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_2010_dsls_all_the_way&quot;&gt;2010: DSLs all the way&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;&lt;strong&gt;Total&lt;/strong&gt;: 894 commits &lt;strong&gt;Sponsored&lt;/strong&gt;: 189 commits (21%) &lt;strong&gt;Community&lt;/strong&gt;: 705 commits (78%)&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;olist arabic&quot;&gt;
&lt;ol class=&quot;arabic&quot;&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;span class=&quot;red&quot;&gt;Paul King : 443 commits (49%)&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Roshan Dawrani : 134 commits (14%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Jochen Theodorou (Sponsored) : 96 commits (10%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Guillaume Laforge (Sponsored) : 93 commits (10%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Hamlet D&amp;#8217;Arcy : 71 commits (7%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Alex Tkachman : 28 commits (3%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Peter Niederwieser : 19 commits (2%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Andres Almiray : 7 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Jason Dillon : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Russel Winder : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Thom Nichols : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;2010 is a pretty stable year for Groovy. Groovy reaches 1.8 in 2010 with important features for its incredible DSL design capabilities. With command chain expressions, native JSON support and performance improvements, Groovy put the bar very high in terms of integration in the Java ecosystem. Today, &lt;strong&gt;no other JVM language is as simple as Groovy to integrate with Java&lt;/strong&gt;. With cross-compilation and by the use of the very same class model, Groovy is at that date the best language for scripting on the JVM. It is so good that a lot of people start to see it as a better Java and want to use it as a first class language. However, being dynamic, Groovy is still a problem for a category of users&amp;#8230;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_2011_time_to_move_to_github&quot;&gt;2011: Time to move to GitHub&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;&lt;strong&gt;Total&lt;/strong&gt;: 841 commits &lt;strong&gt;Sponsored&lt;/strong&gt;: 514 commits (61%) &lt;strong&gt;Community&lt;/strong&gt;: 327 commits (38%)&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;olist arabic&quot;&gt;
&lt;ol class=&quot;arabic&quot;&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;span class=&quot;red&quot;&gt;Cédric Champeau (Sponsored) : 252 commits (29%)&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Paul King : 212 commits (25%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Jochen Theodorou (Sponsored) : 163 commits (19%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Guillaume Laforge (Sponsored) : 98 commits (11%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Jochen : 44 commits (5%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Hamlet D&amp;#8217;Arcy : 33 commits (3%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Roshan Dawrani : 26 commits (3%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Andres Almiray : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Andrew Eisenberg : 3 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Alex Tkachman : 2 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Bobby Warner : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Colin Harrington : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Dierk Koenig : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Dirk Weber : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;John Wagenleitner : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Lari Hotari (Sponsored) : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Peter Niederwieser : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;In 2011, I became a committer to the Groovy project. As I said, I had contributed several fixes or features for Groovy 1.8, but for the first time, I became a committer and I started to be able to push changes to the codebase without having to ask permission. So this is basically the first time you see my name on the contributors list, but you can see that I am ranking #1 and I have never lost that ranking since then. It surprised me too, but there is a very good reason for that. In october 2011, in addition to being a committer, I also became paid to work on Groovy. Full-time. &lt;strong&gt;I entered the club of lucky people being paid to work on open-source software&lt;/strong&gt;. It was sincerely a dream, and I will never be enough thankful to Guillaume Laforge for giving me this opportunity. He changed my life and I &lt;em&gt;think&lt;/em&gt; I became a better developer thanks to him. VMware was my employer back then, and while I had never worked on a language before, Guillaume trusted my skills and proposed to me to work on something that would dramatically change the language : a static type checker.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I also worked on the infrastructure of the language, starting from the migration to GitHub. It was an important move to make: as you can see, there was a very limited set of committers to Groovy. With &lt;a href=&quot;https://github.com/groovy/groovy-core/&quot;&gt;GitHub&lt;/a&gt;, we had the tool we needed to increase the size of our community and from the numbers that will follow, I think it&amp;#8217;s a success.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_2012_groovy_2_and_static_compilation&quot;&gt;2012: Groovy 2 and static compilation&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;olist arabic&quot;&gt;
&lt;ol class=&quot;arabic&quot;&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;span class=&quot;red&quot;&gt;Cédric Champeau (Sponsored) : 515 commits (46%)&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Paul King : 249 commits (22%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Jochen Theodorou (Sponsored) : 169 commits (15%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Guillaume Laforge (Sponsored) : 74 commits (6%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;PascalSchumacher : 12 commits (1%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Peter Niederwieser : 11 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;René Scheibe : 11 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Andre Steingress : 9 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;John Wagenleitner : 7 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Peter Ledbrook : 6 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Andres Almiray : 6 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Adrian Nistor : 5 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Tim Yates : 5 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Baruch Sadogursky : 4 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Andrew Eisenberg : 3 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Rich Freedman : 3 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Stephane Maldini : 3 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Andrew Taylor : 2 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Jeff Brown : 2 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Luke Daley : 2 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Tiago Fernandez : 2 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Andrey Bloschetsov : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Johnny Wey : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Kenneth Kousen : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Mathieu Bruyen : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Paul Bakker : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Paulo Poiati : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Sean Flanigan : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Suk-Hyun Cho : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Vladimir Orany : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;2012 is one of the most important years for the language. It was the year Groovy 2.0 was released. As you can see, I am still ranking #1 and Paul King, an unpaid contributor, is #2. This tells you the importance of community! Groovy 2 is a major change in the language, because it introduced both optional type checking and static compilation. For the first time, Groovy was able to provide at compile time the same level of feedback that Java would have. Some people wanted to kill me for having introduced that into the language. The truth is that it wasn&amp;#8217;t my decision, but in retrospect, I am very happy with what the language is now. Without this, some people would have abandonned Groovy in favor of other JVM languages like Scala, while now in Groovy you can have the same level of performance as Java, with type safety, powerful type inference, extension methods, functional style programming and without the boilerplate. And it&amp;#8217;s optional. I don&amp;#8217;t know any other language that allows this, especially when you take type checking extensions into account, a feature that allows Groovy to go far beyond what Java and other languages offer in terms of type safety or static compilation.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;2012 also sees the appearance of Pascal Schumacher, a silent but very active Groovy committer. Pascal does since 2012 an amazing job in helping us filtering JIRA issues, writing bugfixes, reviewing pull requests and lately writing documentation.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_2013_documentation_effort_and_explosion_of_contributions&quot;&gt;2013: Documentation effort and explosion of contributions&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;olist arabic&quot;&gt;
&lt;ol class=&quot;arabic&quot;&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;span class=&quot;red&quot;&gt;Cédric Champeau (Sponsored) : 244 commits (22%)&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Paul King : 188 commits (17%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;PascalSchumacher : 180 commits (16%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Jochen Theodorou (Sponsored) : 96 commits (8%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Thibault Kruse : 84 commits (7%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Guillaume Laforge (Sponsored) : 54 commits (4%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Andrey Bloschetsov : 43 commits (3%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Andre Steingress : 36 commits (3%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Pascal Schumacher : 27 commits (2%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Tim Yates : 24 commits (2%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;René Scheibe : 12 commits (1%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;kruset : 12 commits (1%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Martin Hauner : 8 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Andres Almiray : 8 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Larry Jacobson : 4 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;John Wagenleitner : 6 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Paolo Di Tommaso : 6 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Jeff Scott Brown (Sponsored) : 5 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Masato Nagai : 5 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Jochen Eddelbüttel : 3 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;hbaykuslar : 3 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;shalecraig : 3 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Andrew Eisenberg : 2 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Jacopo Cappellato : 2 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Peter Niederwieser : 2 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Rafael Luque : 2 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Vladimir Orany : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;saschaklein : 2 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;seanjreilly : 2 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;upcrob : 2 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Adrian Nistor : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Alan Thompson : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Alessio Stalla : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;DJBen : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Eric Dahl : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Ingo Hoffmann : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;JBaruch : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Jacob Aae Mikkelsen : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Jim White : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;John Engelman : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Jon Schneider : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Karel Piwko : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Kenneth Endfinger : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Kohsuke Kawaguchi : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Luke Kirby : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Michal Mally : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Miro Bezjak : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Olivier Croquette : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Rob Upcraft : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Sergey Egorov : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Stefan Armbruster : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Yasuharu NAKANO : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;While continuing to improve Groovy, 2013 was very important for the community. You can start to see the GitHub effect here, with &lt;strong&gt;much&lt;/strong&gt; more contributors than before. It is impressive to see the difference before 2011 and after. The number of contributors is continously growing. In 2013, 63% of commits came from the community!&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;In February 2013, we also launched a new big project: the documentation and website overhaul. It is incredible to think that this effort is still uncomplete, but if you see that the old wiki has more than a thousand page or contents (often outdated), you can imagine what effort it takes to rewrite the documentation. Hopefully, we&amp;#8217;re close to filling the gap now, and with the demise of Codehaus, we officially launched our &lt;a href=&quot;http://groovy-lang.org&quot;&gt;new website&lt;/a&gt; where you can see the result of this job.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I also started working on Android support during 2013, for a first overview in GR8Conf 2014, and continued working on improving the infrastructure, with Bintray, TeamCity and Gradle. And Pivotal was born, out of EMC and VMware. Groovy and Grails, along with the Spring Framework, became part of this new company which is still paying me today to work on Groovy (and I, we, should be very thankful for this).&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_2014_towards_android_support&quot;&gt;2014: Towards Android support&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;olist arabic&quot;&gt;
&lt;ol class=&quot;arabic&quot;&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;span class=&quot;red&quot;&gt;Cédric Champeau (Sponsored) : 446 commits (37%)&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Paul King : 261 commits (22%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Jochen Theodorou (Sponsored) : 85 commits (7%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Guillaume Laforge (Sponsored) : 61 commits (5%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Thibault Kruse : 54 commits (4%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Pascal Schumacher : 47 commits (3%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Jim White : 26 commits (2%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Yu Kobayashi : 18 commits (1%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Andre Steingress : 16 commits (1%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Richard Hightower : 3 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;James Northrop : 11 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Kenneth Endfinger : 9 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Tomek Janiszewski : 9 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Matias Bjarland : 8 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Tobia Conforto : 8 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Michael Schuenck : 7 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Sargis Harutyunyan : 7 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Andrey Bloschetsov : 6 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Craig Andrews : 5 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Kent : 5 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Paolo Di Tommaso : 5 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Peter Ledbrook : 5 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Sergey Egorov : 5 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Yasuharu Nakano : 5 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Andrew Hamilton : 4 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Lari Hotari (Sponsored) : 4 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Bloshchetsov Andrey Evgenyevich : 3 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Johannes Link : 3 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Keegan Witt : 3 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Tim Yates : 3 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;anto_belgin : 3 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Baruch Sadogursky : 2 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Dan Allen : 2 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Jan Sykora : 2 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;John Wagenleitner : 2 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Luke Kirby : 2 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Martin Stockhammer : 2 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;UEHARA Junji : 2 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Vihang D : 2 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Andres Almiray : 2 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Andy Hamilton : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Bobby Warner : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Carsten Lenz : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Chris Earle : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;David Avenante : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;David Nahodil : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;David Tiselius : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Dimitar Dimitrov : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Grant McConnaughey : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Jeff Sheets : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Jess Sightler : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Logan Gorence : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Luke Daley : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Manuel Prinz : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Marc Guillemot : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Marcin Grzejszczak : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Nathan Mische : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Peter Swire : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Sagar Sane : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Stephen Mallette : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Tobias Schulte : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Wil Selwood : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;davidmichaelkarr : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;fintelia : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;kruset : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;paul-bjorkstrand : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;2014 was a difficult year. We had a lot of work to do on the documentation side, new features to deliver (traits) and an important topic we definitely wanted to highlight: Android support. This took longer than expected, but in the end, the new &lt;a href=&quot;http://beta.groovy-lang.org/releasenotes/groovy-2.4.html&quot;&gt;Groovy 2.4&lt;/a&gt;. We&amp;#8217;re lucky to have half of the commits coming from the community here. Especially, lots of people helped us on the documentation. And it wasn&amp;#8217;t easy, because our documentation requires that every snippet of code that appears in the docs belongs to a unit test, to make sure that the documentation is always up-to-date.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Meanwhile, at the end of the year, we learnt from Pivotal that they would end sponsoring our jobs. It means that Guillaume Laforge, Jochen Theodorou and myself, for the Groovy team, plus Graeme Rocher, Jeff Brown and Lari Hotari, for the Grails team, were both loosing their jobs and full time to work on the project at the same time. This wasn&amp;#8217;t really a surprise and I am very happy I could work for so long on Groovy, full time, but as I said in a previous post I also wish I will still be able to do that, because you can see from the numbers and features that it matters. If you wonder, we are still discussing with several potential sponsors.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_2015_your_story&quot;&gt;2015: Your story&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;&lt;strong&gt;Total&lt;/strong&gt;: 178 commits &lt;strong&gt;Sponsored&lt;/strong&gt;: 81 commits (45%) &lt;strong&gt;Community&lt;/strong&gt;: 97 commits (54%)&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;olist arabic&quot;&gt;
&lt;ol class=&quot;arabic&quot;&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;span class=&quot;red&quot;&gt;Cédric Champeau (Sponsored) : 69 commits (38%)&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Pascal Schumacher : 59 commits (33%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Jochen Theodorou (Sponsored) : 12 commits (6%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Paul King : 12 commits (6%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;JBrownVisualSpection : 7 commits (3%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Yu Kobayashi : 3 commits (1%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Christoph Frick : 2 commits (1%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Kamil Szymanski : 2 commits (1%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Michael Schuenck : 2 commits (1%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Sean Gilligan : 2 commits (1%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Sergey Egorov : 2 commits (1%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Thibault Kruse : 2 commits (1%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Andy Wilkinson : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Maksym Stavytskyi : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Mario Garcia : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Radovan Synek : 1 commits (0%)&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;2015 will be another important year. It&amp;#8217;s going to be huge for the community. Guillaume Laforge announced that he was joining Restlet, so for the first time since 2007 he will not be fully employed to work on Groovy, but I don&amp;#8217;t expect this to have a big impact on the language development itself: as you can see from the numbers, about half of the commits already come from the community and Guillaume didn&amp;#8217;t contribute much code lately. He was instead the lead of the project, the one that took decisions, the one speaking about the project and talking to and leading the community. He was the voice. It was a hard job, a very important one for Groovy. Guillaume is still today the lead of the project, and he will continue to contribute to the language, but I know from him that he wanted to be able to do more code, and put Groovy in action into a new project.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;With the &lt;a href=&quot;http://blog.pivotal.io/pivotal/news-2/groovy-2-4-and-grails-3-0-to-be-last-major-releases-under-pivotal-sponsorship&quot;&gt;end of sponsorship of Pivotal&lt;/a&gt;, the &lt;a href=&quot;http://www.codehaus.org/&quot;&gt;demise of Codehaus&lt;/a&gt; and &lt;a href=&quot;http://restlet.com/blog/2015/03/02/head-of-groovy-project-joins-restlet-to-lead-api-development-tools/&quot;&gt;Guillaume&amp;#8217;s decision&lt;/a&gt;, it became even more important to move Groovy to a foundation where it will be able to live with or without us. I have honestly no idea where I will work in a few weeks now. I sincerely hope I will still be able to contribute to the language full time, but let&amp;#8217;s be clear: today, it is very unlikely this is going to happen. It makes it very important for the project to be able to develop the community even more. We had more than 4.5 million downloads last year. This is huge. And with Android support, I see a lot of potential, even if we have tough competition with other languages and people being paid to develop them. The &lt;strong&gt;&lt;a href=&quot;http://apache.org&quot;&gt;Apache Software Foundation&lt;/a&gt; is going to help us with securing the future of the language and building a community&lt;/strong&gt;. I am proud of what you have done, collectively, and this is not over. Groovy is ready for a rebirth under the Apache umbrella!&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;More than ever, the future of Groovy is you.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;To conclude this post, here are the top 10 contributors, in terms of number of commits, of Groovy, for the past 12 years. Congratulations Paul and thanks to our 100+ contributors!&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;olist arabic&quot;&gt;
&lt;ol class=&quot;arabic&quot;&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;span class=&quot;red&quot;&gt;Paul King :Paul King : 2653 commits (23%)&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Jochen Theodorou&lt;/strong&gt; : 1562 commits (13%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Cédric Champeau&lt;/strong&gt; : 1526 commits (13%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;James Strachan&lt;/strong&gt; : 1031 commits (9%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Guillaume Laforge&lt;/strong&gt; : 709 commits (6%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Roshan Dawrani&lt;/strong&gt; : 307 commits (2%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Jason Dillon&lt;/strong&gt; : 306 commits (2%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Danno Ferrin&lt;/strong&gt; : 301 commits (2%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Alex Tkachman&lt;/strong&gt; : 283 commits (2%)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;John Wilson&lt;/strong&gt; : 230 commits (2%)&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
	</description>
    </item>

  </channel> 
</rss>
